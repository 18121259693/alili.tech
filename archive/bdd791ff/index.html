<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta itemprop="description" content="$(function(){ var html = &#34;\n\n \x3cp\x3e大家好👋\x3c\/p\x3e\n\x3cp\x3e欢迎上车。今天我们将开始一场激动人心的冒险，在这里我们将开发属于我们自己的贪食蛇游戏🐍。通过将其分解为一个个简短的步骤来学习如何解决问题。在这段旅程结束时，你会学到一些新东西，并且有信心能独立探索更多。\x3c\/p\x3e\n\x3cp\x3e如果你是编程新手，\x3ca href=\x22https:\/\/www.freecodecamp.org\/\x22\x3efreeCodeCamp\x3c\/a\x3e 了解一下。这是一个很棒的学习网站…没错…完全免费。我就是从那儿入门的。\x3c\/p\x3e\n\x3cp\x3e好了，好了，言归正传 —— 要发车了，准备好了嘛？\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3e你可以在\x3ca href=\x22https:\/\/github.com\/supergoat\/snake\x22\x3e这里\x3c\/a\x3e找到完整代码，并且可以在\x3ca href=\x22https:\/\/snake-cdxejlircg.now.sh\x22\x3e这里\x3c\/a\x3e在线预览。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3ch3\x3e开始吧\x3c\/h3\x3e\n\x3cp\x3e首先新建一个文件“snake.html”，它将包含全部代码。\x3c\/p\x3e\n\x3cp\x3e因为这是一个 HTML 文件，所以要做的第一件事就是申明 \x3ccode\x3e\x26lt;!DOCTYPE\x26gt;\x3c\/code\x3e。请在 snake.html 文件中输入以下内容：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xml\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3eSnake Game\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n Welcome to Snake!\n \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e不错，接下来在你最喜欢的浏览器中打开 snake.html。你应该能够看到 \x3cstrong\x3eWelcome to Snake!\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t01fd229818a191527a.png\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e很好的开始！ 👊\x3c\/p\x3e\n\x3ch3\x3e创建画布\x3c\/h3\x3e\n\x3cp\x3e为了完成游戏，我们需要用到 \x3ccode\x3e\x26lt;canvas\x26gt;\x3c\/code\x3e 标签，并借助 JavaScript 绘制图像。\x3c\/p\x3e\n\x3cp\x3e用以下代码来替换 snake.html 里的欢迎语。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs routeros\x22\x3e\x26lt;canvas \x3cspan class=\x22hljs-attribute\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22gameCanvas\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attribute\x22\x3ewidth\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attribute\x22\x3eheight\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22300\x22\x3c\/span\x3e\x26gt;\x26lt;canvas\x26gt;\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3eid 用于标识画布且始终应该被指定。稍后我们会用它来访问画布。width 和 height 分别是画布的宽和高，同样也需要被指定。在本例中，画布尺寸为 300 px * 300 px。\x3c\/p\x3e\n\x3cp\x3esnake."><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="像程序员一样思考：如何只使用 JavaScript，HTML 和 CSS 开发贪食蛇游戏"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content=""><meta property="og:site_name" content="Alili"><meta name="generator" content="Hugo 0.51"><title>像程序员一样思考：如何只使用 JavaScript，HTML 和 CSS 开发贪食蛇游戏 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/meslo-LG/styles.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad()</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error",function(e){var t=e.target;"img"==t.tagName.toLowerCase()&&(t.style.display="none")},!0)</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/bdd791ff/",
				"appid": "1613049289050283", 
				"title": "像程序员一样思考：如何只使用 JavaScript，HTML 和 CSS 开发贪食蛇游戏 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-11-16T13:33:38"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")' style="display:none"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id="i-prev" class="info" style="display:none">Previous post</span> <span id="i-next" class="info" style="display:none">Next post</span> <span id="i-top" class="info" style="display:none">Back to top</span> <span id="i-share" class="info" style="display:none">Share post</span></span><br><div id="share" style="display:none"></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">像程序员一样思考：如何只使用 JavaScript，HTML 和 CSS 开发贪食蛇游戏</h1><div class="meta"><div class="postdate"><time datetime="2018-10-18" itemprop="datePublished">2018-10-18</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div>| 3771字<div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="row"><script>$(function(){var s='\n\n            <p>大家好👋</p>\n<p>欢迎上车。今天我们将开始一场激动人心的冒险，在这里我们将开发属于我们自己的贪食蛇游戏🐍。通过将其分解为一个个简短的步骤来学习如何解决问题。在这段旅程结束时，你会学到一些新东西，并且有信心能独立探索更多。</p>\n<p>如果你是编程新手，<a href="https://www.freecodecamp.org/">freeCodeCamp</a> 了解一下。这是一个很棒的学习网站…没错…完全免费。我就是从那儿入门的。</p>\n<p>好了，好了，言归正传 —— 要发车了，准备好了嘛？</p>\n<blockquote>\n<p>你可以在<a href="https://github.com/supergoat/snake">这里</a>找到完整代码，并且可以在<a href="https://snake-cdxejlircg.now.sh">这里</a>在线预览。</p>\n</blockquote>\n<h3>开始吧</h3>\n<p>首先新建一个文件“snake.html”，它将包含全部代码。</p>\n<p>因为这是一个 HTML 文件，所以要做的第一件事就是申明 <code>&lt;!DOCTYPE&gt;</code>。请在 snake.html 文件中输入以下内容：</p>\n<pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n   <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Snake Game<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n\n  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    Welcome to Snake!\n  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre><p>不错，接下来在你最喜欢的浏览器中打开 snake.html。你应该能够看到 <strong>Welcome to Snake!</strong>。</p>\n<p><img src="https://p0.ssl.qhimg.com/t01fd229818a191527a.png" alt=""></p>\n<p>很好的开始！ 👊</p>\n<h3>创建画布</h3>\n<p>为了完成游戏，我们需要用到 <code>&lt;canvas&gt;</code> 标签，并借助 JavaScript 绘制图像。</p>\n<p>用以下代码来替换 snake.html 里的欢迎语。</p>\n<pre><code class="hljs routeros">&lt;canvas <span class="hljs-attribute">id</span>=<span class="hljs-string">"gameCanvas"</span> <span class="hljs-attribute">width</span>=<span class="hljs-string">"300"</span> <span class="hljs-attribute">height</span>=<span class="hljs-string">"300"</span>&gt;&lt;canvas&gt;\n</code></pre><p>id 用于标识画布且始终应该被指定。稍后我们会用它来访问画布。width 和 height 分别是画布的宽和高，同样也需要被指定。在本例中，画布尺寸为 300 px * 300 px。</p>\n<p>snake.html 文件此时应该是这样的：</p>\n<pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n   <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Snake Game<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"gameCanvas"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"300"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre><p>如果你刷新页面，你会发现页面一片空白。这是因为默认情况下，画布是空的并且没有背景。让我们来调整下。🔧</p>\n<h4>为画布添加背景色和边框</h4>\n<p>为了看到画布，我们可以写一段 JavaScript 代码给它加一个边框。为此，我们需要在 <code>&lt;/canvas&gt;</code> 后添加  <code>&lt;script&gt;&lt;/script&gt;</code> 标签，并在其中编写 JavaScript 代码。</p>\n<blockquote>\n<p>如果你把 <code>&lt;script&gt;</code> 标签放在了 <code>&lt;canvas&gt;</code> 标签前面，那么你的 JavaScript 代码将不会生效，因为此时 HTML 还未加载完。</p>\n</blockquote>\n<p>现在我们来写一些 JavaScript 代码，写在闭合的 <code>&lt;script&gt;&lt;/script&gt;</code> 标签之间。代码如下：</p>\n<pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n   <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Snake Game<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"gameCanvas"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"300"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>\n\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">\n      <span class="hljs-comment">/** 常量 **/</span>\n      <span class="hljs-keyword">const</span> CANVAS_BORDER_COLOUR = <span class="hljs-string">\'black\'</span>;\n      <span class="hljs-keyword">const</span> CANVAS_BACKGROUND_COLOUR = <span class="hljs-string">"white"</span>;\n\n      <span class="hljs-comment">// 获取 canvas 元素</span>\n      <span class="hljs-keyword">var</span> gameCanvas = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"gameCanvas"</span>);\n      <span class="hljs-comment">// 返回一个二维绘图上下文</span>\n      <span class="hljs-keyword">var</span> ctx = gameCanvas.getContext(<span class="hljs-string">"2d"</span>);\n      <span class="hljs-comment">// 选择画布的背景颜色</span>\n      ctx.fillStyle = CANVAS_BACKGROUND_COLOUR;\n      <span class="hljs-comment">// 选择画布的边框颜色</span>\n      ctx.strokestyle = CANVAS_BORDER_COLOUR;\n      <span class="hljs-comment">// 绘制一个“实心的”长方形来覆盖整个画布</span>\n      ctx.fillRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gameCanvas.width, gameCanvas.height);\n      <span class="hljs-comment">// 绘制画布的“边框”</span>\n      ctx.strokeRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gameCanvas.width, gameCanvas.height);\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n\n</code></pre><p>首先，使用前面指定的 id（gameCanvas）获取 canvas 元素。然后获取画布的“2d”上下文，这意味着我们将在 2D 空间绘制图像。</p>\n<p>最后，我们画了一个 300 x 300 的白色矩形，边框为黑色。这个矩形从左上角（0，0）开始覆盖了整个画布。</p>\n<p>如果你在浏览器中重新加载 snake.html，你会看到一个带黑色边框的白块！干得漂亮，现在我们已经有了一个画布，可以用来创建我们的贪食蛇游戏了！ 👏迎接下一个挑战吧！</p>\n<h3>用坐标来表示贪食蛇</h3>\n<p>为了让游戏能玩，我们需要知道蛇在画布中的位置。为此，我们用一系列坐标来表示蛇。因此，要在画布中间（150,150）画一条横向的蛇，我们可以这样写：</p>\n<pre><code class="hljs groovy">let snake = [\n  {<span class="hljs-string">x:</span> <span class="hljs-number">150</span>, <span class="hljs-string">y:</span> <span class="hljs-number">150</span>},\n  {<span class="hljs-string">x:</span> <span class="hljs-number">140</span>, <span class="hljs-string">y:</span> <span class="hljs-number">150</span>},\n  {<span class="hljs-string">x:</span> <span class="hljs-number">130</span>, <span class="hljs-string">y:</span> <span class="hljs-number">150</span>},\n  {<span class="hljs-string">x:</span> <span class="hljs-number">120</span>, <span class="hljs-string">y:</span> <span class="hljs-number">150</span>},\n  {<span class="hljs-string">x:</span> <span class="hljs-number">110</span>, <span class="hljs-string">y:</span> <span class="hljs-number">150</span>},\n];\n</code></pre><p>注意蛇所有部位的 y 坐标都是 150。每一部位的 x 坐标比（左边）前一个部位多 10 px。数组中的第一对坐标 {x: 150, y: 150} 表示蛇头，位于蛇的最右边。</p>\n<p>别急，在下一步我们画蛇的时候，会对此有更清晰的认识。</p>\n<h3>开始画蛇</h3>\n<p>为了画蛇，我们可以写一个函数为蛇身上的<strong>每一个</strong>部位画一个矩形。</p>\n<pre><code class="hljs actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawSnakePart</span><span class="hljs-params">(snakePart)</span> </span>{\n  ctx.fillStyle = <span class="hljs-string">\'lightgreen\'</span>;\n  ctx.strokestyle = <span class="hljs-string">\'darkgreen\'</span>;\n  ctx.fillRect(snakePart.x, snakePart.y, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n  ctx.strokeRect(snakePart.x, snakePart.y, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n}\n</code></pre><p>接下来，我们用另一个函数在画布上把蛇展示出来。</p>\n<pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawSnake</span><span class="hljs-params">()</span> </span>{\n  snake.<span class="hljs-keyword">forEach</span>(drawSnakePart);\n}\n</code></pre><p>此时 snake.html 文件应该是这样的。</p>\n<pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n   <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Snake Game<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"gameCanvas"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"300"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>\n\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">\n      <span class="hljs-comment">/** 常量 **/</span>\n      <span class="hljs-keyword">const</span> CANVAS_BORDER_COLOUR = <span class="hljs-string">\'black\'</span>;\n      <span class="hljs-keyword">const</span> CANVAS_BACKGROUND_COLOUR = <span class="hljs-string">"white"</span>;\n      <span class="hljs-keyword">const</span> SNAKE_COLOUR = <span class="hljs-string">\'lightgreen\'</span>;\n      <span class="hljs-keyword">const</span> SNAKE_BORDER_COLOUR = <span class="hljs-string">\'darkgreen\'</span>;\n\n      <span class="hljs-keyword">let</span> snake = [\n        {<span class="hljs-attr">x</span>: <span class="hljs-number">150</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n        {<span class="hljs-attr">x</span>: <span class="hljs-number">140</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n        {<span class="hljs-attr">x</span>: <span class="hljs-number">130</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n        {<span class="hljs-attr">x</span>: <span class="hljs-number">120</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n        {<span class="hljs-attr">x</span>: <span class="hljs-number">110</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>}\n      ]\n\n      <span class="hljs-comment">// 获取 canvas 元素</span>\n      <span class="hljs-keyword">var</span> gameCanvas = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"gameCanvas"</span>);\n      <span class="hljs-comment">// 返回一个二维绘制上下文</span>\n      <span class="hljs-keyword">var</span> ctx = gameCanvas.getContext(<span class="hljs-string">"2d"</span>);\n      <span class="hljs-comment">//  选择画布的背景颜色</span>\n      ctx.fillStyle = CANVAS_BACKGROUND_COLOUR;\n      <span class="hljs-comment">//  选择画布的边框颜色</span>\n      ctx.strokestyle = CANVAS_BORDER_COLOUR;\n      <span class="hljs-comment">// 绘制一个“实心的”长方形来覆盖整个画布</span>\n      ctx.fillRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gameCanvas.width, gameCanvas.height);\n      <span class="hljs-comment">// 绘制画布的“边框”</span>\n      ctx.strokeRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gameCanvas.width, gameCanvas.height);\n      drawSnake();\n\n      <span class="hljs-comment">/**\n       * 在画布上画蛇\n       */</span>\n      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawSnake</span>(<span class="hljs-params"></span>) </span>{\n        <span class="hljs-comment">// 循环遍历蛇的每一部分，并将其绘制到画布上</span>\n        snake.forEach(drawSnakePart)\n      }\n      <span class="hljs-comment">/**\n       * 在画布上画蛇的一个部分\n       * @param { object } snakePart —— 需要绘制的部位的所在坐标\n       */</span>\n      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawSnakePart</span>(<span class="hljs-params">snakePart</span>) </span>{\n        <span class="hljs-comment">// 设置蛇身体的背景颜色</span>\n        ctx.fillStyle = SNAKE_COLOUR;\n        <span class="hljs-comment">// 设置蛇身的边框色</span>\n        ctx.strokestyle = SNAKE_BORDER_COLOUR;\n        <span class="hljs-comment">// 在蛇身坐标所在的位置，绘制“实心”的矩形以表示蛇    </span>\n        ctx.fillRect(snakePart.x, snakePart.y, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n        <span class="hljs-comment">// 绘制蛇身的边框</span>\n        ctx.strokeRect(snakePart.x, snakePart.y, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n      }\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre><p>刷新页面，你会发现画布中间有一条绿色的蛇。666！ 😎</p>\n<p><img src="https://p0.ssl.qhimg.com/t0114f43f310d04d6d3.png" alt=""></p>\n<h3>让贪食蛇横向移动</h3>\n<p>接下来我们想要让蛇能动起来。不过我们该怎么做呢？🤔</p>\n<p>嗯，为了让蛇能够一步一步（10 px）移动到最右边，我们可以把蛇的<strong>每个</strong>部位的 x 坐标，每次增加 10 px（dx = +10 px）。同理，为了让蛇移动到最左边，每次把蛇的<strong>每个</strong>部位的 x 坐标减少 10 px（dx = -10）。</p>\n<blockquote>\n<p><strong>dx</strong> 是蛇的横向移动速度。</p>\n</blockquote>\n<p>蛇向右移动了 10 px 后，坐标如下图所示：</p>\n<p><img src="https://p0.ssl.qhimg.com/t010a96ab728cf221e6.png" alt=""></p>\n<p>用 advanceSnake 函数来更新蛇的状态。</p>\n<pre><code class="hljs actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">advanceSnake</span><span class="hljs-params">()</span> </span>{\n  <span class="hljs-keyword">const</span> head = {x: snake[<span class="hljs-number">0</span>].x + dx, y: snake[<span class="hljs-number">0</span>].y};\n  snake.unshift(head);\n  snake.pop();\n}\n</code></pre><p>首先，我们为蛇画了个新头。然后使用 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/unshift">unshift</a> 方法将新头放在<strong>蛇</strong>的第一个部位，然后使用 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/pop">pop</a> 方法移除<strong>蛇</strong>的最后一部分。这样以后，如上图所示，所有蛇身上其他部位都移动到了对应位置。</p>\n<p>Boom 💥，你已经找到窍门了吧。</p>\n<h3>让贪食蛇纵向移动</h3>\n<p>为了让蛇能够上下移动，我们不能直接将蛇的所有 y 坐标调整 10 px。那会让整条蛇上下移动。</p>\n<p><img src="https://p0.ssl.qhimg.com/t01f60003f8d1d05646.gif" alt=""></p>\n<p>相反，我们可以调整蛇头的 y 坐标。减少 10 px 蛇会向下移动，增加 10 px 蛇会向上移动。这样就能让蛇正确地移动了。</p>\n<p>幸运的是，因为我们编写的 advanceSnake 函数很棒，所以这很容易做到。在 advanceSnake 函数中，更新 head 让 y 坐标随着 <strong>dy</strong> 变化。</p>\n<pre><code class="hljs roboconf">const head = {<span class="hljs-attribute">x</span>: snake[0]<span class="hljs-variable">.x</span> + dx, y: snake[0]<span class="hljs-variable">.y</span> + dy};\n</code></pre><p>为了验证 advanceSnake 函数是否正确，我们可以临时性地在 drawSnake 函数前调用它。</p>\n<pre><code class="hljs lsl"><span class="hljs-comment">// 向右走一步</span>\nadvanceSnake()\n<span class="hljs-comment">// 水平速度改为 0</span>\ndx = <span class="hljs-number">0</span>;\n<span class="hljs-comment">// 垂直速度改为 10</span>\ndy = <span class="hljs-number">-10</span>;\n<span class="hljs-comment">// 向上走一步</span>\nadvanceSnake();\n<span class="hljs-comment">// 在画布上画蛇</span>\ndrawSnake();\n\n</code></pre><p>现在 snake.html 代码如下：</p>\n<pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n   <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Snake Game<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"gameCanvas"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"300"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>\n\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">\n      <span class="hljs-comment">/** 常量 **/</span>\n      <span class="hljs-keyword">const</span> CANVAS_BORDER_COLOUR = <span class="hljs-string">\'black\'</span>;\n      <span class="hljs-keyword">const</span> CANVAS_BACKGROUND_COLOUR = <span class="hljs-string">"white"</span>;\n      <span class="hljs-keyword">const</span> SNAKE_COLOUR = <span class="hljs-string">\'lightgreen\'</span>;\n      <span class="hljs-keyword">const</span> SNAKE_BORDER_COLOUR = <span class="hljs-string">\'darkgreen\'</span>;\n\n      <span class="hljs-keyword">let</span> snake = [\n        {<span class="hljs-attr">x</span>: <span class="hljs-number">150</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n        {<span class="hljs-attr">x</span>: <span class="hljs-number">140</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n        {<span class="hljs-attr">x</span>: <span class="hljs-number">130</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n        {<span class="hljs-attr">x</span>: <span class="hljs-number">120</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n        {<span class="hljs-attr">x</span>: <span class="hljs-number">110</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>}\n      ]\n\n      <span class="hljs-comment">// 横向移动速度</span>\n      <span class="hljs-keyword">let</span> dx = <span class="hljs-number">10</span>;\n      <span class="hljs-comment">// 纵向移动速度</span>\n      <span class="hljs-keyword">let</span> dy = <span class="hljs-number">0</span>;\n\n      <span class="hljs-comment">// 获取 canvas 元素</span>\n      <span class="hljs-keyword">var</span> gameCanvas = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"gameCanvas"</span>);\n      <span class="hljs-comment">// 返回一个二维绘制上下文</span>\n      <span class="hljs-keyword">var</span> ctx = gameCanvas.getContext(<span class="hljs-string">"2d"</span>);\n      <span class="hljs-comment">//  选择画布的背景颜色</span>\n      ctx.fillStyle = CANVAS_BACKGROUND_COLOUR;\n      <span class="hljs-comment">//  选择画布的边框颜色</span>\n      ctx.strokestyle = CANVAS_BORDER_COLOUR;\n      <span class="hljs-comment">// 绘制一个“实心的”长方形来覆盖整个画布</span>\n      ctx.fillRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gameCanvas.width, gameCanvas.height);\n      <span class="hljs-comment">// 绘制画布的“边框”</span>\n      ctx.strokeRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gameCanvas.width, gameCanvas.height);\n\n      <span class="hljs-comment">// 向右走一步</span>\n      advanceSnake()\n      <span class="hljs-comment">// 水平速度改为 0</span>\n      dx = <span class="hljs-number">0</span>;\n      <span class="hljs-comment">// 垂直速度改为 10</span>\n      dy = <span class="hljs-number">-10</span>;\n      <span class="hljs-comment">// 向上走一步</span>\n      advanceSnake();\n      <span class="hljs-comment">// 在画布上画蛇</span>\n      drawSnake();\n\n      <span class="hljs-comment">/**\n        * 根据蛇的水平移动速度改变蛇的 x 坐标，\n        * 根据蛇的垂直移动速度改变蛇的 y 坐标\n        */</span>\n      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">advanceSnake</span>(<span class="hljs-params"></span>) </span>{\n        <span class="hljs-keyword">const</span> head = {<span class="hljs-attr">x</span>: snake[<span class="hljs-number">0</span>].x + dx, <span class="hljs-attr">y</span>: snake[<span class="hljs-number">0</span>].y + dy};\n        snake.unshift(head);\n        snake.pop();\n      }\n\n      <span class="hljs-comment">/**\n       * 在画布上画蛇\n       */</span>\n      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawSnake</span>(<span class="hljs-params"></span>) </span>{\n        <span class="hljs-comment">// 循环遍历蛇的每一部分，并将其绘制到画布上</span>\n        snake.forEach(drawSnakePart)\n      }\n      <span class="hljs-comment">/**\n       * 在画布上画蛇的一个部分\n       * @param { object } snakePart —— 需要绘制的部位的所在坐标\n       */</span>\n      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawSnakePart</span>(<span class="hljs-params">snakePart</span>) </span>{\n        <span class="hljs-comment">// 设置蛇身体的背景颜色</span>\n        ctx.fillStyle = SNAKE_COLOUR;\n        <span class="hljs-comment">// 设置蛇身的边框色</span>\n        ctx.strokestyle = SNAKE_BORDER_COLOUR;\n        <span class="hljs-comment">// 在蛇身坐标所在的位置，绘制“实心”的矩形以表示蛇    </span>\n        ctx.fillRect(snakePart.x, snakePart.y, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n        <span class="hljs-comment">// 绘制蛇身的边框</span>\n        ctx.strokeRect(snakePart.x, snakePart.y, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n      }\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre><p>刷新页面，蛇动了。恭喜！</p>\n<p><img src="https://p0.ssl.qhimg.com/t01058946718ea792e4.png" alt=""></p>\n<h3>重构代码</h3>\n<p>在继续下一步之前，让我们重构一下现有代码，将绘制画布的代码封装在一个函数中。这有助于完成下一步。</p>\n<blockquote>\n<p><strong>代码重构</strong>是重构现有计算机<strong>代码</strong>的过程，同时不改变其外部行为。” —— <a href="https://en.wikipedia.org/wiki/Code_refactoring">维基百科</a></p>\n</blockquote>\n<pre><code class="hljs arduino">function clearCanvas() {\n  ctx.fillStyle = <span class="hljs-string">"white"</span>;\n  ctx.strokeStyle = <span class="hljs-string">"black"</span>;\n  ctx.fillRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gameCanvas.<span class="hljs-built_in">width</span>, gameCanvas.<span class="hljs-built_in">height</span>);\n  ctx.strokeRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gameCanvas.<span class="hljs-built_in">width</span>, gameCanvas.<span class="hljs-built_in">height</span>);\n}\n</code></pre><p>我们正在大踏步前进！🐾</p>\n<h3>让贪食蛇自动移动</h3>\n<p>好的，既然我们已经成功地重构了代码，那么接下来让贪食蛇能够自动移动吧。</p>\n<p>之前为了测试 advanceSnake 函数是否正确，我们调用了它两次。一次为了让蛇向右移动，一次为了让它向上移动。</p>\n<p>因此如果想要让蛇右移五次，那么我们需要连续调用 advanceSnake() 函数五次。</p>\n<pre><code class="hljs abnf">clearCanvas()<span class="hljs-comment">;</span>\nadvanceSnake()<span class="hljs-comment">;</span>\nadvanceSnake()<span class="hljs-comment">;</span>\nadvanceSnake()<span class="hljs-comment">;</span>\nadvanceSnake()<span class="hljs-comment">;</span>\nadvanceSnake()<span class="hljs-comment">;</span>\ndrawSnake()<span class="hljs-comment">;</span>\n</code></pre><p>但是，如上所示连续五次调用 advanceSnake 函数会让蛇一下子向前跳 50 px。</p>\n<p><img src="https://p0.ssl.qhimg.com/t01e97ff3c91820df28.gif" alt=""></p>\n<p>相反，我们想让蛇看起来像是一步一步地前进。</p>\n<p>为此，我们用 <a href="https://www.w3schools.com/Jsref/met_win_settimeout.asp">setTimeout</a> 在每次调用之间添加一个短暂的延时。我们还需要确保每次调用 advanceSnake 函数时都调用 drawSnake 函数。如果我们不这样做，我们将无法看到蛇移动的中间步骤。</p>\n<pre><code class="hljs mipsasm">setTimeout(function onTick() {\n  clearCanvas()<span class="hljs-comment">;</span>\n  advanceSnake()<span class="hljs-comment">;</span>\n  drawSnake()<span class="hljs-comment">;</span>\n}, <span class="hljs-number">100</span>)<span class="hljs-comment">;</span>\nsetTimeout(function onTick() {\n  clearCanvas()<span class="hljs-comment">;</span>\n  advanceSnake()<span class="hljs-comment">;</span>\n  drawSnake()<span class="hljs-comment">;</span>\n}, <span class="hljs-number">100</span>)<span class="hljs-comment">;</span>\n...\ndrawSnake()<span class="hljs-comment">;</span>\n\n</code></pre><p>注意我们同样在每个 setTimeout 中调用了 clearCanvas() 函数。这是为了移除蛇先前所有的位置，以免留下痕迹。</p>\n<p><img src="https://p0.ssl.qhimg.com/t0109fcd2ed761bc8b1.png" alt=""></p>\n<p>尽管如此，上述代码仍然有问题。没有任何代码告诉程序它必须等待一个 <strong>setTimeout</strong> 完成后才能移动到下一个<strong>setTimeout</strong>。也就是说蛇<strong>仍然</strong>会在<strong>一个短暂延迟</strong>后向前跳 50 px。</p>\n<p>要解决这个问题，我们必须将代码包装在函数中，每次只调用一个函数。</p>\n<pre><code class="hljs actionscript">stepOne();\n\n<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stepOne</span><span class="hljs-params">()</span> </span>{\n  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onTick</span><span class="hljs-params">()</span> </span>{\n    clearCanvas();\n    advanceSnake();\n    drawSnake();\n   <span class="hljs-comment">// 调用第二个函数</span>\n   stepTwo();\n  }, <span class="hljs-number">100</span>)\n}\n<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stepTwo</span><span class="hljs-params">()</span> </span>{\n  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onTick</span><span class="hljs-params">()</span> </span>{\n    clearCanvas();\n    advanceSnake();\n    drawSnake();\n    <span class="hljs-comment">// 调用第三个函数</span>\n    stepThree();\n  }, <span class="hljs-number">100</span>)\n}\n...\n</code></pre><p>如何让贪食蛇一直前进？我们可以改为创建一个 main 函数并递归调用它，而不是创建无数个相互调用的函数。</p>\n<pre><code class="hljs actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{\n  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onTick</span><span class="hljs-params">()</span> </span>{\n    clearCanvas();\n    advanceSnake();\n    drawSnake();\n    <span class="hljs-comment">// 再次调用 main 函数</span>\n    main();\n  }, <span class="hljs-number">100</span>)\n}\n</code></pre><p>看啊！贪食蛇现在会一直向右移动。虽然一旦它到达画布的尽头，将继续其无尽的旅程并进入未知的地方😅。我们将在适当的时候解决这个问题，耐心点年轻的朋友们。🙏。</p>\n<p><img src="https://p0.ssl.qhimg.com/t0105917546eadd03c1.gif" alt=""></p>\n<h3>调整蛇的移动方向</h3>\n<p>我们的下一个任务是在按下任意方向键时更改蛇的移动方向。在 drawSnakePart 函数之后添加以下代码。</p>\n<pre><code class="hljs nix">function changeDirection(event) {\n  const <span class="hljs-attr">LEFT_KEY</span> = <span class="hljs-number">37</span>;\n  const <span class="hljs-attr">RIGHT_KEY</span> = <span class="hljs-number">39</span>;\n  const <span class="hljs-attr">UP_KEY</span> = <span class="hljs-number">38</span>;\n  const <span class="hljs-attr">DOWN_KEY</span> = <span class="hljs-number">40</span>;\n  const <span class="hljs-attr">keyPressed</span> = event.keyCode;\n  const <span class="hljs-attr">goingUp</span> = <span class="hljs-attr">dy</span> === -<span class="hljs-number">10</span>;\n  const <span class="hljs-attr">goingDown</span> = <span class="hljs-attr">dy</span> === <span class="hljs-number">10</span>;\n  const <span class="hljs-attr">goingRight</span> = <span class="hljs-attr">dx</span> === <span class="hljs-number">10</span>;\n  const <span class="hljs-attr">goingLeft</span> = <span class="hljs-attr">dx</span> === -<span class="hljs-number">10</span>;\n  <span class="hljs-keyword">if</span> (<span class="hljs-attr">keyPressed</span> === LEFT_KEY &amp;&amp; !goingRight) {\n    <span class="hljs-attr">dx</span> = -<span class="hljs-number">10</span>;\n    <span class="hljs-attr">dy</span> = <span class="hljs-number">0</span>;\n  }\n  <span class="hljs-keyword">if</span> (<span class="hljs-attr">keyPressed</span> === UP_KEY &amp;&amp; !goingDown) {\n    <span class="hljs-attr">dx</span> = <span class="hljs-number">0</span>;\n    <span class="hljs-attr">dy</span> = -<span class="hljs-number">10</span>;\n  }\n  <span class="hljs-keyword">if</span> (<span class="hljs-attr">keyPressed</span> === RIGHT_KEY &amp;&amp; !goingLeft) {\n    <span class="hljs-attr">dx</span> = <span class="hljs-number">10</span>;\n    <span class="hljs-attr">dy</span> = <span class="hljs-number">0</span>;\n  }\n  <span class="hljs-keyword">if</span> (<span class="hljs-attr">keyPressed</span> === DOWN_KEY &amp;&amp; !goingDown) {\n    <span class="hljs-attr">dx</span> = <span class="hljs-number">0</span>;\n    <span class="hljs-attr">dy</span> = <span class="hljs-number">10</span>;\n  }\n}\n</code></pre><p>这没有什么特别的。我们检查按下的键是否与其中一个方向键匹配。如果匹配到，我们如上所述改变垂直和水平速度。</p>\n<p>请注意，我们还要检查蛇是否往新预期方向的相反方向上移动。这是为了防止我们的蛇掉头，例如当蛇向<strong>左</strong>移动时按下<strong>右</strong>键。</p>\n<p><img src="https://p0.ssl.qhimg.com/t0184be9b4be117a78f.gif" alt=""></p>\n<p>要将 changeDirection  加到游戏代码中，可以在 <a href="https://www.w3schools.com/Jsref/dom_obj_document.asp">document</a>  上使用  <a href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener">addEventListener</a>  来“监听”是否有键被按下。然后我们随着 <a href="https://developer.mozilla.org/en-US/docs/Web/Events/keydown">keydown</a>  事件调用 changeDirection 方法。接着在 main 函数之后添加以下代码。</p>\n<pre><code class="hljs coffeescript"><span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keydown"</span>, changeDirection)\n</code></pre><p>你现在应该可以使用四个方向键更改蛇的方向。干得漂亮，你火了🔥！</p>\n<p>接下来让我们看看如何生成食物并让我们的蛇长大。</p>\n<h3>为蛇生成食物</h3>\n<p>为了生成蛇食，我们必须生成一组随机坐标。我们可以使用辅助函数 randomTen 来生成两个数字。一个用于 x 坐标，一个用于 y 坐标。</p>\n<p>我们还必须确保食物不与蛇的位置重叠。如果重叠了，我们必须生成一个新的食物位置。</p>\n<pre><code class="hljs lua"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">randomTen</span><span class="hljs-params">(min, max)</span></span> {\n  <span class="hljs-keyword">return</span> Math.round((Math.<span class="hljs-built_in">random</span>() * (<span class="hljs-built_in">max</span>-<span class="hljs-built_in">min</span>) + <span class="hljs-built_in">min</span>) / <span class="hljs-number">10</span>) * <span class="hljs-number">10</span>;\n}\n<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createFood</span><span class="hljs-params">()</span></span> {\n  foodX = randomTen(<span class="hljs-number">0</span>, gameCanvas.width - <span class="hljs-number">10</span>);\n  foodY = randomTen(<span class="hljs-number">0</span>, gameCanvas.height - <span class="hljs-number">10</span>);\n  snake.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isFoodOnSnake</span><span class="hljs-params">(part)</span></span> {\n    const foodIsOnSnake = part.x == foodX &amp;&amp; part.y == foodY\n    <span class="hljs-keyword">if</span> (foodIsOnSnake)\n      createFood();\n  });\n}\n</code></pre><p>然后我们需要写一个在画布上绘制食物的函数。</p>\n<pre><code class="hljs actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawFood</span><span class="hljs-params">()</span> </span>{\n ctx.fillStyle = <span class="hljs-string">\'red\'</span>;\n ctx.strokestyle = <span class="hljs-string">\'darkred\'</span>;\n ctx.fillRect(foodX, foodY, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n ctx.strokeRect(foodX, foodY, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n}\n</code></pre><p>最后我们可以在调用 main 之前调用 createFood。别忘了还要更新 main 函数以调用 drawFood 函数。</p>\n<pre><code class="hljs actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{\n  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onTick</span><span class="hljs-params">()</span> </span>{\n    clearCanvas();\n    drawFood()\n    advanceSnake();\n    drawSnake();\n    main();\n  }, <span class="hljs-number">100</span>)\n}\n</code></pre><h3>让蛇长大</h3>\n<p>让蛇长大很简单。更新 advanceSnake 函数，检查蛇头是否碰到了食物。如果碰到了，我们可以跳过移除蛇的最后部分这一操作，同时创建一个新的食物位置。</p>\n<pre><code class="hljs actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">advanceSnake</span><span class="hljs-params">()</span> </span>{\n  <span class="hljs-keyword">const</span> head = {x: snake[<span class="hljs-number">0</span>].x + dx, y: snake[<span class="hljs-number">0</span>].y};\n  snake.unshift(head);\n  <span class="hljs-keyword">const</span> didEatFood = snake[<span class="hljs-number">0</span>].x === foodX &amp;&amp; snake[<span class="hljs-number">0</span>].y === foodY;\n  <span class="hljs-keyword">if</span> (didEatFood) {\n    createFood();\n  } <span class="hljs-keyword">else</span> {\n    snake.pop();\n  }\n}\n</code></pre><h4>记录游戏分数</h4>\n<p>为了让游戏更有乐趣，我们还可以添加一个分数，当蛇吃食物时分数增加。</p>\n<p>在声明了 snake 后，创建一个新的变量 score，并将其设为 0。</p>\n<pre><code class="hljs ebnf"><span class="hljs-attribute">let score</span> = 0;\n</code></pre><p>接下来在画布前添加一个 id 为“score”的新 div，用于显示分数。</p>\n<pre><code class="hljs routeros">&lt;div <span class="hljs-attribute">id</span>=<span class="hljs-string">"score"</span>&gt;0&lt;/div&gt;\n&lt;canvas <span class="hljs-attribute">id</span>=<span class="hljs-string">"gameCanvas"</span> <span class="hljs-attribute">width</span>=<span class="hljs-string">"300"</span> <span class="hljs-attribute">height</span>=<span class="hljs-string">"300"</span>&gt;&lt;/canvas&gt;\n</code></pre><p>最后更新 advanceSnake， 当蛇吃食物时，增加并显示分数。</p>\n<pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">advanceSnake</span>(<span class="hljs-params"></span>) </span>{\n  ...\n  if (didEatFood) {\n    score += <span class="hljs-number">10</span>;\n    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">\'score\'</span>).innerHTML = score;\n    createFood();\n  } <span class="hljs-keyword">else</span> {\n    ...\n  }\n}\n</code></pre><p>呼…真不容易，不过胜利就在眼前了 😌</p>\n<h3>结束游戏</h3>\n<p>还剩下最后一部分，那就是结束游戏🖐。为此创建一个函数 didGameEnd，当游戏结束时返回 <strong>true</strong>，否则返回 <strong>false</strong>。</p>\n<pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">didGameEnd</span>(<span class="hljs-params"></span>) </span>{\n  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">4</span>; i &lt; snake.length; i++) {\n    <span class="hljs-keyword">const</span> didCollide = snake[i].x === snake[<span class="hljs-number">0</span>].x &amp;&amp;\n      snake[i].y === snake[<span class="hljs-number">0</span>].y\n    <span class="hljs-keyword">if</span> (didCollide) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>\n  }\n  <span class="hljs-keyword">const</span> hitLeftWall = snake[<span class="hljs-number">0</span>].x &lt; <span class="hljs-number">0</span>;\n  <span class="hljs-keyword">const</span> hitRightWall = snake[<span class="hljs-number">0</span>].x &gt; gameCanvas.width - <span class="hljs-number">10</span>;\n  <span class="hljs-keyword">const</span> hitToptWall = snake[<span class="hljs-number">0</span>].y &lt; <span class="hljs-number">0</span>;\n  <span class="hljs-keyword">const</span> hitBottomWall = snake[<span class="hljs-number">0</span>].y &gt; gameCanvas.height - <span class="hljs-number">10</span>;\n  <span class="hljs-keyword">return</span> hitLeftWall || \n         hitRightWall || \n         hitToptWall ||\n         hitBottomWall\n} \n</code></pre><p>首先，我们检查蛇的头部是否碰到蛇身上其他部分，如果碰到了那么返回 <strong>true</strong>。</p>\n<blockquote>\n<p>请注意，我们从索引值 4 开始循环。这有两个原因：一个是如果索引为 0，<strong>didCollide</strong> 则会立即判断为 true，导致游戏结束。另一个是，蛇的前三个部分不可能相互接触。</p>\n</blockquote>\n<p>接下来我们检查蛇是否在画布上撞墙了，如果是，那么返回 <strong>true</strong>，否则返回 <strong>false </strong>。</p>\n<p>现在，如果 didEndGame 返回 true，我们可以在主函数中提前返回，从而结束游戏。</p>\n<pre><code class="hljs actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{\n  <span class="hljs-keyword">if</span> (didGameEnd()) <span class="hljs-keyword">return</span>;\n  ...\n}\n</code></pre><p>snake.html 现在应该是这样的：</p>\n<pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n   <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Snake Game<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"score"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"gameCanvas"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"300"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>\n\n    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">\n      <span class="hljs-comment">/** 常量 **/</span>\n      <span class="hljs-keyword">const</span> CANVAS_BORDER_COLOUR = <span class="hljs-string">\'black\'</span>;\n      <span class="hljs-keyword">const</span> CANVAS_BACKGROUND_COLOUR = <span class="hljs-string">"white"</span>;\n      <span class="hljs-keyword">const</span> SNAKE_COLOUR = <span class="hljs-string">\'lightgreen\'</span>;\n      <span class="hljs-keyword">const</span> SNAKE_BORDER_COLOUR = <span class="hljs-string">\'darkgreen\'</span>;\n      <span class="hljs-keyword">const</span> FOOD_COLOUR = <span class="hljs-string">\'red\'</span>;\n      <span class="hljs-keyword">const</span> FOOD_BORDER_COLOUR = <span class="hljs-string">\'darkred\'</span>;\n      <span class="hljs-keyword">let</span> snake = [\n        {<span class="hljs-attr">x</span>: <span class="hljs-number">150</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n        {<span class="hljs-attr">x</span>: <span class="hljs-number">140</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n        {<span class="hljs-attr">x</span>: <span class="hljs-number">130</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n        {<span class="hljs-attr">x</span>: <span class="hljs-number">120</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n        {<span class="hljs-attr">x</span>: <span class="hljs-number">110</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>}\n      ]\n      <span class="hljs-comment">// 玩家的分数</span>\n      <span class="hljs-keyword">let</span> score = <span class="hljs-number">0</span>;\n      <span class="hljs-comment">// 横向移动速度</span>\n      <span class="hljs-keyword">let</span> dx = <span class="hljs-number">10</span>;\n      <span class="hljs-comment">// 纵向移动速度</span>\n      <span class="hljs-keyword">let</span> dy = <span class="hljs-number">0</span>;\n      <span class="hljs-comment">// 获取 canvas 元素</span>\n      <span class="hljs-keyword">var</span> gameCanvas = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"gameCanvas"</span>);\n      <span class="hljs-comment">// 返回一个二维绘制上下文</span>\n      <span class="hljs-keyword">var</span> ctx = gameCanvas.getContext(<span class="hljs-string">"2d"</span>);\n      <span class="hljs-comment">//  选择画布的背景颜色</span>\n      ctx.fillStyle = CANVAS_BACKGROUND_COLOUR;\n      <span class="hljs-comment">//  选择画布的边框颜色</span>\n      ctx.strokestyle = CANVAS_BORDER_COLOUR;\n      <span class="hljs-comment">// 绘制一个“实心的”长方形来覆盖整个画布</span>\n      ctx.fillRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gameCanvas.width, gameCanvas.height);\n      <span class="hljs-comment">// 绘制画布的“边框”</span>\n      ctx.strokeRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gameCanvas.width, gameCanvas.height);\n      <span class="hljs-comment">// 开始游戏</span>\n      main();\n      <span class="hljs-comment">// 生成第一个食物位置</span>\n      createFood();\n      <span class="hljs-comment">// 按下任意一个键，都会调用 changeDirection</span>\n      <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keydown"</span>, changeDirection);\n      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>) </span>{\n        <span class="hljs-keyword">if</span> (didGameEnd()) <span class="hljs-keyword">return</span>;\n        setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onTick</span>(<span class="hljs-params"></span>) </span>{\n          clearCanvas();\n          drawFood();\n          advanceSnake();\n          drawSnake();\n          <span class="hljs-comment">// Call main again</span>\n          main();\n        }, <span class="hljs-number">100</span>)\n      }\n      <span class="hljs-comment">/**\n      * 设置画布的背景色为 CANVAS_BACKGROUND_COLOUR \n      * 并绘制画布的边框\n      */</span>\n      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearCanvas</span>(<span class="hljs-params"></span>) </span>{\n        <span class="hljs-comment">//  选择画布的背景颜色</span>\n        ctx.fillStyle = CANVAS_BACKGROUND_COLOUR;\n        <span class="hljs-comment">//  选择画布的边框颜色</span>\n        ctx.strokestyle = CANVAS_BORDER_COLOUR;\n        <span class="hljs-comment">// 绘制一个“实心的”长方形来覆盖整个画布</span>\n        ctx.fillRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gameCanvas.width, gameCanvas.height);\n        <span class="hljs-comment">// 绘制画布的“边框”</span>\n        ctx.strokeRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gameCanvas.width, gameCanvas.height);\n      }\n      <span class="hljs-comment">/**\n       * 当蛇撞墙或者蛇头碰到蛇身的时候返回 true\n       */</span>\n      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">didGameEnd</span>(<span class="hljs-params"></span>) </span>{\n        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">4</span>; i &lt; snake.length; i++) {\n          <span class="hljs-keyword">const</span> didCollide = snake[i].x === snake[<span class="hljs-number">0</span>].x &amp;&amp; snake[i].y === snake[<span class="hljs-number">0</span>].y\n          <span class="hljs-keyword">if</span> (didCollide) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>\n        }\n        <span class="hljs-keyword">const</span> hitLeftWall = snake[<span class="hljs-number">0</span>].x &lt; <span class="hljs-number">0</span>;\n        <span class="hljs-keyword">const</span> hitRightWall = snake[<span class="hljs-number">0</span>].x &gt; gameCanvas.width - <span class="hljs-number">10</span>;\n        <span class="hljs-keyword">const</span> hitToptWall = snake[<span class="hljs-number">0</span>].y &lt; <span class="hljs-number">0</span>;\n        <span class="hljs-keyword">const</span> hitBottomWall = snake[<span class="hljs-number">0</span>].y &gt; gameCanvas.height - <span class="hljs-number">10</span>;\n        <span class="hljs-keyword">return</span> hitLeftWall || hitRightWall || hitToptWall || hitBottomWall\n      }\n      <span class="hljs-comment">/**\n       * 在画布上画食物\n       */</span>\n      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawFood</span>(<span class="hljs-params"></span>) </span>{\n        ctx.fillStyle = FOOD_COLOUR;\n        ctx.strokestyle = FOOD_BORDER_COLOUR;\n        ctx.fillRect(foodX, foodY, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n        ctx.strokeRect(foodX, foodY, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n      }\n      <span class="hljs-comment">/**\n       * 根据蛇的水平移动速度改变蛇的 x 坐标，\n       * 根据蛇的垂直移动速度改变蛇的 y 坐标\n       */</span>\n      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">advanceSnake</span>(<span class="hljs-params"></span>) </span>{\n        <span class="hljs-comment">// 绘制新的头部</span>\n        <span class="hljs-keyword">const</span> head = {<span class="hljs-attr">x</span>: snake[<span class="hljs-number">0</span>].x + dx, <span class="hljs-attr">y</span>: snake[<span class="hljs-number">0</span>].y + dy};\n        <span class="hljs-comment">// 将新的头部放到蛇身体的第一个部位</span>\n        snake.unshift(head);\n        <span class="hljs-keyword">const</span> didEatFood = snake[<span class="hljs-number">0</span>].x === foodX &amp;&amp; snake[<span class="hljs-number">0</span>].y === foodY;\n        <span class="hljs-keyword">if</span> (didEatFood) {\n          <span class="hljs-comment">// 增加分数</span>\n          score += <span class="hljs-number">10</span>;\n          <span class="hljs-comment">// 在屏幕上显示分数</span>\n          <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">\'score\'</span>).innerHTML = score;\n          <span class="hljs-comment">// 生成新的食物</span>\n          createFood();\n        } <span class="hljs-keyword">else</span> {\n          <span class="hljs-comment">// 移除蛇的最后一个部分</span>\n          snake.pop();\n        }\n      }\n      <span class="hljs-comment">/**\n        * 给定一个最大值和最小值，生成一个 10 的倍数的随机数     \n        * @param { number } min —— 随机数的下限\n        * @param { number } max —— 随机数的上限\n       */</span>\n      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">randomTen</span>(<span class="hljs-params">min, max</span>) </span>{\n        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.round((<span class="hljs-built_in">Math</span>.random() * (max-min) + min) / <span class="hljs-number">10</span>) * <span class="hljs-number">10</span>;\n      }\n     <span class="hljs-comment">/**     \n      * 随机生成食物坐标\n      */</span>\n      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createFood</span>(<span class="hljs-params"></span>) </span>{\n        <span class="hljs-comment">// 随机生成食物的 x 坐标</span>\n        foodX = randomTen(<span class="hljs-number">0</span>, gameCanvas.width - <span class="hljs-number">10</span>);\n        <span class="hljs-comment">// 随机生成食物的 y 坐标</span>\n        foodY = randomTen(<span class="hljs-number">0</span>, gameCanvas.height - <span class="hljs-number">10</span>);\n        <span class="hljs-comment">// 如果新生成的食物与蛇当前位置重叠，重新为食物生成一个位置</span>\n        snake.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isOnSnake</span>(<span class="hljs-params">part</span>) </span>{\n          <span class="hljs-keyword">if</span> (part.x == foodX &amp;&amp; part.y == foodY) createFood();\n        });\n      }\n      <span class="hljs-comment">/**\n       * 在画布上画蛇\n       */</span>\n      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawSnake</span>(<span class="hljs-params"></span>) </span>{\n        <span class="hljs-comment">// 循环遍历蛇的每一部分，并将其绘制到画布上</span>\n        snake.forEach(drawSnakePart)\n      }\n      <span class="hljs-comment">/**\n       * 在画布上画蛇的一个部分\n       * @param { object } snakePart  —— 需要绘制的部位的所在坐标\n       */</span>\n      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawSnakePart</span>(<span class="hljs-params">snakePart</span>) </span>{\n        <span class="hljs-comment">// 设置蛇身体的背景颜色</span>\n        ctx.fillStyle = SNAKE_COLOUR;\n        <span class="hljs-comment">// 设置蛇身的边框色</span>\n        ctx.strokestyle = SNAKE_BORDER_COLOUR;\n        <span class="hljs-comment">// 在蛇身坐标所在的位置，绘制“实心”的矩形以表示蛇      </span>\n        ctx.fillRect(snakePart.x, snakePart.y, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n        <span class="hljs-comment">// 绘制蛇身的边框</span>\n        ctx.strokeRect(snakePart.x, snakePart.y, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n      }\n      <span class="hljs-comment">/**     \n      * 根据按下的键，改变蛇的水平移动速度和垂直移动速度\n      * 为了避免蛇反转，蛇的移动方向不能直接变成相反的方向，\n      * 比如说，当前方向是“向右”，那么下一个方向不能是“向左”\n      * @param { object } event —— 键盘事件\n      */</span>\n      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeDirection</span>(<span class="hljs-params">event</span>) </span>{\n        <span class="hljs-keyword">const</span> LEFT_KEY = <span class="hljs-number">37</span>;\n        <span class="hljs-keyword">const</span> RIGHT_KEY = <span class="hljs-number">39</span>;\n        <span class="hljs-keyword">const</span> UP_KEY = <span class="hljs-number">38</span>;\n        <span class="hljs-keyword">const</span> DOWN_KEY = <span class="hljs-number">40</span>;\n        <span class="hljs-keyword">const</span> keyPressed = event.keyCode;\n        <span class="hljs-keyword">const</span> goingUp = dy === <span class="hljs-number">-10</span>;\n        <span class="hljs-keyword">const</span> goingDown = dy === <span class="hljs-number">10</span>;\n        <span class="hljs-keyword">const</span> goingRight = dx === <span class="hljs-number">10</span>;\n        <span class="hljs-keyword">const</span> goingLeft = dx === <span class="hljs-number">-10</span>;\n        <span class="hljs-keyword">if</span> (keyPressed === LEFT_KEY &amp;&amp; !goingRight) {\n          dx = <span class="hljs-number">-10</span>;\n          dy = <span class="hljs-number">0</span>;\n        }\n        <span class="hljs-keyword">if</span> (keyPressed === UP_KEY &amp;&amp; !goingDown) {\n          dx = <span class="hljs-number">0</span>;\n          dy = <span class="hljs-number">-10</span>;\n        }\n        <span class="hljs-keyword">if</span> (keyPressed === RIGHT_KEY &amp;&amp; !goingLeft) {\n          dx = <span class="hljs-number">10</span>;\n          dy = <span class="hljs-number">0</span>;\n        }\n        <span class="hljs-keyword">if</span> (keyPressed === DOWN_KEY &amp;&amp; !goingUp) {\n          dx = <span class="hljs-number">0</span>;\n          dy = <span class="hljs-number">10</span>;\n        }\n      }\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre><p>现在贪食蛇游戏已经可以玩了，你可以独乐乐或者分享给你的朋友。不过在庆祝之前，我们还是来看看最后一个问题。我保证，这绝对是最后一个。</p>\n<h3>潜藏的 bugs 🐛</h3>\n<p>如果你玩了足够多次游戏，可能会注意到游戏有时会意外结束。这是一个很好的例子，展示了 bug 会潜入我们的程序并制造麻烦🙄。</p>\n<p>发现 bug 的时候，解决它的最好方法是首先找到可靠的方法来重现它。也就是说，找到导致意外行为的精确步骤。然后，需要了解它们导致意外行为的原因，最后寻求解决方案。</p>\n<h4>重现 bug</h4>\n<p>在我们的例子中，重现 bug 的步骤如下：</p>\n<ul>\n<li>蛇正向左移动</li>\n<li>玩家按下向下键</li>\n<li>玩家立即按下向右键（在 100 ms 内）</li>\n<li>游戏结束</li>\n</ul>\n<p><img src="https://p0.ssl.qhimg.com/t01f5db14e92f238906.gif" alt=""></p>\n<h4>分析导致 bug 的原因</h4>\n<p>让我们一步步分解 bug 产生的过程。</p>\n<p><strong>蛇正在向左移动</strong></p>\n<ul>\n<li>水平速度，dx 等于 -10</li>\n<li>调用 main 函数</li>\n<li>调用 advanceSnake 函数，蛇向左移动 10 px。</li>\n</ul>\n<p><strong>玩家按下向下键</strong></p>\n<ul>\n<li>调用 changeDirection</li>\n<li><code>keyPressed === DOWN_KEY &amp;&amp;  !goingUp</code> 的值为 true</li>\n<li>dx 更改为 0</li>\n<li>dy 更改为 +10</li>\n</ul>\n<p><strong>玩家立即按下向右键（在 100 ms 内）</strong></p>\n<ul>\n<li>调用 changeDirection</li>\n<li><code>keyPressed === RIGHT_KEY &amp;&amp; !goingLeft</code> 的值为 true</li>\n<li>dx 更改为 +10</li>\n<li>dy 更改为 0</li>\n</ul>\n<p><strong>游戏结束</strong></p>\n<ul>\n<li>main 函数<strong>延时 100 ms 后</strong>被调用</li>\n<li>调用 advanceSnake，蛇向右移动 10 px。</li>\n<li><code>const didCollide = snake[i].x === snake[0].x &amp;&amp; snake[i].y === snake[0].y</code> 的值为true</li>\n<li>didGameEnd 返回 true</li>\n<li>main 函数提前返回</li>\n<li>游戏结束</li>\n</ul>\n<h4>解决 bug</h4>\n<p>在分析了发生的事情之后，我们了解到游戏结束是因为蛇掉头了。</p>\n<p>这是因为当玩家按下向下键时，dx 被设置为 0。因此 <code>keyPressed === RIGHT_KEY &amp;&amp; !goingLeft</code> 值为 true，同时 dx 更改为 10。</p>\n<p>重要的是要注意，在 <strong>100 ms 时间内</strong>，方向改变了。如果超过 100 ms，那么蛇首先会向下移而不会掉头。</p>\n<p>为了解决这个 bug，必须确保只有在 main 和 advanceSnake 被调用之后，才可以改变蛇的方向。可以创建一个变量 <strong>changingDirection。</strong>当调用 changeDirection 时设置 changingDirection 为 true，并在调用 advanceSnake 时设置为 false。</p>\n<p>在 changeDirection 函数中，如果 <strong>changingDirection</strong> 为 true，就提前返回。</p>\n<pre><code class="hljs actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeDirection</span><span class="hljs-params">(event)</span> </span>{\n  <span class="hljs-keyword">const</span> LEFT_KEY = <span class="hljs-number">37</span>;\n  <span class="hljs-keyword">const</span> RIGHT_KEY = <span class="hljs-number">39</span>;\n  <span class="hljs-keyword">const</span> UP_KEY = <span class="hljs-number">38</span>;\n  <span class="hljs-keyword">const</span> DOWN_KEY = <span class="hljs-number">40</span>;\n  <span class="hljs-keyword">if</span> (changingDirection) <span class="hljs-keyword">return</span>;\n  changingDirection = <span class="hljs-literal">true</span>;\n  ...\n}\n<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{\n  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onTick</span><span class="hljs-params">()</span> </span>{\n    changingDirection = <span class="hljs-literal">false</span>;\n\n    ...\n  }, <span class="hljs-number">100</span>)\n}\n</code></pre><p>以下是 snake.html 的最终版本</p>\n<blockquote>\n<p>注意我还在 <code>&lt;style&gt;&lt;/style&gt;</code> 标签之间添加了一些样式🎨。这是为了让画布和分数显示在屏幕中间。</p>\n</blockquote>\n<pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Snake Game<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://fonts.googleapis.com/css?family=Antic+Slab"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>\n\n  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>\n\n  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>\n\n    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"score"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"gameCanvas"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"300"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>\n\n    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">\n      <span class="hljs-selector-id">#gameCanvas</span> {\n        <span class="hljs-attribute">position</span>: absolute;\n        <span class="hljs-attribute">top</span>: <span class="hljs-number">50%</span>;\n        <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;\n        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(-50%, -50%);\n      }\n      <span class="hljs-selector-id">#score</span> {\n        <span class="hljs-attribute">text-align</span>: center;\n        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">140px</span>;\n        <span class="hljs-attribute">font-family</span>: <span class="hljs-string">\'Antic Slab\'</span>, serif;\n      }\n    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>\n  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>\n\n  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">\n    <span class="hljs-keyword">const</span> GAME_SPEED = <span class="hljs-number">100</span>;\n    <span class="hljs-keyword">const</span> CANVAS_BORDER_COLOUR = <span class="hljs-string">\'black\'</span>;\n    <span class="hljs-keyword">const</span> CANVAS_BACKGROUND_COLOUR = <span class="hljs-string">"white"</span>;\n    <span class="hljs-keyword">const</span> SNAKE_COLOUR = <span class="hljs-string">\'lightgreen\'</span>;\n    <span class="hljs-keyword">const</span> SNAKE_BORDER_COLOUR = <span class="hljs-string">\'darkgreen\'</span>;\n    <span class="hljs-keyword">const</span> FOOD_COLOUR = <span class="hljs-string">\'red\'</span>;\n    <span class="hljs-keyword">const</span> FOOD_BORDER_COLOUR = <span class="hljs-string">\'darkred\'</span>;\n    <span class="hljs-keyword">let</span> snake = [\n      {<span class="hljs-attr">x</span>: <span class="hljs-number">150</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n      {<span class="hljs-attr">x</span>: <span class="hljs-number">140</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n      {<span class="hljs-attr">x</span>: <span class="hljs-number">130</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n      {<span class="hljs-attr">x</span>: <span class="hljs-number">120</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>},\n      {<span class="hljs-attr">x</span>: <span class="hljs-number">110</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>}\n    ]\n    <span class="hljs-comment">// 玩家的分数</span>\n    <span class="hljs-keyword">let</span> score = <span class="hljs-number">0</span>;\n    <span class="hljs-comment">// changingDirection 为 true 时表示蛇正在改变方向</span>\n    <span class="hljs-keyword">let</span> changingDirection = <span class="hljs-literal">false</span>;\n    <span class="hljs-comment">// 食物的 x 坐标</span>\n    <span class="hljs-keyword">let</span> foodX;\n    <span class="hljs-comment">// 食物的 y 坐标</span>\n    <span class="hljs-keyword">let</span> foodY;\n    <span class="hljs-comment">// 横向移动速度</span>\n    <span class="hljs-keyword">let</span> dx = <span class="hljs-number">10</span>;\n    <span class="hljs-comment">// 纵向移动速度</span>\n    <span class="hljs-keyword">let</span> dy = <span class="hljs-number">0</span>;\n    <span class="hljs-comment">// 获取 canvas 元素</span>\n    <span class="hljs-keyword">const</span> gameCanvas = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"gameCanvas"</span>);\n    <span class="hljs-comment">// 返回一个二维绘制上下文</span>\n    <span class="hljs-keyword">const</span> ctx = gameCanvas.getContext(<span class="hljs-string">"2d"</span>);\n    <span class="hljs-comment">// 开始游戏</span>\n    main();\n    <span class="hljs-comment">// 生成第一个食物位置</span>\n    createFood();\n    <span class="hljs-comment">// 按下任意一个键，都会调用 changeDirection</span>\n    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keydown"</span>, changeDirection);\n    <span class="hljs-comment">/**\n     * 游戏的主函数\n     * 递归调用以推进游戏  \n     */</span>\n    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>) </span>{\n      <span class="hljs-comment">// 判定游戏结束时提前返回从而终止游戏</span>\n      <span class="hljs-keyword">if</span> (didGameEnd()) <span class="hljs-keyword">return</span>;\n      setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onTick</span>(<span class="hljs-params"></span>) </span>{\n        changingDirection = <span class="hljs-literal">false</span>;\n        clearCanvas();\n        drawFood();\n        advanceSnake();\n        drawSnake();\n        <span class="hljs-comment">// 再次调用 main</span>\n        main();\n      }, GAME_SPEED)\n    }\n    <span class="hljs-comment">/**\n     * 设置画布的背景色为 CANVAS_BACKGROUND_COLOUR \n     * 并绘制画布的边框\n     */</span>\n    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearCanvas</span>(<span class="hljs-params"></span>) </span>{\n      <span class="hljs-comment">//  选择画布的背景颜色</span>\n      ctx.fillStyle = CANVAS_BACKGROUND_COLOUR;\n      <span class="hljs-comment">//  选择画布的边框颜色</span>\n      ctx.strokestyle = CANVAS_BORDER_COLOUR;\n      <span class="hljs-comment">// 绘制一个“实心的”长方形来覆盖整个画布</span>\n      ctx.fillRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gameCanvas.width, gameCanvas.height);\n      <span class="hljs-comment">// 绘制画布的“边框”</span>\n      ctx.strokeRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gameCanvas.width, gameCanvas.height);\n    }\n    <span class="hljs-comment">/**\n     * 在画布上画食物\n     */</span>\n    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawFood</span>(<span class="hljs-params"></span>) </span>{\n      ctx.fillStyle = FOOD_COLOUR;\n      ctx.strokestyle = FOOD_BORDER_COLOUR;\n      ctx.fillRect(foodX, foodY, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n      ctx.strokeRect(foodX, foodY, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n    }\n    <span class="hljs-comment">/**\n     * 根据蛇的水平移动速度改变蛇的 x 坐标，\n     * 根据蛇的垂直移动速度改变蛇的 y 坐标\n     */</span>\n    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">advanceSnake</span>(<span class="hljs-params"></span>) </span>{\n      <span class="hljs-comment">// 绘制新的头部</span>\n      <span class="hljs-keyword">const</span> head = {<span class="hljs-attr">x</span>: snake[<span class="hljs-number">0</span>].x + dx, <span class="hljs-attr">y</span>: snake[<span class="hljs-number">0</span>].y + dy};\n      <span class="hljs-comment">// 将新的头部放到蛇身体的第一个部位</span>\n      snake.unshift(head);\n      <span class="hljs-keyword">const</span> didEatFood = snake[<span class="hljs-number">0</span>].x === foodX &amp;&amp; snake[<span class="hljs-number">0</span>].y === foodY;\n      <span class="hljs-keyword">if</span> (didEatFood) {\n        <span class="hljs-comment">// 增加分数</span>\n        score += <span class="hljs-number">10</span>;\n        <span class="hljs-comment">// 在屏幕上显示分数</span>\n        <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">\'score\'</span>).innerHTML = score;\n        <span class="hljs-comment">// 生成新的食物</span>\n        createFood();\n      } <span class="hljs-keyword">else</span> {\n        <span class="hljs-comment">// 移除蛇的最后一个部分</span>\n        snake.pop();\n      }\n    }\n    <span class="hljs-comment">/**\n     * 当蛇撞墙或者蛇头碰到蛇身的时候返回 true\n     */</span>\n    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">didGameEnd</span>(<span class="hljs-params"></span>) </span>{\n      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">4</span>; i &lt; snake.length; i++) {\n        <span class="hljs-keyword">if</span> (snake[i].x === snake[<span class="hljs-number">0</span>].x &amp;&amp; snake[i].y === snake[<span class="hljs-number">0</span>].y) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>\n      }\n      <span class="hljs-keyword">const</span> hitLeftWall = snake[<span class="hljs-number">0</span>].x &lt; <span class="hljs-number">0</span>;\n      <span class="hljs-keyword">const</span> hitRightWall = snake[<span class="hljs-number">0</span>].x &gt; gameCanvas.width - <span class="hljs-number">10</span>;\n      <span class="hljs-keyword">const</span> hitToptWall = snake[<span class="hljs-number">0</span>].y &lt; <span class="hljs-number">0</span>;\n      <span class="hljs-keyword">const</span> hitBottomWall = snake[<span class="hljs-number">0</span>].y &gt; gameCanvas.height - <span class="hljs-number">10</span>;\n      <span class="hljs-keyword">return</span> hitLeftWall || hitRightWall || hitToptWall || hitBottomWall\n    }\n    <span class="hljs-comment">/**\n     * 给定一个最大值和最小值，生成一个 10 的倍数的随机数     \n     * @param { number } min —— 随机数的下限\n     * @param { number } max —— 随机数的上限\n     */</span>\n    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">randomTen</span>(<span class="hljs-params">min, max</span>) </span>{\n      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.round((<span class="hljs-built_in">Math</span>.random() * (max-min) + min) / <span class="hljs-number">10</span>) * <span class="hljs-number">10</span>;\n    }\n    <span class="hljs-comment">/**     \n     * 随机生成食物坐标\n     */</span>\n    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createFood</span>(<span class="hljs-params"></span>) </span>{\n      <span class="hljs-comment">// 随机生成食物的 x 坐标</span>\n      foodX = randomTen(<span class="hljs-number">0</span>, gameCanvas.width - <span class="hljs-number">10</span>);\n      <span class="hljs-comment">// 随机生成食物的 y 坐标</span>\n      foodY = randomTen(<span class="hljs-number">0</span>, gameCanvas.height - <span class="hljs-number">10</span>);\n      <span class="hljs-comment">// 如果新生成的食物与蛇当前位置重叠，重新为食物生成一个位置</span>\n      snake.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isFoodOnSnake</span>(<span class="hljs-params">part</span>) </span>{\n        <span class="hljs-keyword">const</span> foodIsoNsnake = part.x == foodX &amp;&amp; part.y == foodY;\n        <span class="hljs-keyword">if</span> (foodIsoNsnake) createFood();\n      });\n    }\n    <span class="hljs-comment">/**\n     * 在画布上画蛇\n     */</span>\n    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawSnake</span>(<span class="hljs-params"></span>) </span>{\n      <span class="hljs-comment">// 循环遍历蛇的每一部分，并将其绘制到画布上</span>\n      snake.forEach(drawSnakePart)\n    }\n    <span class="hljs-comment">/**\n     * 在画布上画蛇的一个部分\n     * @param { object } snakePart —— 需要绘制的部位的所在坐标\n     */</span>\n    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawSnakePart</span>(<span class="hljs-params">snakePart</span>) </span>{\n      <span class="hljs-comment">// 设置蛇身体的背景颜色</span>\n      ctx.fillStyle = SNAKE_COLOUR;\n      <span class="hljs-comment">// 设置蛇身的边框色</span>\n      ctx.strokestyle = SNAKE_BORDER_COLOUR;\n      <span class="hljs-comment">// 在蛇身坐标所在的位置，绘制“实心”的矩形以表示蛇      </span>\n      ctx.fillRect(snakePart.x, snakePart.y, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n      <span class="hljs-comment">// 绘制蛇身的边框</span>\n      ctx.strokeRect(snakePart.x, snakePart.y, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);\n    }\n    <span class="hljs-comment">/**     \n     * 根据按下的键，改变蛇的水平移动速度和垂直移动速度\n     * 为了避免蛇反转，蛇的移动方向不能直接变成相反的方向，\n     * 比如说，当前方向是“向右”，那么下一个方向不能是“向左”\n     * @param { object } event —— 键盘事件\n     */</span>\n    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeDirection</span>(<span class="hljs-params">event</span>) </span>{\n      <span class="hljs-keyword">const</span> LEFT_KEY = <span class="hljs-number">37</span>;\n      <span class="hljs-keyword">const</span> RIGHT_KEY = <span class="hljs-number">39</span>;\n      <span class="hljs-keyword">const</span> UP_KEY = <span class="hljs-number">38</span>;\n      <span class="hljs-keyword">const</span> DOWN_KEY = <span class="hljs-number">40</span>;\n      <span class="hljs-comment">/**\n       * 避免贪食蛇掉头\n       * 举个例子：\n       * 蛇正在向右移动。玩家按下向下键然后迅速地按下向左键。\n       * 此时蛇不会先向下移动一步，而会马上改变方向\n       */</span>\n      <span class="hljs-keyword">if</span> (changingDirection) <span class="hljs-keyword">return</span>;\n      changingDirection = <span class="hljs-literal">true</span>;\n\n      <span class="hljs-keyword">const</span> keyPressed = event.keyCode;\n      <span class="hljs-keyword">const</span> goingUp = dy === <span class="hljs-number">-10</span>;\n      <span class="hljs-keyword">const</span> goingDown = dy === <span class="hljs-number">10</span>;\n      <span class="hljs-keyword">const</span> goingRight = dx === <span class="hljs-number">10</span>;\n      <span class="hljs-keyword">const</span> goingLeft = dx === <span class="hljs-number">-10</span>;\n      <span class="hljs-keyword">if</span> (keyPressed === LEFT_KEY &amp;&amp; !goingRight) {\n        dx = <span class="hljs-number">-10</span>;\n        dy = <span class="hljs-number">0</span>;\n      }\n\n      <span class="hljs-keyword">if</span> (keyPressed === UP_KEY &amp;&amp; !goingDown) {\n        dx = <span class="hljs-number">0</span>;\n        dy = <span class="hljs-number">-10</span>;\n      }\n\n      <span class="hljs-keyword">if</span> (keyPressed === RIGHT_KEY &amp;&amp; !goingLeft) {\n        dx = <span class="hljs-number">10</span>;\n        dy = <span class="hljs-number">0</span>;\n      }\n\n      <span class="hljs-keyword">if</span> (keyPressed === DOWN_KEY &amp;&amp; !goingUp) {\n        dx = <span class="hljs-number">0</span>;\n        dy = <span class="hljs-number">10</span>;\n      }\n    }\n  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>\n</code></pre><h3>结尾</h3>\n<p>恭喜！🎉👏</p>\n<p>我们已经走完了这次旅程。希望你喜欢和我一起学习，并且有信心继续挑战下一次冒险。</p>\n<p>不过现在还不必告别。我的下一篇文章将重点介绍如何帮助您开启<strong>非常</strong>令人兴奋的<strong>开源</strong>世界。</p>\n<p><a href="https://en.wikipedia.org/wiki/Open-source_software">开源</a>是学习<strong>许多</strong>新知识、结识大佬的好方法。虽然最初未必敢于尝试，但这毫无疑问是非常有价值的。</p>\n<p>如果想要收到我下一篇文章的发布通知，可以关注我！📫</p>\n<p>很高兴能和你一起踏上这段旅程。</p>\n<p>期待下次再见。✨</p>\n\n          \n';s=(s=(s=(s=s.replace(/"{/g,"{")).replace(/{"/g,"{")).replace(/"}/g,"}")).replace(/}"/g,"}"),$("#row").html(s)})</script></div><h1 id="版权声明">版权声明</h1><p>原文链接: <a href="https://www.zcfy.cc/article/think-like-a-programmer-how-to-build-snake-using-only-javascript-html-css">https://www.zcfy.cc/article/think-like-a-programmer-how-to-build-snake-using-only-javascript-html-css</a> 原文标题: 像程序员一样思考：如何只使用 JavaScript，HTML 和 CSS 开发贪食蛇游戏 本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2>本文链接：</h2><a href="https://alili.tech/archive/bdd791ff/" target="_blank">https://alili.tech/archive/bdd791ff/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({el:".blog-post-comments",app_id:"ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz",app_key:"hLhtmd4tT0qJbyO2SgQ8odya",placeholder:"说点什么?",avatar:"retro",notify:!0,verify:!0})</script><ul id="more-post-list" class="archive readmore"><h3>推荐阅读</h3><li><a href="/archive/vi32h2qgdt/">JavaScript点击事件——美女合集<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/h1hfkoy4as/">Web UI 自动化测试技术选型<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/2ehenm5fx2r/">【基础】固定列宽的表格及示例演示<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/bp751dpaao6/">移动端开发单位——rem，动态使用<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/w0ea6x92n7j/">预告：Javascript全栈开发的系列文章<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/nh5d5ddjtjs/">CORS 跨域携带 Cookie 发送请求<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/32ufjbf3p3i/">ES6深入浅出 Generator<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/tgareq08se/">H5移动端开发<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/kuarhdceuz/">JS面试理论题<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/82gahy2bcol/">JavaScript ES6功能概述（ECMAScript 6和ES2015 &#43;）<aside class="dates">2018-11-16</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2018 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/js/main.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script>!function(){var d="http:"==document.location.protocol?"http://js.passport.qihucdn.com/11.0.1.js?05520debdbedd780ba345d83b7d5e6f4":"https://jspassport.ssl.qhimg.com/11.0.1.js?05520debdbedd780ba345d83b7d5e6f4";document.write('<script src="'+d+'" id="sozz"><\/script>')}()</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>