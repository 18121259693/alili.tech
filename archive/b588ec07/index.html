<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta itemprop="description" content="$(function(){ var html = &#34;\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016137167?w=1013\x26amp;h=573\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016137167?w=1013\x26amp;h=573\x22 alt=\x22\x26#x8FD9;\x26#x91CC;\x26#x5199;\x26#x56FE;\x26#x7247;\x26#x63CF;\x26#x8FF0;\x22 title=\x22\x26#x8FD9;\x26#x91CC;\x26#x5199;\x26#x56FE;\x26#x7247;\x26#x63CF;\x26#x8FF0;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\x3cp\x3e\x3cstrong\x3e\x26#x8BCD;\x26#x6761;\x3c\/strong\x3e\x3c\/p\x3e\x3cp\x3e\x26#x76EE;\x26#x524D;\x26#x5E02;\x26#x9762;\x26#x4E0A;\x26#x8FD8;\x26#x6CA1;\x26#x6709;\x26#x4E00;\x26#x4E2A;Vue 2.0 \x26#x7684;\x26#x9AD8;\x26#x7EA7;\x26#x6559;\x26#x5B66;\x26#xFF0C;\x26#x90FD;\x26#x662F;\x26#x4E00;\x26#x4E9B;\x26#x57FA;\x26#x7840;\x26#x7684;\x26#x5165;\x26#x95E8;\x26#x8BFE;\x26#x7A0B;\x26#xFF0C;\x26#x4F60;\x26#x5F88;\x26#x96BE;\x26#x627E;\x26#x5230;\x26#x4E00;\x26#x4E2A;\x26#x57FA;\x26#x4E8E;Vue.js\x26#x7684;\x26#x590D;\x26#x6742;\x26#x5E94;\x26#x7528;\x26#x7684;\x26#x6559;\x26#x5B66;\x26#xFF0C; \x26#x4F46;\x26#x662F;\x26#xFF0C;\x26#x6211;\x26#x4EEC;\x26#x4E3A;\x26#x4F60;\x26#x51C6;\x26#x5907;\x26#x4E86;\x26#x8FD9;\x26#x95E8;\x26#x72EC;\x26#x4E00;\x26#x65E0;\x26#x4E8C;\x26#x7684;Vue 2.0 \x26#x9AD8;\x26#x7EA7;\x26#x5B9E;\x26#x6218;\x26#x8BFE;\x26#x7A0B;\x3c\/p\x3e\x3chr\x3e\x3cp\x3e\x3cstrong\x3esrc\x26#x7B80;\x26#x5355;\x26#x7684;\x26#x4ECB;\x26#x7ECD;\x3c\/strong\x3e\x3c\/p\x3e\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016137168?w=267\x26amp;h=451\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016137168?w=267\x26amp;h=451\x22 alt=\x22\x26#x8FD9;\x26#x91CC;\x26#x5199;\x26#x56FE;\x26#x7247;\x26#x63CF;\x26#x8FF0;\x22 title=\x22\x26#x8FD9;\x26#x91CC;\x26#x5199;\x26#x56FE;\x26#x7247;\x26#x63CF;\x26#x8FF0;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\x3cp\x3e\x3cstrong\x3e\x26#x5165;\x26#x53E3;\x26#x6587;\x26#x4EF6;\x3c\/strong\x3e\x3c\/p\x3e\x3cpre\x3e\x3ccode\x3eimport \x26apos;babel-polyfill\x26apos; \/\/\x26#x5199;\x26#x5728;\x26#x7B2C;\x26#x4E00;\x26#x4F4D;\nimport Vue from \x26apos;vue\x26apos;\nimport App from \x26apos;.\/App\x26apos;\nimport router from \x26apos;.\/router\x26apos;\nimport fastclick from \x26apos;fastclick\x26apos;\nimport VueLazyload from \x26apos;vue-lazyload\x26apos;\nimport store from \x26apos;.\/store\x26apos;\n\nimport \x26apos;common\/stylus\/index.styl\x26apos;\n\n\/* eslint-disable no-unused-vars *\/\n\/\/ import vConsole from \x26apos;vconsole\x26apos;\n\nfastclick.attach(document.body)\n\nVue.use(VueLazyload, {\n loading: require(\x26apos;common\/image\/default.png\x26apos;) \/\/\x26#x4F20;\x26#x4E00;\x26#x4E2A;\x26#x9ED8;\x26#x8BA4;\x26#x53C2;\x26#x6570;\n})\n\n\/* eslint-disable no-new *\/\nnew Vue({\n el: \x26apos;#app\x26apos;,\n router,\n store,\n render: h =\x26gt; h(App)\n})\n\x3c\/code\x3e\x3c\/pre\x3e\x3cblockquote\x3e\x3ccode\x3ebabel-polyfill\x26#x662F;es6\x26#x5E95;\x26#x5C42;\x26#x94FA;\x26#x57AB;\x26#x5373;\x26#x652F;\x26#x6301;\x26#x4E00;\x26#x4E9B;API\x26#xFF0C;\x26#x6BD4;\x26#x5982;promise\x3c\/code\x3e\x3c\/blockquote\x3e\x3cp\x3e\x3cstrong\x3eTab\x26#x9875;\x26#x9762;\x3c\/strong\x3e\x3c\/p\x3e\x3cpre\x3e\x3ccode\x3e\x26lt;template\x26gt;\n \x26lt;div class=\x26quot;tab\x26quot;\x26gt;\n \x26lt;router-link tag=\x26quot;div\x26quot; class=\x26quot;tab-item\x26quot; to=\x26quot;\/recommend\x26quot;\x26gt;\n \x26lt;span class=\x26quot;tab-link\x26quot;\x26gt;\x26#x63A8;\x26#x8350;\x26lt;\/span\x26gt;\n \x26lt;\/router-link\x26gt;\n \x26lt;router-link tag=\x26quot;div\x26quot; class=\x26quot;tab-item\x26quot; to=\x26quot;\/singer\x26quot;\x26gt;\n \x26lt;span class=\x26quot;tab-link\x26quot;\x26gt;\x26#x6B4C;\x26#x624B;\x26lt;\/span\x26gt;\n \x26lt;\/router-link\x26gt;\n \x26lt;router-link tag=\x26quot;div\x26quot; class=\x26quot;tab-item\x26quot; to=\x26quot;\/rank\x26quot;\x26gt;\n \x26lt;span class=\x26quot;tab-link\x26quot;\x26gt;\x26#x6392;\x26#x884C;\n \x26lt;\/span\x26gt;\n \x26lt;\/router-link\x26gt;\n \x26lt;router-link tag=\x26quot;div\x26quot; class=\x26quot;tab-item\x26quot; to=\x26quot;\/search\x26quot;\x26gt;\n \x26lt;span class=\x26quot;tab-link\x26quot;\x26gt;\x26#x641C;\x26#x7D22;\x26lt;\/span\x26gt;\n \x26lt;\/router-link\x26gt;\n \x26lt;\/div\x26gt;\n\x26lt;\/template\x26gt;\n\n\x26lt;script type=\x26quot;text\/ecmascript-6\x26quot;\x26gt;\n export default {}\n\x26lt;\/script\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\x3cblockquote\x3e`router-link\x26#x9ED8;\x26#x8BA4;\x26#x662F;a\x26#x6807;\x26#x7B7E;\x26#xFF0C;\x26#x6211;\x26#x4EEC;\x26#x901A;\x26#x8FC7;tag\x26#x6307;\x26#x5B9A;\x26#x4E3A;div\x3cbr\x3e."><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="vuejs2.0 高级实战 全网稀缺 独立开发专属音乐WebAPP 更新中。。。"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content=""><meta property="og:site_name" content="Alili"><meta name="generator" content="Hugo 0.51"><title>vuejs2.0 高级实战 全网稀缺 独立开发专属音乐WebAPP 更新中。。。 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/meslo-LG/styles.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad()</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error",function(e){var t=e.target;"img"==t.tagName.toLowerCase()&&(t.style.display="none")},!0)</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/b588ec07/",
				"appid": "1613049289050283", 
				"title": "vuejs2.0 高级实战 全网稀缺 独立开发专属音乐WebAPP 更新中。。。 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-11-16T13:29:37"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")' style="display:none"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id="i-prev" class="info" style="display:none">Previous post</span> <span id="i-next" class="info" style="display:none">Next post</span> <span id="i-top" class="info" style="display:none">Back to top</span> <span id="i-share" class="info" style="display:none">Share post</span></span><br><div id="share" style="display:none"></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">vuejs2.0 高级实战 全网稀缺 独立开发专属音乐WebAPP 更新中。。。</h1><div class="meta"><div class="postdate"><time datetime="2018-11-15" itemprop="datePublished">2018-11-15</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div>| 4225字<div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="row"><script>$(function(){var t='\n<p><span class="img-wrap"><img data-src="/img/remote/1460000016137167?w=1013&amp;h=573" src="https://static.alili.tech/img/remote/1460000016137167?w=1013&amp;h=573" alt="&#x8FD9;&#x91CC;&#x5199;&#x56FE;&#x7247;&#x63CF;&#x8FF0;" title="&#x8FD9;&#x91CC;&#x5199;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></span></p><p><strong>&#x8BCD;&#x6761;</strong></p><p>&#x76EE;&#x524D;&#x5E02;&#x9762;&#x4E0A;&#x8FD8;&#x6CA1;&#x6709;&#x4E00;&#x4E2A;Vue 2.0 &#x7684;&#x9AD8;&#x7EA7;&#x6559;&#x5B66;&#xFF0C;&#x90FD;&#x662F;&#x4E00;&#x4E9B;&#x57FA;&#x7840;&#x7684;&#x5165;&#x95E8;&#x8BFE;&#x7A0B;&#xFF0C;&#x4F60;&#x5F88;&#x96BE;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;Vue.js&#x7684;&#x590D;&#x6742;&#x5E94;&#x7528;&#x7684;&#x6559;&#x5B66;&#xFF0C; &#x4F46;&#x662F;&#xFF0C;&#x6211;&#x4EEC;&#x4E3A;&#x4F60;&#x51C6;&#x5907;&#x4E86;&#x8FD9;&#x95E8;&#x72EC;&#x4E00;&#x65E0;&#x4E8C;&#x7684;Vue 2.0 &#x9AD8;&#x7EA7;&#x5B9E;&#x6218;&#x8BFE;&#x7A0B;</p><hr><p><strong>src&#x7B80;&#x5355;&#x7684;&#x4ECB;&#x7ECD;</strong></p><p><span class="img-wrap"><img data-src="/img/remote/1460000016137168?w=267&amp;h=451" src="https://static.alili.tech/img/remote/1460000016137168?w=267&amp;h=451" alt="&#x8FD9;&#x91CC;&#x5199;&#x56FE;&#x7247;&#x63CF;&#x8FF0;" title="&#x8FD9;&#x91CC;&#x5199;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></span></p><p><strong>&#x5165;&#x53E3;&#x6587;&#x4EF6;</strong></p><pre><code>import &apos;babel-polyfill&apos;  //&#x5199;&#x5728;&#x7B2C;&#x4E00;&#x4F4D;\nimport Vue from &apos;vue&apos;\nimport App from &apos;./App&apos;\nimport router from &apos;./router&apos;\nimport fastclick from &apos;fastclick&apos;\nimport VueLazyload from &apos;vue-lazyload&apos;\nimport store from &apos;./store&apos;\n\nimport &apos;common/stylus/index.styl&apos;\n\n/* eslint-disable no-unused-vars */\n// import vConsole from &apos;vconsole&apos;\n\nfastclick.attach(document.body)\n\nVue.use(VueLazyload, {\n  loading: require(&apos;common/image/default.png&apos;)  //&#x4F20;&#x4E00;&#x4E2A;&#x9ED8;&#x8BA4;&#x53C2;&#x6570;\n})\n\n/* eslint-disable no-new */\nnew Vue({\n  el: &apos;#app&apos;,\n  router,\n  store,\n  render: h =&gt; h(App)\n})\n</code></pre><blockquote><code>babel-polyfill&#x662F;es6&#x5E95;&#x5C42;&#x94FA;&#x57AB;&#x5373;&#x652F;&#x6301;&#x4E00;&#x4E9B;API&#xFF0C;&#x6BD4;&#x5982;promise</code></blockquote><p><strong>Tab&#x9875;&#x9762;</strong></p><pre><code>&lt;template&gt;\n  &lt;div class=&quot;tab&quot;&gt;\n    &lt;router-link tag=&quot;div&quot; class=&quot;tab-item&quot; to=&quot;/recommend&quot;&gt;\n      &lt;span class=&quot;tab-link&quot;&gt;&#x63A8;&#x8350;&lt;/span&gt;\n    &lt;/router-link&gt;\n    &lt;router-link tag=&quot;div&quot; class=&quot;tab-item&quot; to=&quot;/singer&quot;&gt;\n      &lt;span class=&quot;tab-link&quot;&gt;&#x6B4C;&#x624B;&lt;/span&gt;\n    &lt;/router-link&gt;\n    &lt;router-link tag=&quot;div&quot; class=&quot;tab-item&quot; to=&quot;/rank&quot;&gt;\n      &lt;span class=&quot;tab-link&quot;&gt;&#x6392;&#x884C;\n      &lt;/span&gt;\n    &lt;/router-link&gt;\n    &lt;router-link tag=&quot;div&quot; class=&quot;tab-item&quot; to=&quot;/search&quot;&gt;\n      &lt;span class=&quot;tab-link&quot;&gt;&#x641C;&#x7D22;&lt;/span&gt;\n    &lt;/router-link&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script type=&quot;text/ecmascript-6&quot;&gt;\n  export default {}\n&lt;/script&gt;</code></pre><blockquote>`router-link&#x9ED8;&#x8BA4;&#x662F;a&#x6807;&#x7B7E;&#xFF0C;&#x6211;&#x4EEC;&#x901A;&#x8FC7;tag&#x6307;&#x5B9A;&#x4E3A;div<br>.router-link-active&#x8FD9;&#x4E2A;class&#x662F;&#x7EC4;&#x4EF6;&#x81EA;&#x5E26;&#x7684;`</blockquote><p><strong>APP.vue</strong></p><pre><code>&lt;template&gt;\n  &lt;div id=&quot;app&quot; @touchmove.prevent&gt;\n    &lt;m-header&gt;&lt;/m-header&gt;\n    &lt;tab&gt;&lt;/tab&gt;\n    &lt;keep-alive&gt;\n      &lt;router-view&gt;&lt;/router-view&gt;\n    &lt;/keep-alive&gt;\n    &lt;player&gt;&lt;/player&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script type=&quot;text/ecmascript-6&quot;&gt;\n  import MHeader from &apos;components/m-header/m-header&apos;\n  import Player from &apos;components/player/player&apos;\n  import Tab from &apos;components/tab/tab&apos;\n\n  export default {\n    components: {\n      MHeader,\n      Tab,\n      Player\n    }\n  }\n&lt;/script&gt;</code></pre><blockquote><code>&#x4ED4;&#x7EC6;&#x7684;&#x770B;&#x4E00;&#x4E0B;&#x5F15;&#x5165;&#x7684;&#x7EC4;&#x4EF6;Tab&#x4EE5;&#x53CA;&#x4E00;&#x4E2A;&#x5E03;&#x5C40;&#x65B9;&#x5F0F;</code></blockquote><p><strong>jsonp&#x7684;&#x5C01;&#x88C5;</strong></p><pre><code>import originJsonp from &apos;jsonp&apos;   //jsonp &#x7ED3;&#x5408;promise &#x5C01;&#x88C5;\n\nexport default function jsonp(url, data, option) {\n  url += (url.indexOf(&apos;?&apos;) &lt; 0 ? &apos;?&apos; : &apos;&amp;&apos;) + param(data)\n\n  return new Promise((resolve, reject) =&gt; {\n    originJsonp(url, option, (err, data) =&gt; {\n      if (!err) {\n        resolve(data)\n      } else {\n        reject(err)\n      }\n    })\n  })\n}\n\nexport function param(data) {\n  let url = &apos;&apos;\n  for (var k in data) {\n    let value = data[k] !== undefined ? data[k] : &apos;&apos;\n    url += &apos;&amp;&apos; + k + &apos;=&apos; + encodeURIComponent(value)\n    //&#x89C6;&#x9891;&#x4EE3;&#x7801; \n    //url += `&amp;${k}=${encodeURIComponent(value)}`   es6&#x8BED;&#x6CD5;\n  }\n  return url ? url.substring(1) : &apos;&apos;\n}\n</code></pre><blockquote><code>&#x91CD;&#x70B9;&#x5173;&#x6CE8;&#x4E00;&#x4E0B;URL&#x7684;&#x62FC;&#x63A5;&#x53EF;&#x4EE5;&#x7528;&#x5230;&#x9879;&#x76EE;&#x4E2D;</code></blockquote><hr><p><strong>API/recommend.js &#x4F7F;&#x7528;jsonp &#x8C03;&#x53D6;&#x8F6E;&#x64AD;&#x56FE;&#x7684;&#x6570;&#x636E;</strong></p><pre><code>import jsonp from &apos;common/js/jsonp&apos;\nimport {commonParams, options} from &apos;./config&apos;\n\nexport function getRecommend() {\n  const url = &apos;https://c.y.qq.com/musichall/fcgi-bin/fcg_yqqhomepagerecommend.fcg&apos;\n\n  const data = Object.assign({}, commonParams, {  //assign es6&#x8BED;&#x6CD5;\n    platform: &apos;h5&apos;,\n    uin: 0,\n    needNewCode: 1\n  })\n\n  return jsonp(url, data, options)\n}\n</code></pre><blockquote><code>&#x7528;&#x5230;&#x4E86;es6&#x5BF9;&#x8C61;&#x7684;&#x5408;&#x5E76;&#x65B9;&#x6CD5;Object.assign</code></blockquote><p><strong>config.js</strong></p><pre><code>export const commonParams = {\n  g_tk: 1928093487,\n  inCharset: &apos;utf-8&apos;,\n  outCharset: &apos;utf-8&apos;,\n  notice: 0,\n  format: &apos;jsonp&apos;\n}\n\nexport const options = {\n  param: &apos;jsonpCallback&apos;\n}\n\nexport const ERR_OK = 0</code></pre><blockquote><code>&#x5B9A;&#x4E49;&#x4E00;&#x4E9B;&#x516C;&#x5171;&#x53C2;&#x6570;&#xFF0C;&#x4E0D;&#x7528;&#x6BCF;&#x6B21;&#x518D;&#x53BB;&#x91CD;&#x5199;</code></blockquote><p><strong>components/recommend.vue &#x5728;&#x7EC4;&#x4EF6;&#x4E2D;&#x8C03;&#x7528;&#x63A5;&#x53E3;</strong></p><pre><code>&lt;div v-if=&quot;recommends.length&quot; class=&quot;slider-wrapper&quot; ref=&quot;sliderWrapper&quot;&gt;\n          &lt;slider&gt;\n            &lt;div v-for=&quot;item in recommends&quot;&gt;\n              &lt;a :href=&quot;item.linkUrl&quot;&gt;\n                &lt;img class=&quot;needsclick&quot; @load=&quot;loadImage&quot; :src=&quot;item.picUrl&quot;&gt;\n                &lt;!-- &#x5982;&#x679C;fastclick&#x76D1;&#x542C;&#x5230;&#x6709;class&#x4E3A;needsclick&#x5C31;&#x4E0D;&#x4F1A;&#x62E6;&#x622A; --&gt;\n              &lt;/a&gt;\n            &lt;/div&gt;\n          &lt;/slider&gt;\n        &lt;/div&gt;</code></pre><blockquote>`&#x8FD9;&#x91CC;&#x7528;&#x5230;&#x4E86;slider&#x7EC4;&#x4EF6;&#x4EE5;&#x53CA;slot&#x7684;&#x77E5;&#x8BC6;&#xFF0C;&#x4E5F;&#x9047;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x5751;&#xFF0C;&#x56E0;&#x4E3A;&#x6570;&#x636E;&#x54CD;&#x5E94;<br>&#x5FC5;&#x987B;&#x786E;&#x5B9A;&#x6709;&#x6570;&#x636E;v-if=&quot;recommends.length&quot;&#x624D;&#x80FD;&#x4FDD;&#x8BC1;&#x63D2;&#x69FD;&#x7684;&#x6B63;&#x786E;&#x663E;&#x793A;`</blockquote><pre><code>export default {\n    data() {\n      return {\n        recommends: []\n      }\n    },\n    created() {\n      this._getRecommend()\n    },\n    methods: {\n      \n      _getRecommend() {\n        getRecommend().then((res) =&gt; {\n          if (res.code === ERR_OK) {\n            this.recommends = res.data.slider\n          }\n        })\n      }\n    },\n    components: {\n      Slider\n    }\n  }</code></pre><pre><code>&lt;div class=&quot;recommend-list&quot;&gt;\n          &lt;h1 class=&quot;list-title&quot;&gt;&#x70ED;&#x95E8;&#x6B4C;&#x5355;&#x63A8;&#x8350;&lt;/h1&gt;\n          &lt;ul&gt;\n            &lt;li @click=&quot;selectItem(item)&quot; v-for=&quot;item in discList&quot; class=&quot;item&quot;&gt;\n              &lt;div class=&quot;icon&quot;&gt;\n                &lt;img width=&quot;60&quot; height=&quot;60&quot; v-lazy=&quot;item.imgurl&quot;&gt;\n              &lt;/div&gt;\n              &lt;div class=&quot;text&quot;&gt;\n                &lt;h2 class=&quot;name&quot; v-html=&quot;item.creator.name&quot;&gt;&lt;/h2&gt;\n                &lt;p class=&quot;desc&quot; v-html=&quot;item.dissname&quot;&gt;&lt;/p&gt;\n              &lt;/div&gt;\n            &lt;/li&gt;\n          &lt;/ul&gt;\n        &lt;/div&gt;</code></pre><pre><code>&lt;script type=&quot;text/ecmascript-6&quot;&gt;\n  import Slider from &apos;base/slider/slider&apos;\n  import Loading from &apos;base/loading/loading&apos;\n  import Scroll from &apos;base/scroll/scroll&apos;\n  import {getRecommend, getDiscList} from &apos;api/recommend&apos;\n\n  import {ERR_OK} from &apos;api/config&apos;\n  \n\n  export default {\n\n    data() {\n      return {\n        recommends: [],\n        discList: []\n      }\n    },\n    created() {\n      this._getRecommend()\n\n      this._getDiscList()  //&#x70ED;&#x95E8;&#x6B4C;&#x5355;&#x83B7;&#x53D6;\n    },\n    methods: {\n      \n     \n      _getRecommend() {\n        getRecommend().then((res) =&gt; {\n          if (res.code === ERR_OK) {\n            this.recommends = res.data.slider\n          }\n        })\n      },\n      _getDiscList() {\n        getDiscList().then((res) =&gt; {\n          if (res.code === ERR_OK) {\n            this.discList = res.data.list\n          }\n        })\n      },\n     \n    },\n    components: {\n      Slider,\n      Loading,\n      Scroll\n    }\n  }\n&lt;/script&gt;</code></pre><blockquote><code>&#x5728;&#x8FD9;&#x91CC;&#x6CA1;&#x6709;&#x7528;jsonp&#x800C;&#x662F;&#x7528;&#x4E86;axios,&#x662F;&#x56E0;&#x4E3A;&#x63A5;&#x53E3;&#x6709;host&#x3001;referer&#x6821;&#x9A8C;&#x4E0D;&#x5F97;&#x4F7F;&#x7528;&#x540E;&#x7AEF;&#x4EE3;&#x7406;&#x63A5;&#x53E3;&#x7684;&#x65B9;&#x5F0F;&#x53BB;&#x5904;&#x7406;</code></blockquote><p><strong>bulid&#x76EE;&#x5F55;&#x4E0B;dev-server.js&#x5904;&#x7406;&#x4EE3;&#x7406;</strong></p><pre><code>require(&apos;./check-versions&apos;)()\n\nvar config = require(&apos;../config&apos;)\nif (!process.env.NODE_ENV) {\n  process.env.NODE_ENV = JSON.parse(config.dev.env.NODE_ENV)\n}\n\nvar opn = require(&apos;opn&apos;)\nvar path = require(&apos;path&apos;)\nvar express = require(&apos;express&apos;)\nvar webpack = require(&apos;webpack&apos;)\nvar proxyMiddleware = require(&apos;http-proxy-middleware&apos;)\nvar webpackConfig = require(&apos;./webpack.dev.conf&apos;)\nvar axios = require(&apos;axios&apos;) //&#x7B2C;&#x4E00;&#x6B65;\n\n// default port where dev server listens for incoming traffic\nvar port = process.env.PORT || config.dev.port\n// automatically open browser, if not set will be false\nvar autoOpenBrowser = !!config.dev.autoOpenBrowser\n// Define HTTP proxies to your custom API backend\n// https://github.com/chimurai/http-proxy-middleware\nvar proxyTable = config.dev.proxyTable\n\nvar app = express()\n\nvar apiRoutes = express.Router()   //&#x4EE5;&#x4E0B;&#x662F;&#x540E;&#x7AEF;&#x4EE3;&#x7406;&#x63A5;&#x53E3; &#x7B2C;&#x4E8C;&#x6B65;\n\napiRoutes.get(&apos;/getDiscList&apos;, function (req, res) {\n  var url = &apos;https://c.y.qq.com/splcloud/fcgi-bin/fcg_get_diss_by_tag.fcg&apos;\n  axios.get(url, {\n    headers: {\n      referer: &apos;https://c.y.qq.com/&apos;,\n      host: &apos;c.y.qq.com&apos;\n    },\n    params: req.query\n  }).then((response) =&gt; {\n    res.json(response.data)  //&#x8F93;&#x51FA;&#x5230;&#x6D4F;&#x89C8;&#x5668;&#x7684;res\n  }).catch((e) =&gt; {\n    console.log(e)\n  })\n})\n\napiRoutes.get(&apos;/lyric&apos;, function (req, res) {  //&#x8FD9;&#x662F;&#x53E6;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#x4E0B;&#x8282;&#x5C06;&#x7528;&#x5230;\n  var url = &apos;https://c.y.qq.com/lyric/fcgi-bin/fcg_query_lyric_new.fcg&apos;\n\n  axios.get(url, {\n    headers: {\n      referer: &apos;https://c.y.qq.com/&apos;,\n      host: &apos;c.y.qq.com&apos;\n    },\n    params: req.query\n  }).then((response) =&gt; {\n    var ret = response.data\n    if (typeof ret === &apos;string&apos;) {\n      var reg = /^\\w+\\(({[^()]+})\\)$/\n      var matches = ret.match(reg)\n      if (matches) {\n        ret = JSON.parse(matches[1])\n      }\n    }\n    res.json(ret)\n  }).catch((e) =&gt; {\n    console.log(e)\n  })\n})\n\napp.use(&apos;/api&apos;, apiRoutes)   //&#x6700;&#x540E;&#x4E00;&#x6B65;\n\nvar compiler = webpack(webpackConfig)\n\nvar devMiddleware = require(&apos;webpack-dev-middleware&apos;)(compiler, {\n  publicPath: webpackConfig.output.publicPath,\n  quiet: true\n})\n\nvar hotMiddleware = require(&apos;webpack-hot-middleware&apos;)(compiler, {\n  log: () =&gt; {}\n})\n// force page reload when html-webpack-plugin template changes\ncompiler.plugin(&apos;compilation&apos;, function (compilation) {\n  compilation.plugin(&apos;html-webpack-plugin-after-emit&apos;, function (data, cb) {\n    hotMiddleware.publish({ action: &apos;reload&apos; })\n    cb()\n  })\n})\n\n// proxy api requests\nObject.keys(proxyTable).forEach(function (context) {\n  var options = proxyTable[context]\n  if (typeof options === &apos;string&apos;) {\n    options = { target: options }\n  }\n  app.use(proxyMiddleware(options.filter || context, options))\n})\n\n// handle fallback for HTML5 history API\napp.use(require(&apos;connect-history-api-fallback&apos;)())\n\n// serve webpack bundle output\napp.use(devMiddleware)\n\n// enable hot-reload and state-preserving\n// compilation error display\napp.use(hotMiddleware)\n\n// serve pure static assets\nvar staticPath = path.posix.join(config.dev.assetsPublicPath, config.dev.assetsSubDirectory)\napp.use(staticPath, express.static(&apos;./static&apos;))\n\nvar uri = &apos;http://localhost:&apos; + port\n\nvar _resolve\nvar readyPromise = new Promise(resolve =&gt; {\n  _resolve = resolve\n})\n\nconsole.log(&apos;&gt; Starting dev server...&apos;)\ndevMiddleware.waitUntilValid(() =&gt; {\n  console.log(&apos;&gt; Listening at &apos; + uri + &apos;\\n&apos;)\n  // when env is testing, don&apos;t need open it\n  if (autoOpenBrowser &amp;&amp; process.env.NODE_ENV !== &apos;testing&apos;) {\n    opn(uri)\n  }\n  _resolve()\n})\n\nvar server = app.listen(port)\n\nmodule.exports = {\n  ready: readyPromise,\n  close: () =&gt; {\n    server.close()\n  }\n}\n</code></pre><p><strong>API/recommend.js &#x4F7F;&#x7528;jsonp &#x8C03;&#x53D6;&#x70ED;&#x95E8;&#x6B4C;&#x5355;&#x7684;&#x6570;&#x636E;</strong></p><pre><code>export function getDiscList() {\n  const url = &apos;/api/getDiscList&apos;\n\n  const data = Object.assign({}, commonParams, {\n    platform: &apos;yqq&apos;,\n    hostUin: 0,\n    sin: 0,\n    ein: 29,\n    sortId: 5,\n    needNewCode: 0,\n    categoryId: 10000000,\n    rnd: Math.random(),\n    format: &apos;json&apos;\n  })\n\n  return axios.get(url, {\n    params: data\n  }).then((res) =&gt; {\n    return Promise.resolve(res.data)\n  })\n}</code></pre><blockquote><code>&#x63A5;&#x4E0B;&#x6765;&#x5F00;&#x53D1;&#x63A8;&#x8350;&#x9875;&#x9762;&#x6EDA;&#x52A8;&#x5217;&#x8868;--&#x56E0;&#x4E3A;&#x5F88;&#x591A;&#x9875;&#x9762;&#x90FD;&#x652F;&#x6301;&#x6EDA;&#x52A8;&#xFF0C;&#x6240;&#x4EE5;&#x62BD;&#x51FA;&#x6765;&#x4E00;&#x4E2A;&#x516C;&#x7528;&#x7EC4;&#x4EF6;Scroll.vue</code></blockquote><pre><code>&lt;template&gt;\n  &lt;div ref=&quot;wrapper&quot;&gt;\n    &lt;slot&gt;&lt;/slot&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script type=&quot;text/ecmascript-6&quot;&gt;\n  import BScroll from &apos;better-scroll&apos;\n\n  export default {\n    props: {\n      probeType: {\n        type: Number,\n        default: 1\n      },\n      click: {\n        type: Boolean,\n        default: true\n      },\n      listenScroll: {\n        type: Boolean,\n        default: false\n      },\n      data: {\n        type: Array,\n        default: null\n      },\n      pullup: {\n        type: Boolean,\n        default: false\n      },\n      beforeScroll: {\n        type: Boolean,\n        default: false\n      },\n      refreshDelay: {\n        type: Number,\n        default: 20\n      }\n    },\n    mounted() {\n      setTimeout(() =&gt; {\n        this._initScroll()\n      }, 20)\n    },\n    methods: {\n      _initScroll() {\n        if (!this.$refs.wrapper) {\n          return\n        }\n        this.scroll = new BScroll(this.$refs.wrapper, {\n          probeType: this.probeType,\n          click: this.click\n        })\n\n        if (this.listenScroll) {\n          let me = this  //&#x6CE8;&#x610F;&#x8FD9;&#x5757;\n          this.scroll.on(&apos;scroll&apos;, (pos) =&gt; {\n            me.$emit(&apos;scroll&apos;, pos)\n          })\n        }\n\n        if (this.pullup) {\n          this.scroll.on(&apos;scrollEnd&apos;, () =&gt; {\n            if (this.scroll.y &lt;= (this.scroll.maxScrollY + 50)) {\n              this.$emit(&apos;scrollToEnd&apos;)\n            }\n          })\n        }\n\n        if (this.beforeScroll) {\n          this.scroll.on(&apos;beforeScrollStart&apos;, () =&gt; {\n            this.$emit(&apos;beforeScroll&apos;)\n          })\n        }\n      },\n      disable() {\n        this.scroll &amp;&amp; this.scroll.disable()\n      },\n      enable() {\n        this.scroll &amp;&amp; this.scroll.enable()\n      },\n      refresh() {\n        this.scroll &amp;&amp; this.scroll.refresh()\n      },\n      scrollTo() {\n        this.scroll &amp;&amp; this.scroll.scrollTo.apply(this.scroll, arguments)\n      },\n      scrollToElement() {\n        this.scroll &amp;&amp; this.scroll.scrollToElement.apply(this.scroll, arguments)\n      }\n    },\n    watch: {\n      data() {\n        setTimeout(() =&gt; {\n          this.refresh()\n        }, this.refreshDelay)\n      }\n    }\n  }\n&lt;/script&gt;</code></pre><p><strong>recommend.vue</strong></p><blockquote><code>&#x53EF;&#x80FD;&#x4F1A;&#x9047;&#x5230;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x521D;&#x59CB;&#x5316;&#x540E;&#x4E0D;&#x80FD;&#x6EDA;&#x52A8;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x9AD8;&#x5EA6;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x6240;&#x4EE5;&#x7ED9;img&#x52A0;&#x4E86;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x63D0;&#x5230;&#x4E86;vuex&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x90A3;&#x600E;&#x4E48;&#x7ED9;vuex&#x63D0;&#x4EA4;&#x6570;&#x636E;&#x7EC6;&#x5FC3;&#x7684;&#x540C;&#x5B66;&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x73B0;&#x2193;&#x2193;&#x2193;&#x2193;&#x2193;</code></blockquote><pre><code>&lt;template&gt;\n  &lt;div class=&quot;recommend&quot; ref=&quot;recommend&quot;&gt;\n    &lt;scroll ref=&quot;scroll&quot; class=&quot;recommend-content&quot; :data=&quot;discList&quot;&gt;\n      &lt;div&gt;\n        &lt;div v-if=&quot;recommends.length&quot; class=&quot;slider-wrapper&quot; ref=&quot;sliderWrapper&quot;&gt;\n          &lt;slider&gt;\n            &lt;div v-for=&quot;item in recommends&quot;&gt;\n              &lt;a :href=&quot;item.linkUrl&quot;&gt;\n                &lt;img class=&quot;needsclick&quot; @load=&quot;loadImage&quot; :src=&quot;item.picUrl&quot;&gt;\n                &lt;!-- &#x5982;&#x679C;fastclick&#x76D1;&#x542C;&#x5230;&#x6709;class&#x4E3A;needsclick&#x5C31;&#x4E0D;&#x4F1A;&#x62E6;&#x622A; --&gt;\n              &lt;/a&gt;\n            &lt;/div&gt;\n          &lt;/slider&gt;\n        &lt;/div&gt;\n        &lt;div class=&quot;recommend-list&quot;&gt;\n          &lt;h1 class=&quot;list-title&quot;&gt;&#x70ED;&#x95E8;&#x6B4C;&#x5355;&#x63A8;&#x8350;&lt;/h1&gt;\n          &lt;ul&gt;\n            &lt;li @click=&quot;selectItem(item)&quot; v-for=&quot;item in discList&quot; class=&quot;item&quot;&gt;\n              &lt;div class=&quot;icon&quot;&gt;\n                &lt;img width=&quot;60&quot; height=&quot;60&quot; v-lazy=&quot;item.imgurl&quot;&gt;\n              &lt;/div&gt;\n              &lt;div class=&quot;text&quot;&gt;\n                &lt;h2 class=&quot;name&quot; v-html=&quot;item.creator.name&quot;&gt;&lt;/h2&gt;\n                &lt;p class=&quot;desc&quot; v-html=&quot;item.dissname&quot;&gt;&lt;/p&gt;\n              &lt;/div&gt;\n            &lt;/li&gt;\n          &lt;/ul&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class=&quot;loading-container&quot; v-show=&quot;!discList.length&quot;&gt;\n        &lt;loading&gt;&lt;/loading&gt;\n      &lt;/div&gt;\n    &lt;/scroll&gt;\n   \n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script type=&quot;text/ecmascript-6&quot;&gt;\n  import Slider from &apos;base/slider/slider&apos;\n  import Loading from &apos;base/loading/loading&apos;\n  import Scroll from &apos;base/scroll/scroll&apos;\n  import {getRecommend, getDiscList} from &apos;api/recommend&apos;\n \n  import {ERR_OK} from &apos;api/config&apos;\n  import {mapMutations} from &apos;vuex&apos;\n\n  export default {\n    \n    data() {\n      return {\n        recommends: [],\n        discList: []\n      }\n    },\n    created() {\n      this._getRecommend()\n\n      this._getDiscList()\n    },\n    methods: {\n      \n      loadImage() {\n        if (!this.checkloaded) {\n          this.checkloaded = true\n          this.$refs.scroll.refresh()\n        }\n      },\n      selectItem(item) {\n        this.$router.push({\n          path: `/recommend/${item.dissid}`\n        })\n        this.setDisc(item)\n      },\n      _getRecommend() {\n        getRecommend().then((res) =&gt; {\n          if (res.code === ERR_OK) {\n            this.recommends = res.data.slider\n          }\n        })\n      },\n      _getDiscList() {\n        getDiscList().then((res) =&gt; {\n          if (res.code === ERR_OK) {\n            this.discList = res.data.list\n          }\n        })\n      },\n      ...mapMutations({\n        setDisc: &apos;SET_DISC&apos;\n      })\n    },\n    components: {\n      Slider,\n      Loading,\n      Scroll\n    }\n  }\n&lt;/script&gt;</code></pre><blockquote><code>&#x63A5;&#x4E0B;&#x6765;&#x662F;&#x6B4C;&#x624B;&#x9875;&#x9762;&#xFF0C;&#x7531;&#x4E8E;&#x8003;&#x8651;&#x5230;&#x4E8C;&#x7EA7;&#x8DEF;&#x7531;&#x8981;&#x8DF3;&#x5230;&#x6B4C;&#x624B;&#x8BE6;&#x60C5;&#xFF0C;&#x6240;&#x4EE5;&#x62BD;&#x51FA;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x7EC4;&#x4EF6;listview.vue&#xFF0C;&#x6D89;&#x53CA;&#x5230;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x5904;&#x7406;&#x3001;&#x7C7B;&#x7684;&#x521B;&#x5EFA;&#x3001;es6&#x7684;&#x5B57;&#x7B26;&#x62FC;&#x63A5;&#x3001;&#x6570;&#x7EC4;map&#x65B9;&#x6CD5;&#x3001;&#x81EA;&#x5B9A;&#x4E49;data&#x5C5E;&#x6027;&#x83B7;&#x53D6;&#x65B9;&#x6CD5;&#x7684;&#x5C01;&#x88C5;</code></blockquote><pre><code>&lt;template&gt;\n  &lt;scroll @scroll=&quot;scroll&quot;\n          :listen-scroll=&quot;listenScroll&quot;\n          :probe-type=&quot;probeType&quot;\n          :data=&quot;data&quot;\n          class=&quot;listview&quot;\n          ref=&quot;listview&quot;&gt;\n    &lt;ul&gt;\n      &lt;li v-for=&quot;group in data&quot; class=&quot;list-group&quot; ref=&quot;listGroup&quot;&gt;\n        &lt;h2 class=&quot;list-group-title&quot;&gt;{{group.title}}&lt;/h2&gt;\n        &lt;uL&gt;\n          &lt;li @click=&quot;selectItem(item)&quot; v-for=&quot;item in group.items&quot; class=&quot;list-group-item&quot;&gt;\n            &lt;img class=&quot;avatar&quot; v-lazy=&quot;item.avatar&quot;&gt;\n            &lt;span class=&quot;name&quot;&gt;{{item.name}}&lt;/span&gt;\n          &lt;/li&gt;\n        &lt;/uL&gt;\n      &lt;/li&gt;\n    &lt;/ul&gt;\n    &lt;div class=&quot;list-shortcut&quot; @touchstart.stop.prevent=&quot;onShortcutTouchStart&quot; @touchmove.stop.prevent=&quot;onShortcutTouchMove&quot;\n         @touchend.stop&gt;\n      &lt;ul&gt;\n        &lt;li v-for=&quot;(item, index) in shortcutList&quot; :data-index=&quot;index&quot; class=&quot;item&quot;\n            :class=&quot;{&apos;current&apos;:currentIndex===index}&quot;&gt;{{item}}\n        &lt;/li&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n    &lt;div class=&quot;list-fixed&quot; ref=&quot;fixed&quot; v-show=&quot;fixedTitle&quot;&gt;\n      &lt;div class=&quot;fixed-title&quot;&gt;{{fixedTitle}} &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div v-show=&quot;!data.length&quot; class=&quot;loading-container&quot;&gt;\n      &lt;loading&gt;&lt;/loading&gt;\n    &lt;/div&gt;\n  &lt;/scroll&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\n  import Scroll from &apos;base/scroll/scroll&apos;\n  import Loading from &apos;base/loading/loading&apos;\n  import {getData} from &apos;common/js/dom&apos;\n\n  const TITLE_HEIGHT = 30\n  const ANCHOR_HEIGHT = 18  //&#x6837;&#x5F0F;&#x7684;&#x9AD8;&#x5EA6;\n\n  export default {\n    props: {\n      data: {\n        type: Array,\n        default: []\n      }\n    },\n    computed: {\n      shortcutList() {\n        return this.data.map((group) =&gt; {\n          return group.title.substr(0, 1)\n        })\n      },\n      fixedTitle() {\n        if (this.scrollY &gt; 0) {\n          return &apos;&apos;\n        }\n        return this.data[this.currentIndex] ? this.data[this.currentIndex].title : &apos;&apos;\n      }\n    },\n    data() {\n      return {\n        scrollY: -1,\n        currentIndex: 0,\n        diff: -1\n      }\n    },\n    created() {\n      this.probeType = 3\n      this.listenScroll = true\n      this.touch = {}\n      this.listHeight = []\n    },\n    methods: {\n      selectItem(item) {\n        this.$emit(&apos;select&apos;, item)\n      },\n      onShortcutTouchStart(e) {\n        let anchorIndex = getData(e.target, &apos;index&apos;)\n        let firstTouch = e.touches[0] //&#x7B2C;&#x4E00;&#x4E2A;&#x624B;&#x6307;&#x7684;&#x4F4D;&#x7F6E;\n        this.touch.y1 = firstTouch.pageY  \n        this.touch.anchorIndex = anchorIndex\n\n        this._scrollTo(anchorIndex)\n      },\n      onShortcutTouchMove(e) {\n        let firstTouch = e.touches[0]\n        this.touch.y2 = firstTouch.pageY\n        let delta = (this.touch.y2 - this.touch.y1) / ANCHOR_HEIGHT | 0  //&#x6216;0 &#x76F8;&#x5F53;&#x4E8E;&#x5411;&#x4E0B;&#x53D6;&#x6574;\n        let anchorIndex = parseInt(this.touch.anchorIndex) + delta\n\n        this._scrollTo(anchorIndex)\n      },\n      refresh() {\n        this.$refs.listview.refresh()\n      },\n      scroll(pos) {\n        this.scrollY = pos.y\n      },\n      _calculateHeight() {\n        this.listHeight = []\n        const list = this.$refs.listGroup\n        let height = 0\n        this.listHeight.push(height)\n        for (let i = 0; i &lt; list.length; i++) {\n          let item = list[i]\n          height += item.clientHeight\n          this.listHeight.push(height)\n        }  //&#x83B7;&#x53D6;&#x5230;&#x4ECE;&#x7B2C;&#x4E00;&#x4E2A;&#x5230;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x6BCF;&#x4E00;&#x4E2A;&#x7684;height\n      },\n      _scrollTo(index) {\n        if (!index &amp;&amp; index !== 0) {\n          return\n        }\n        if (index &lt; 0) {\n          index = 0\n        } else if (index &gt; this.listHeight.length - 2) {\n          index = this.listHeight.length - 2\n        }\n        this.scrollY = -this.listHeight[index]\n        this.$refs.listview.scrollToElement(this.$refs.listGroup[index], 0)\n      }\n    },\n    watch: {\n      data() {\n        setTimeout(() =&gt; {\n          this._calculateHeight()\n        }, 20)\n      },\n      scrollY(newY) {\n        const listHeight = this.listHeight\n        // &#x5F53;&#x6EDA;&#x52A8;&#x5230;&#x9876;&#x90E8;&#xFF0C;newY&gt;0\n        if (newY &gt; 0) {\n          this.currentIndex = 0\n          return\n        }\n        // &#x5728;&#x4E2D;&#x95F4;&#x90E8;&#x5206;&#x6EDA;&#x52A8;\n        for (let i = 0; i &lt; listHeight.length - 1; i++) {\n          let height1 = listHeight[i]\n          let height2 = listHeight[i + 1]\n          if (-newY &gt;= height1 &amp;&amp; -newY &lt; height2) { //newY&#x5F80;&#x4E0A;&#x6ED1;&#x662F;&#x8D1F;&#x503C; --&#x53D8;&#x6B63;\n            this.currentIndex = i\n            this.diff = height2 + newY\n            return\n          }\n        }\n        // &#x5F53;&#x6EDA;&#x52A8;&#x5230;&#x5E95;&#x90E8;&#xFF0C;&#x4E14;-newY&#x5927;&#x4E8E;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x7684;&#x4E0A;&#x9650;\n        this.currentIndex = listHeight.length - 2\n      },\n      diff(newVal) {\n        let fixedTop = (newVal &gt; 0 &amp;&amp; newVal &lt; TITLE_HEIGHT) ? newVal - TITLE_HEIGHT : 0\n        if (this.fixedTop === fixedTop) {\n          return\n        }\n        this.fixedTop = fixedTop\n        this.$refs.fixed.style.transform = `translate3d(0,${fixedTop}px,0)`\n      }\n    },\n    components: {\n      Scroll,\n      Loading\n    }\n  }\n\n&lt;/script&gt;\n</code></pre><p><strong>singer.vue</strong></p><blockquote><code>&#x5F15;&#x5165;listview&#x7EC4;&#x4EF6;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;20&#x6BEB;&#x79D2;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#xFF0C;&#x5173;&#x952E;&#x5728;&#x4E8E;&#x5DE6;&#x53F3;&#x8054;&#x52A8;&#x7684;&#x601D;&#x8DEF;&#x5F88;&#x91CD;&#x8981;&#xFF0C;&#x4EE5;&#x53CA;&#x5173;&#x4E8E;diff&#x7684;&#x5904;&#x7406;&#x589E;&#x5F3A;&#x7528;&#x6237;&#x4F53;&#x9A8C;</code></blockquote><pre><code>&lt;template&gt;\n  &lt;div class=&quot;singer&quot; ref=&quot;singer&quot;&gt;\n    &lt;list-view @select=&quot;selectSinger&quot; :data=&quot;singers&quot; ref=&quot;list&quot;&gt;&lt;/list-view&gt;\n    &lt;router-view&gt;&lt;/router-view&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\n  import ListView from &apos;base/listview/listview&apos;\n  import {getSingerList} from &apos;api/singer&apos;\n  import {ERR_OK} from &apos;api/config&apos;\n  import Singer from &apos;common/js/singer&apos;\n  import {mapMutations} from &apos;vuex&apos;  //&#x5BF9;Mutations&#x7684;&#x5C01;&#x88C5;\n  import {playlistMixin} from &apos;common/js/mixin&apos;\n\n  const HOT_SINGER_LEN = 10\n  const HOT_NAME = &apos;&#x70ED;&#x95E8;&apos;\n\n  export default {\n    mixins: [playlistMixin],\n    data() {\n      return {\n        singers: []\n      }\n    },\n    created() {\n      this._getSingerList()\n    },\n    methods: {\n      handlePlaylist(playlist) {\n        const bottom = playlist.length &gt; 0 ? &apos;60px&apos; : &apos;&apos;\n        this.$refs.singer.style.bottom = bottom\n        this.$refs.list.refresh()\n      },\n      selectSinger(singer) {\n        this.$router.push({\n          path: `/singer/${singer.id}`\n        })\n        this.setSinger(singer)\n      },\n      _getSingerList() {\n        getSingerList().then((res) =&gt; {\n          if (res.code === ERR_OK) {\n            this.singers = this._normalizeSinger(res.data.list)\n          }\n        })\n      },\n      _normalizeSinger(list) {\n        let map = {\n          hot: {\n            title: HOT_NAME,\n            items: []\n          }\n        }\n        list.forEach((item, index) =&gt; {\n          if (index &lt; HOT_SINGER_LEN) {\n            map.hot.items.push(new Singer({\n              name: item.Fsinger_name,\n              id: item.Fsinger_mid\n            }))\n          }\n          const key = item.Findex\n          if (!map[key]) {\n            map[key] = {\n              title: key,\n              items: []\n            }\n          }\n          map[key].items.push(new Singer({\n            name: item.Fsinger_name,\n            id: item.Fsinger_mid\n          }))\n        })\n        // &#x4E3A;&#x4E86;&#x5F97;&#x5230;&#x6709;&#x5E8F;&#x5217;&#x8868;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5904;&#x7406; map\n        let ret = []\n        let hot = []\n        for (let key in map) {\n          let val = map[key]\n          if (val.title.match(/[a-zA-Z]/)) {\n            ret.push(val)\n          } else if (val.title === HOT_NAME) {\n            hot.push(val)\n          }\n        }\n        ret.sort((a, b) =&gt; {\n          return a.title.charCodeAt(0) - b.title.charCodeAt(0)\n        })\n        return hot.concat(ret)\n      },\n      ...mapMutations({\n        setSinger: &apos;SET_SINGER&apos;\n      })\n    },\n    components: {\n      ListView\n    }\n  }\n\n&lt;/script&gt;\n\n</code></pre><blockquote><code>&#x6B4C;&#x624B;&#x8BE6;&#x60C5;&#x9875;&#xFF0C;&#x4E3A;&#x4E86;&#x7EC4;&#x4EF6;&#x91CD;&#x7528;&#x62BD;&#x51FA;&#x6765;&#x4E00;&#x4E2A;music-list.vue,&#x5728;&#x6B64;&#x57FA;&#x7840;&#x53C8;&#x62BD;&#x51FA;&#x6765;&#x4E00;&#x4E2A;song-list.vue&#xFF0C;&#x7528;&#x5230;&#x4E86;v-html&#x6765;&#x8F6C;&#x4E49;&#x5B57;&#x7B26;&#x3001;&#x8BA1;&#x7B97;&#x5C5E;&#x6027;&#x91CC;&#x8FD4;&#x56DE;&#x5BF9;&#x8C61;&#x7684;&#x67D0;&#x51E0;&#x4E2A;key&#x6BD4;&#x5982;&#x53EA;&#x4F20;&#x5165;name&#x6216;&#x8005;&#x5934;&#x50CF;&#x3001;mapGetters&#x83B7;&#x53D6;vuex&#x7684;&#x6570;&#x636E;</code></blockquote><pre><code>&lt;template&gt;\n  &lt;div class=&quot;song-list&quot;&gt;\n    &lt;ul&gt;\n      &lt;li @click=&quot;selectItem(song, index)&quot; class=&quot;item&quot; v-for=&quot;(song, index) in songs&quot;&gt;\n        &lt;div class=&quot;rank&quot; v-show=&quot;rank&quot;&gt;\n          &lt;span :class=&quot;getRankCls(index)&quot; v-text=&quot;getRankText(index)&quot;&gt;&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;div class=&quot;content&quot;&gt;\n          &lt;h2 class=&quot;name&quot;&gt;{{song.name}}&lt;/h2&gt;\n          &lt;p class=&quot;desc&quot;&gt;{{getDesc(song)}}&lt;/p&gt;\n        &lt;/div&gt;\n      &lt;/li&gt;\n    &lt;/ul&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script &gt;\n  export default {\n    props: {\n      songs: {\n        type: Array,\n        default: []\n      },\n      rank: {\n        type: Boolean,\n        default: false\n      }\n    },\n    methods: {\n      selectItem(item, index) {\n        this.$emit(&apos;select&apos;, item, index)\n      },\n      getDesc(song) {\n        return `${song.singer}&#xB7;${song.album}`\n      },\n      getRankCls(index) {\n        if (index &lt;= 2) {\n          return `icon icon${index}`\n        } else {\n          return &apos;text&apos;\n        }\n      },\n      getRankText(index) {\n        if (index &gt; 2) {\n          return index + 1\n        }\n      }\n    }\n  }\n&lt;/script&gt;</code></pre><hr><pre><code>&lt;template&gt;\n  &lt;div class=&quot;music-list&quot;&gt;\n    &lt;div class=&quot;back&quot; @click=&quot;back&quot;&gt;\n      &lt;i class=&quot;icon-back&quot;&gt;&lt;/i&gt;\n    &lt;/div&gt;\n    &lt;h1 class=&quot;title&quot; v-html=&quot;title&quot;&gt;&lt;/h1&gt;\n    &lt;div class=&quot;bg-image&quot; :style=&quot;bgStyle&quot; ref=&quot;bgImage&quot;&gt;\n      &lt;div class=&quot;play-wrapper&quot;&gt;\n        &lt;div ref=&quot;playBtn&quot; v-show=&quot;songs.length&gt;0&quot; class=&quot;play&quot; @click=&quot;random&quot;&gt;&lt;!-- &#x5F53;&#x6570;&#x636E;&#x6709;&#x4E86;&#x4EE5;&#x540E;&#x518D;&#x663E;&#x793A;v-show --&gt;\n          &lt;i class=&quot;icon-play&quot;&gt;&lt;/i&gt;\n          &lt;span class=&quot;text&quot;&gt;&#x968F;&#x673A;&#x64AD;&#x653E;&#x5168;&#x90E8;&lt;/span&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class=&quot;filter&quot; ref=&quot;filter&quot;&gt;&lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div class=&quot;bg-layer&quot; ref=&quot;layer&quot;&gt;&lt;/div&gt;\n    &lt;scroll :data=&quot;songs&quot; @scroll=&quot;scroll&quot;\n            :listen-scroll=&quot;listenScroll&quot; :probe-type=&quot;probeType&quot; class=&quot;list&quot; ref=&quot;list&quot;&gt;\n      &lt;div class=&quot;song-list-wrapper&quot;&gt;\n        &lt;song-list :songs=&quot;songs&quot; :rank=&quot;rank&quot; @select=&quot;selectItem&quot;&gt;&lt;/song-list&gt;\n      &lt;/div&gt;\n      &lt;div v-show=&quot;!songs.length&quot; class=&quot;loading-container&quot;&gt;\n        &lt;loading&gt;&lt;/loading&gt;\n      &lt;/div&gt;\n    &lt;/scroll&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script &gt;\n  import Scroll from &apos;base/scroll/scroll&apos;\n  import Loading from &apos;base/loading/loading&apos;\n  import SongList from &apos;base/song-list/song-list&apos;\n  import {prefixStyle} from &apos;common/js/dom&apos;\n  import {playlistMixin} from &apos;common/js/mixin&apos;\n  import {mapActions} from &apos;vuex&apos;\n\n  const RESERVED_HEIGHT = 40\n  const transform = prefixStyle(&apos;transform&apos;)\n  const backdrop = prefixStyle(&apos;backdrop-filter&apos;)\n\n  export default {\n    mixins: [playlistMixin],\n    props: {\n      bgImage: {\n        type: String,\n        default: &apos;&apos;\n      },\n      songs: {\n        type: Array,\n        default: []\n      },\n      title: {\n        type: String,\n        default: &apos;&apos;\n      },\n      rank: {\n        type: Boolean,\n        default: false\n      }\n    },\n    data() {\n      return {\n        scrollY: 0\n      }\n    },\n    computed: {\n      bgStyle() {\n        return `background-image:url(${this.bgImage})`\n      }\n    },\n    created() {\n      this.probeType = 3\n      this.listenScroll = true\n    },\n    mounted() {\n      this.imageHeight = this.$refs.bgImage.clientHeight\n      this.minTransalteY = -this.imageHeight + RESERVED_HEIGHT\n      this.$refs.list.$el.style.top = `${this.imageHeight}px`\n    },\n    methods: {\n      handlePlaylist(playlist) {\n        const bottom = playlist.length &gt; 0 ? &apos;60px&apos; : &apos;&apos;\n        this.$refs.list.$el.style.bottom = bottom\n        this.$refs.list.refresh()\n      },\n      scroll(pos) {\n        this.scrollY = pos.y\n      },\n      back() {\n        this.$router.back()\n      },\n      selectItem(item, index) {\n        this.selectPlay({\n          list: this.songs,\n          index\n        })\n      },\n      random() {\n        this.randomPlay({\n          list: this.songs\n        })\n      },\n      ...mapActions([\n        &apos;selectPlay&apos;,\n        &apos;randomPlay&apos;\n      ])\n    },\n    watch: {\n      scrollY(newVal) {\n        let translateY = Math.max(this.minTransalteY, newVal) //&#x6700;&#x8FDC;&#x6EDA;&#x52A8;&#x4F4D;&#x7F6E;\n        let scale = 1\n        let zIndex = 0\n        let blur = 0\n        const percent = Math.abs(newVal / this.imageHeight)\n        if (newVal &gt; 0) {\n          scale = 1 + percent\n          zIndex = 10\n        } else {\n          blur = Math.min(20, percent * 20)\n        }\n\n        this.$refs.layer.style[transform] = `translate3d(0,${translateY}px,0)`\n        this.$refs.filter.style[backdrop] = `blur(${blur}px)`\n        if (newVal &lt; this.minTransalteY) {\n          zIndex = 10\n          this.$refs.bgImage.style.paddingTop = 0\n          this.$refs.bgImage.style.height = `${RESERVED_HEIGHT}px`\n          this.$refs.playBtn.style.display = &apos;none&apos;\n        } else { //&#x8FD8;&#x6CA1;&#x6EDA;&#x52A8;&#x5230;&#x90A3;&#x4E2A;&#x4F4D;&#x7F6E;\n          this.$refs.bgImage.style.paddingTop = &apos;70%&apos;\n          this.$refs.bgImage.style.height = 0\n          this.$refs.playBtn.style.display = &apos;&apos;\n        }\n        this.$refs.bgImage.style[transform] = `scale(${scale})`\n        this.$refs.bgImage.style.zIndex = zIndex\n      }\n    },\n    components: {\n      Scroll,\n      Loading,\n      SongList\n    }\n  }\n&lt;/script&gt;</code></pre><hr><blockquote><code>&#x4E0B;&#x9762;&#x662F;&#x7236;&#x7EC4;&#x4EF6;&#x6B4C;&#x624B;&#x8BE6;&#x60C5;&#xFF0C;&#x5C01;&#x88C5;&#x4E86;&#x4E00;&#x4E2A;createSong&#x7684;&#x7C7B;&#xFF0C;&#x53EF;&#x5728;&#x6E90;&#x7801;&#x4E2D;&#x67E5;&#x770B;&#x63D0;&#x9AD8;&#x4E86;&#x4EE3;&#x7801;&#x7684;&#x91CD;&#x7528;&#x6027;&#x3001;&#x6269;&#x5C55;&#x6027;&#x56E0;&#x4E3A;&#x662F;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x5F0F;</code></blockquote><pre><code>&lt;template&gt;\n  &lt;transition name=&quot;slide&quot;&gt;\n    &lt;music-list :title=&quot;title&quot; :bg-image=&quot;bgImage&quot; :songs=&quot;songs&quot;&gt;&lt;/music-list&gt;\n  &lt;/transition&gt;\n&lt;/template&gt;\n\n&lt;script type=&quot;text/ecmascript-6&quot;&gt;\n  import MusicList from &apos;components/music-list/music-list&apos;\n  import {getSingerDetail} from &apos;api/singer&apos;\n  import {ERR_OK} from &apos;api/config&apos;\n  import {createSong} from &apos;common/js/song&apos;\n  import {mapGetters} from &apos;vuex&apos;\n\n  export default {\n    computed: {\n      title() {\n        return this.singer.name\n      },\n      bgImage() {\n        return this.singer.avatar\n      },\n      ...mapGetters([\n        &apos;singer&apos;\n      ])\n    },\n    data() {\n      return {\n        songs: []\n      }\n    },\n    created() {\n      this._getDetail()\n    },\n    methods: {\n      _getDetail() {\n        if (!this.singer.id) {\n          this.$router.push(&apos;/singer&apos;)\n          return\n        }       //&#x5904;&#x7406;&#x8FB9;&#x95F4;&#x7684;&#x4F8B;&#x5B50;\n        getSingerDetail(this.singer.id).then((res) =&gt; {\n          if (res.code === ERR_OK) {\n            this.songs = this._normalizeSongs(res.data.list)\n          }\n        })\n      },\n      _normalizeSongs(list) {\n        let ret = []\n        list.forEach((item) =&gt; {\n          let {musicData} = item\n          if (musicData.songid &amp;&amp; musicData.albummid) {\n            ret.push(createSong(musicData))\n          }\n        })\n        return ret\n      }\n    },\n    components: {\n      MusicList\n    }\n  }\n&lt;/script&gt;</code></pre><blockquote><code>&#x64AD;&#x653E;&#x5668;&#x5185;&#x7F6E;&#x7EC4;&#x4EF6; player.vue&#xFF0C;&#x901A;&#x8FC7;actions&#x7684;&#x65B9;&#x6CD5;--selectPlay,&#x5728;&#x6B64;&#x7EC4;&#x4EF6;&#x62FF;&#x5230;currentSong&#xFF0C;&#x8FD9;&#x91CC;&#x518D;&#x91CD;&#x70B9;&#x8BF4;&#x4E00;&#x4E0B;mutations&#x548C;&#x5B83;&#x7684;type&#x8981;&#x505A;&#x5230;&#x547D;&#x540D;&#x4E00;&#x81F4;&#xFF0C;nutations&#x672C;&#x8D28;&#x5C31;&#x662F;&#x51FD;&#x6570;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x662F;state&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x8981;&#x4FEE;&#x6539;&#x7684;&#x5BF9;&#x8C61;&#x503C;</code></blockquote><p><strong>player&#x7EC4;&#x4EF6;&#x5B9A;&#x4E49;&#x5230;&#x4E86;app.vue&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4E0D;&#x5C5E;&#x4E8E;&#x67D0;&#x4E00;&#x4E2A;&#x9875;&#x9762;&#x662F;&#x5168;&#x5C40;&#x7684;&#xFF0C;mapgetters&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x591A;&#x6B21;&#x6279;&#x91CF;&#x4FEE;&#x6539;mutation&#x5C31;&#x8981;&#x7528;&#x5230;actions</strong></p><blockquote><code>&#x91CD;&#x70B9;&#x662F;&#x52A8;&#x753B;&#x7684;&#x8FC7;&#x5EA6;&#x6548;&#x679C;&#xFF0C;&#x7ED3;&#x5408;&#x94A9;&#x5B50;&#x51FD;&#x6570;&#x5B9E;&#x73B0;&#x98DE;&#x5165;&#x98DE;&#x51FA;&#x52A8;&#x753B;&#xFF0C;&#x7528;&#x5230;&#x4E86;&#x5F00;&#x6E90;&#x52A8;&#x753B;&#x5E93;&#xFF0C;create-key-animation</code></blockquote><p><strong>&#x97F3;&#x4E50;&#x64AD;&#x653E;&#x4E8B;&#x4EF6;togglePlaying&#xFF0C;&#x56E0;&#x4E3A;&#x64AD;&#x653E;&#x7684;&#x6682;&#x505C;&#x5F00;&#x59CB;&#x8981;&#x8C03;&#x7528;audio&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x51FA;&#x73B0;&#x62FF;&#x4E0D;&#x5230;&#x5143;&#x7D20;&#x62A5;&#x9519;&#xFF0C;&#x8FD9;&#x662F;&#x7528;&#x5230;&#x4E86;nextTic&#x5EF6;&#x65F6;&#x51FD;&#x6570;&#xFF0C;&#x6DFB;&#x52A0;class&#x53EF;&#x4EE5;&#x7528;&#x5230;&#x8BA1;&#x7B97;&#x5C5E;&#x6027;&#xFF0C;&#x6B4C;&#x66F2;&#x7684;&#x524D;&#x8FDB;&#x540E;&#x9000;&#x901A;&#x8FC7;currentIndex&#xFF0C;&#x6709;&#x4E00;&#x4E2A;&#x5C0F;&#x95EE;&#x9898;&#xFF0C;&#x6682;&#x505C;&#x540E;&#x5207;&#x6362;&#x5230;&#x4E0B;&#x4E00;&#x9996;&#x6B4C;&#x8981;&#x81EA;&#x52A8;&#x64AD;&#x653E;&#xFF0C;&#x5FEB;&#x901F;&#x70B9;&#x51FB;&#x7684;&#x65F6;&#x5019;&#x7ED3;&#x5408; ready err&#x65B9;&#x6CD5;&#x907F;&#x514D;&#x5FEB;&#x901F;&#x70B9;&#x51FB;&#x9875;&#x9762;&#x62A5;&#x9519;</strong></p><blockquote><code>&#x6761;&#x5F62;&#x8FDB;&#x5EA6;&#x6761;&#xFF0C;&#x901A;&#x8FC7;audio&#x83B7;&#x53D6;&#x53EF;&#x4EE5;&#x8BFB;&#x5199;&#x7684;&#x5F53;&#x524D;&#x64AD;&#x653E;&#x65F6;&#x95F4;&#xFF0C;&#x5C06;&#x5176;&#x65F6;&#x95F4;&#x6233;&#x8F6C;&#x4E3A;&#x65F6;&#x5206;&#x79D2;&#x683C;&#x5F0F;&#xFF0C;&#x901A;&#x8FC7;_pad&#x7ED9;&#x79D2;&#x4F4D;&#x524D;&#x8865;&#x96F6;&#xFF0C;&#x505A;&#x5230;&#x4E0E;&#x8BBE;&#x8BA1;&#x56FE;&#x4E00;&#x81F4;&#xFF0C;&#x5B9A;&#x4E49;&#x57FA;&#x7840;&#x7EC4;&#x4EF6;progress-bar&#xFF0C;&#x4E8B;&#x4EF6;&#x62D6;&#x52A8;&#x548C;&#x70B9;&#x51FB;&#x6EDA;&#x52A8;&#x6761;&#x7684;&#x4EA4;&#x4E92;&#x5B9E;&#x73B0;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x62D6;&#x52A8;&#x65E0;&#x975E;&#x5C31;&#x662F;&#x4E09;&#x4E2A;&#x4E8B;&#x4EF6;&#xFF0C;start move end&#xFF0C;&#x62D6;&#x52A8;&#x5F00;&#x59CB;&#x524D;&#x52A0;&#x4E00;&#x4E2A;&#x5F00;&#x5173;&#x8868;&#x793A;&#x521D;&#x59CB;&#x5316;&#x5B8C;&#x6210;&#xFF0C;&#x5982;&#x679C;&#x62D6;&#x52A8;&#x524D;&#x662F;&#x6682;&#x505C;&#x72B6;&#x6001;&#xFF0C;&#x62D6;&#x52A8;&#x540E;&#x518D;&#x8BA9;&#x5176;&#x64AD;&#x653E;</code></blockquote><p><strong>&#x5706;&#x5F62;&#x8FDB;&#x5EA6;&#x6761;&#xFF0C;&#x7528;&#x5230;&#x4E86;SVG&#x518D;&#x901A;&#x8FC7;&#x4E24;&#x4E2A;circle&#x5B9E;&#x73B0;&#xFF0C;&#x5B8C;&#x5168;&#x53EF;&#x4EE5;&#x5E94;&#x7528;&#x5230;&#x5B9E;&#x9645;&#x5DE5;&#x4F5C;&#x4E2D;</strong></p><blockquote><code>&#x64AD;&#x653E;&#x6A21;&#x5F0F;&#xFF0C;&#x7528;&#x5230;util&#x91CC;&#x9762;&#x7684;shuttle&#x51FD;&#x6570;&#x628A;&#x6570;&#x7EC4;&#x6253;&#x4E71;&#xFF0C;&#x7528;&#x5230;es6&#x7684;findindex&#x51FD;&#x6570;&#xFF0C;&#x7531;&#x4E8E;&#x8981;&#x5B9E;&#x65F6;&#x6539;&#x53D8;currentSong&#xFF0C;&#x7236;&#x7EC4;&#x4EF6;&#x76D1;&#x542C;&#x4E8B;&#x4EF6;&#x4F1A;&#x88AB;&#x89E6;&#x53D1;&#x6240;&#x4EE5;&#x505A;&#x4E86;&#x4E00;&#x4E2A;&#x5224;&#x65AD;&#xFF0C;&#x5982;&#x679C;id&#x76F8;&#x540C;&#x4EC0;&#x4E48;&#x90FD;&#x4E0D;&#x9519;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x8FD8;&#x6CA1;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;</code></blockquote><pre><code>&lt;template&gt;\n  &lt;div class=&quot;progress-bar&quot; ref=&quot;progressBar&quot; @click=&quot;progressClick&quot;&gt;\n    &lt;div class=&quot;bar-inner&quot;&gt;\n      &lt;div class=&quot;progress&quot; ref=&quot;progress&quot;&gt;&lt;/div&gt;\n      &lt;div class=&quot;progress-btn-wrapper&quot; ref=&quot;progressBtn&quot;\n           @touchstart.prevent=&quot;progressTouchStart&quot;\n           @touchmove.prevent=&quot;progressTouchMove&quot;\n           @touchend=&quot;progressTouchEnd&quot;\n      &gt;\n        &lt;div class=&quot;progress-btn&quot;&gt;&lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\n  import {prefixStyle} from &apos;common/js/dom&apos;\n\n  const progressBtnWidth = 16\n  const transform = prefixStyle(&apos;transform&apos;)\n\n  export default {\n    props: {\n      percent: {\n        type: Number,\n        default: 0\n      }\n    },\n    created() {\n      this.touch = {}\n    },\n    methods: {\n      progressTouchStart(e) {\n        this.touch.initiated = true\n        this.touch.startX = e.touches[0].pageX\n        this.touch.left = this.$refs.progress.clientWidth\n      },\n      progressTouchMove(e) {\n        if (!this.touch.initiated) {\n          return\n        }\n        const deltaX = e.touches[0].pageX - this.touch.startX\n        const offsetWidth = Math.min(this.$refs.progressBar.clientWidth - progressBtnWidth, Math.max(0, this.touch.left + deltaX))\n        this._offset(offsetWidth)\n      },\n      progressTouchEnd() {\n        this.touch.initiated = false\n        this._triggerPercent()\n      },\n      progressClick(e) {\n        const rect = this.$refs.progressBar.getBoundingClientRect()\n        const offsetWidth = e.pageX - rect.left\n        this._offset(offsetWidth)\n        // &#x8FD9;&#x91CC;&#x5F53;&#x6211;&#x4EEC;&#x70B9;&#x51FB; progressBtn &#x7684;&#x65F6;&#x5019;&#xFF0C;e.offsetX &#x83B7;&#x53D6;&#x4E0D;&#x5BF9;\n        // this._offset(e.offsetX)\n        this._triggerPercent()\n      },\n      _triggerPercent() {\n        const barWidth = this.$refs.progressBar.clientWidth - progressBtnWidth\n        const percent = this.$refs.progress.clientWidth / barWidth\n        this.$emit(&apos;percentChange&apos;, percent)\n      },\n      _offset(offsetWidth) {\n        this.$refs.progress.style.width = `${offsetWidth}px`\n        this.$refs.progressBtn.style[transform] = `translate3d(${offsetWidth}px,0,0)`\n      }\n    },\n    watch: {\n      percent(newPercent) {\n        if (newPercent &gt;= 0 &amp;&amp; !this.touch.initiated) {\n          const barWidth = this.$refs.progressBar.clientWidth - progressBtnWidth\n          const offsetWidth = newPercent * barWidth\n          this._offset(offsetWidth)\n        }\n      }\n    }\n  }\n&lt;/script&gt;\n\n&lt;style scoped lang=&quot;stylus&quot; rel=&quot;stylesheet/stylus&quot;&gt;\n  @import &quot;~common/stylus/variable&quot;\n\n  .progress-bar\n    height: 30px\n    .bar-inner\n      position: relative\n      top: 13px\n      height: 4px\n      background: rgba(0, 0, 0, 0.3)\n      .progress\n        position: absolute\n        height: 100%\n        background: $color-theme\n      .progress-btn-wrapper\n        position: absolute\n        left: -8px\n        top: -13px\n        width: 30px\n        height: 30px\n        .progress-btn\n          position: relative\n          top: 7px\n          left: 7px\n          box-sizing: border-box\n          width: 16px\n          height: 16px\n          border: 3px solid $color-text\n          border-radius: 50%\n          background: $color-theme\n&lt;/style&gt;</code></pre><pre><code>&lt;template&gt;\n  &lt;div class=&quot;progress-circle&quot;&gt;\n    &lt;svg :width=&quot;radius&quot; :height=&quot;radius&quot; viewBox=&quot;0 0 100 100&quot; version=&quot;1.1&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;\n      &lt;circle class=&quot;progress-background&quot; r=&quot;50&quot; cx=&quot;50&quot; cy=&quot;50&quot; fill=&quot;transparent&quot;/&gt;\n      &lt;circle class=&quot;progress-bar&quot; r=&quot;50&quot; cx=&quot;50&quot; cy=&quot;50&quot; fill=&quot;transparent&quot; :stroke-dasharray=&quot;dashArray&quot;\n              :stroke-dashoffset=&quot;dashOffset&quot;/&gt;\n    &lt;/svg&gt;\n    &lt;slot&gt;&lt;/slot&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script type=&quot;text/ecmascript-6&quot;&gt;\n  export default {\n    props: {\n      radius: {\n        type: Number,\n        default: 100\n      },\n      percent: {\n        type: Number,\n        default: 0\n      }\n    },\n    data() {\n      return {\n        dashArray: Math.PI * 100\n      }\n    },\n    computed: {\n      dashOffset() {\n        return (1 - this.percent) * this.dashArray\n      }\n    }\n  }\n&lt;/script&gt;\n\n&lt;style scoped lang=&quot;stylus&quot; rel=&quot;stylesheet/stylus&quot;&gt;\n  @import &quot;~common/stylus/variable&quot;\n\n  .progress-circle\n    position: relative\n    circle\n      stroke-width: 8px\n      transform-origin: center\n      &amp;.progress-background\n        transform: scale(0.9)\n        stroke: $color-theme-d\n      &amp;.progress-bar\n        transform: scale(0.9) rotate(-90deg)\n        stroke: $color-theme\n&lt;/style&gt;</code></pre><pre><code>&lt;template&gt;\n  &lt;div class=&quot;player&quot; v-show=&quot;playlist.length&gt;0&quot;&gt;\n    &lt;transition name=&quot;normal&quot;\n                @enter=&quot;enter&quot;\n                @after-enter=&quot;afterEnter&quot;\n                @leave=&quot;leave&quot;\n                @after-leave=&quot;afterLeave&quot;\n    &gt;\n      &lt;div class=&quot;normal-player&quot; v-show=&quot;fullScreen&quot;&gt;\n        &lt;div class=&quot;background&quot;&gt;\n          &lt;img width=&quot;100%&quot; height=&quot;100%&quot; :src=&quot;currentSong.image&quot;&gt;\n        &lt;/div&gt;\n        &lt;div class=&quot;top&quot;&gt;\n          &lt;div class=&quot;back&quot; @click=&quot;back&quot;&gt;\n            &lt;i class=&quot;icon-back&quot;&gt;&lt;/i&gt;\n          &lt;/div&gt;\n          &lt;h1 class=&quot;title&quot; v-html=&quot;currentSong.name&quot;&gt;&lt;/h1&gt;\n          &lt;h2 class=&quot;subtitle&quot; v-html=&quot;currentSong.singer&quot;&gt;&lt;/h2&gt;\n        &lt;/div&gt;\n        &lt;div class=&quot;middle&quot;\n             @touchstart.prevent=&quot;middleTouchStart&quot;\n             @touchmove.prevent=&quot;middleTouchMove&quot;\n             @touchend=&quot;middleTouchEnd&quot;\n        &gt;\n          &lt;div class=&quot;middle-l&quot; ref=&quot;middleL&quot;&gt;\n            &lt;div class=&quot;cd-wrapper&quot; ref=&quot;cdWrapper&quot;&gt;\n              &lt;div class=&quot;cd&quot; :class=&quot;cdCls&quot;&gt;\n                &lt;img class=&quot;image&quot; :src=&quot;currentSong.image&quot;&gt;\n              &lt;/div&gt;\n            &lt;/div&gt;\n            &lt;div class=&quot;playing-lyric-wrapper&quot;&gt;\n              &lt;div class=&quot;playing-lyric&quot;&gt;{{playingLyric}}&lt;/div&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n          &lt;scroll class=&quot;middle-r&quot; ref=&quot;lyricList&quot; :data=&quot;currentLyric &amp;&amp; currentLyric.lines&quot;&gt;\n            &lt;div class=&quot;lyric-wrapper&quot;&gt;\n              &lt;div v-if=&quot;currentLyric&quot;&gt;\n                &lt;p ref=&quot;lyricLine&quot;\n                   class=&quot;text&quot;\n                   :class=&quot;{&apos;current&apos;: currentLineNum ===index}&quot;\n                   v-for=&quot;(line,index) in currentLyric.lines&quot;&gt;{{line.txt}}&lt;/p&gt;\n              &lt;/div&gt;\n            &lt;/div&gt;\n          &lt;/scroll&gt;\n        &lt;/div&gt;\n        &lt;div class=&quot;bottom&quot;&gt;\n          &lt;div class=&quot;dot-wrapper&quot;&gt;\n            &lt;span class=&quot;dot&quot; :class=&quot;{&apos;active&apos;:currentShow===&apos;cd&apos;}&quot;&gt;&lt;/span&gt;\n            &lt;span class=&quot;dot&quot; :class=&quot;{&apos;active&apos;:currentShow===&apos;lyric&apos;}&quot;&gt;&lt;/span&gt;\n          &lt;/div&gt;\n          &lt;div class=&quot;progress-wrapper&quot;&gt;\n            &lt;span class=&quot;time time-l&quot;&gt;{{format(currentTime)}}&lt;/span&gt;\n            &lt;div class=&quot;progress-bar-wrapper&quot;&gt;\n              &lt;progress-bar :percent=&quot;percent&quot; @percentChange=&quot;onProgressBarChange&quot;&gt;&lt;/progress-bar&gt;\n            &lt;/div&gt;\n            &lt;span class=&quot;time time-r&quot;&gt;{{format(currentSong.duration)}}&lt;/span&gt;\n          &lt;/div&gt;\n          &lt;div class=&quot;operators&quot;&gt;\n            &lt;div class=&quot;icon i-left&quot; @click=&quot;changeMode&quot;&gt;\n              &lt;i :class=&quot;iconMode&quot;&gt;&lt;/i&gt;\n            &lt;/div&gt;\n            &lt;div class=&quot;icon i-left&quot; :class=&quot;disableCls&quot;&gt;\n              &lt;i @click=&quot;prev&quot; class=&quot;icon-prev&quot;&gt;&lt;/i&gt;\n            &lt;/div&gt;\n            &lt;div class=&quot;icon i-center&quot; :class=&quot;disableCls&quot;&gt;\n              &lt;i @click=&quot;togglePlaying&quot; :class=&quot;playIcon&quot;&gt;&lt;/i&gt;\n            &lt;/div&gt;\n            &lt;div class=&quot;icon i-right&quot; :class=&quot;disableCls&quot;&gt;\n              &lt;i @click=&quot;next&quot; class=&quot;icon-next&quot;&gt;&lt;/i&gt;\n            &lt;/div&gt;\n            &lt;div class=&quot;icon i-right&quot;&gt;\n              &lt;i @click=&quot;toggleFavorite(currentSong)&quot; class=&quot;icon&quot; :class=&quot;getFavoriteIcon(currentSong)&quot;&gt;&lt;/i&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/transition&gt;\n    &lt;transition name=&quot;mini&quot;&gt;\n      &lt;div class=&quot;mini-player&quot; v-show=&quot;!fullScreen&quot; @click=&quot;open&quot;&gt;\n        &lt;div class=&quot;icon&quot;&gt;\n          &lt;img :class=&quot;cdCls&quot; width=&quot;40&quot; height=&quot;40&quot; :src=&quot;currentSong.image&quot;&gt;\n        &lt;/div&gt;\n        &lt;div class=&quot;text&quot;&gt;\n          &lt;h2 class=&quot;name&quot; v-html=&quot;currentSong.name&quot;&gt;&lt;/h2&gt;\n          &lt;p class=&quot;desc&quot; v-html=&quot;currentSong.singer&quot;&gt;&lt;/p&gt;\n        &lt;/div&gt;\n        &lt;div class=&quot;control&quot;&gt;\n          &lt;progress-circle :radius=&quot;radius&quot; :percent=&quot;percent&quot;&gt;\n            &lt;i @click.stop=&quot;togglePlaying&quot; class=&quot;icon-mini&quot; :class=&quot;miniIcon&quot;&gt;&lt;/i&gt;\n          &lt;/progress-circle&gt;\n        &lt;/div&gt;\n        &lt;div class=&quot;control&quot; @click.stop=&quot;showPlaylist&quot;&gt;\n          &lt;i class=&quot;icon-playlist&quot;&gt;&lt;/i&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/transition&gt;\n    &lt;playlist ref=&quot;playlist&quot;&gt;&lt;/playlist&gt;\n    &lt;audio ref=&quot;audio&quot; :src=&quot;currentSong.url&quot; @play=&quot;ready&quot; @error=&quot;error&quot; @timeupdate=&quot;updateTime&quot;\n           @ended=&quot;end&quot;&gt;&lt;/audio&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script type=&quot;&quot;&gt;\n  import {mapGetters, mapMutations, mapActions} from &apos;vuex&apos;\n  import animations from &apos;create-keyframe-animation&apos;\n  import {prefixStyle} from &apos;common/js/dom&apos;\n  import ProgressBar from &apos;base/progress-bar/progress-bar&apos;\n  import ProgressCircle from &apos;base/progress-circle/progress-circle&apos;\n  import {playMode} from &apos;common/js/config&apos;\n  import Lyric from &apos;lyric-parser&apos;\n  import Scroll from &apos;base/scroll/scroll&apos;\n  import {playerMixin} from &apos;common/js/mixin&apos;\n  import Playlist from &apos;components/playlist/playlist&apos;\n\n  const transform = prefixStyle(&apos;transform&apos;)\n  const transitionDuration = prefixStyle(&apos;transitionDuration&apos;)\n\n  export default {\n    mixins: [playerMixin],\n    data() {\n      return {\n        songReady: false,\n        currentTime: 0,\n        radius: 32,\n        currentLyric: null,\n        currentLineNum: 0,\n        currentShow: &apos;cd&apos;,\n        playingLyric: &apos;&apos;\n      }\n    },\n    computed: {\n      cdCls() {\n        return this.playing ? &apos;play&apos; : &apos;play pause&apos;\n      },\n      playIcon() {\n        return this.playing ? &apos;icon-pause&apos; : &apos;icon-play&apos;\n      },\n      miniIcon() {\n        return this.playing ? &apos;icon-pause-mini&apos; : &apos;icon-play-mini&apos;\n      },\n      disableCls() {\n        return this.songReady ? &apos;&apos; : &apos;disable&apos;\n      },\n      percent() {\n        return this.currentTime / this.currentSong.duration\n      },\n      ...mapGetters([\n        &apos;currentIndex&apos;,\n        &apos;fullScreen&apos;,\n        &apos;playing&apos;\n      ])\n    },\n    created() {\n      this.touch = {}\n    },\n    methods: {\n      back() {\n        this.setFullScreen(false)\n      },\n      open() {\n        this.setFullScreen(true)\n      },\n      enter(el, done) {\n        const {x, y, scale} = this._getPosAndScale()\n\n        let animation = {\n          0: {\n            transform: `translate3d(${x}px,${y}px,0) scale(${scale})`\n          },\n          60: {\n            transform: `translate3d(0,0,0) scale(1.1)`\n          },\n          100: {\n            transform: `translate3d(0,0,0) scale(1)`\n          }\n        }\n\n        animations.registerAnimation({\n          name: &apos;move&apos;,\n          animation,\n          presets: {\n            duration: 400,\n            easing: &apos;linear&apos;\n          }\n        })\n\n        animations.runAnimation(this.$refs.cdWrapper, &apos;move&apos;, done)\n      },\n      afterEnter() {\n        animations.unregisterAnimation(&apos;move&apos;)\n        this.$refs.cdWrapper.style.animation = &apos;&apos;\n      },\n      leave(el, done) {\n        this.$refs.cdWrapper.style.transition = &apos;all 0.4s&apos;\n        const {x, y, scale} = this._getPosAndScale()\n        this.$refs.cdWrapper.style[transform] = `translate3d(${x}px,${y}px,0) scale(${scale})`\n        this.$refs.cdWrapper.addEventListener(&apos;transitionend&apos;, done)\n      },\n      afterLeave() {\n        this.$refs.cdWrapper.style.transition = &apos;&apos;\n        this.$refs.cdWrapper.style[transform] = &apos;&apos;\n      },\n      togglePlaying() {\n        if (!this.songReady) {\n          return\n        }\n        this.setPlayingState(!this.playing)\n        if (this.currentLyric) {\n          this.currentLyric.togglePlay()\n        }\n      },\n      end() {\n        if (this.mode === playMode.loop) {\n          this.loop()\n        } else {\n          this.next()\n        }\n      },\n      loop() {\n        this.$refs.audio.currentTime = 0\n        this.$refs.audio.play()\n        this.setPlayingState(true)\n        if (this.currentLyric) {\n          this.currentLyric.seek(0)\n        }\n      },\n      next() {\n        if (!this.songReady) {\n          return\n        }\n        if (this.playlist.length === 1) {\n          this.loop()\n          return\n        } else {\n          let index = this.currentIndex + 1\n          if (index === this.playlist.length) {\n            index = 0\n          }\n          this.setCurrentIndex(index)\n          if (!this.playing) {\n            this.togglePlaying()\n          }\n        }\n        this.songReady = false\n      },\n      prev() {\n        if (!this.songReady) {\n          return\n        }\n        if (this.playlist.length === 1) {\n          this.loop()\n          return\n        } else {\n          let index = this.currentIndex - 1\n          if (index === -1) {\n            index = this.playlist.length - 1\n          }\n          this.setCurrentIndex(index)\n          if (!this.playing) {\n            this.togglePlaying()\n          }\n        }\n        this.songReady = false\n      },\n      ready() {\n        this.songReady = true\n        this.savePlayHistory(this.currentSong)\n      },\n      error() {\n        this.songReady = true\n      },\n      updateTime(e) {\n        this.currentTime = e.target.currentTime\n      },\n      format(interval) {\n        interval = interval | 0\n        const minute = interval / 60 | 0\n        const second = this._pad(interval % 60)\n        return `${minute}:${second}`\n      },\n      onProgressBarChange(percent) {\n        const currentTime = this.currentSong.duration * percent\n        this.$refs.audio.currentTime = currentTime\n        if (!this.playing) {\n          this.togglePlaying()\n        }\n        if (this.currentLyric) {\n          this.currentLyric.seek(currentTime * 1000)\n        }\n      },\n      getLyric() {\n        this.currentSong.getLyric().then((lyric) =&gt; {\n          if (this.currentSong.lyric !== lyric) {\n            return\n          }\n          this.currentLyric = new Lyric(lyric, this.handleLyric)\n          if (this.playing) {\n            this.currentLyric.play()\n          }\n        }).catch(() =&gt; {\n          this.currentLyric = null\n          this.playingLyric = &apos;&apos;\n          this.currentLineNum = 0\n        })\n      },\n      handleLyric({lineNum, txt}) {\n        this.currentLineNum = lineNum\n        if (lineNum &gt; 5) {\n          let lineEl = this.$refs.lyricLine[lineNum - 5]\n          this.$refs.lyricList.scrollToElement(lineEl, 1000)\n        } else {\n          this.$refs.lyricList.scrollTo(0, 0, 1000)\n        }\n        this.playingLyric = txt\n      },\n      showPlaylist() {\n        this.$refs.playlist.show()\n      },\n      middleTouchStart(e) {\n        this.touch.initiated = true\n        // &#x7528;&#x6765;&#x5224;&#x65AD;&#x662F;&#x5426;&#x662F;&#x4E00;&#x6B21;&#x79FB;&#x52A8;\n        this.touch.moved = false\n        const touch = e.touches[0]\n        this.touch.startX = touch.pageX\n        this.touch.startY = touch.pageY\n      },\n      middleTouchMove(e) {\n        if (!this.touch.initiated) {\n          return\n        }\n        const touch = e.touches[0]\n        const deltaX = touch.pageX - this.touch.startX\n        const deltaY = touch.pageY - this.touch.startY\n        if (Math.abs(deltaY) &gt; Math.abs(deltaX)) {\n          return\n        }\n        if (!this.touch.moved) {\n          this.touch.moved = true\n        }\n        const left = this.currentShow === &apos;cd&apos; ? 0 : -window.innerWidth\n        const offsetWidth = Math.min(0, Math.max(-window.innerWidth, left + deltaX))\n        this.touch.percent = Math.abs(offsetWidth / window.innerWidth)\n        this.$refs.lyricList.$el.style[transform] = `translate3d(${offsetWidth}px,0,0)`\n        this.$refs.lyricList.$el.style[transitionDuration] = 0\n        this.$refs.middleL.style.opacity = 1 - this.touch.percent\n        this.$refs.middleL.style[transitionDuration] = 0\n      },\n      middleTouchEnd() {\n        if (!this.touch.moved) {\n          return\n        }\n        let offsetWidth\n        let opacity\n        if (this.currentShow === &apos;cd&apos;) {\n          if (this.touch.percent &gt; 0.1) {\n            offsetWidth = -window.innerWidth\n            opacity = 0\n            this.currentShow = &apos;lyric&apos;\n          } else {\n            offsetWidth = 0\n            opacity = 1\n          }\n        } else {\n          if (this.touch.percent &lt; 0.9) {\n            offsetWidth = 0\n            this.currentShow = &apos;cd&apos;\n            opacity = 1\n          } else {\n            offsetWidth = -window.innerWidth\n            opacity = 0\n          }\n        }\n        const time = 300\n        this.$refs.lyricList.$el.style[transform] = `translate3d(${offsetWidth}px,0,0)`\n        this.$refs.lyricList.$el.style[transitionDuration] = `${time}ms`\n        this.$refs.middleL.style.opacity = opacity\n        this.$refs.middleL.style[transitionDuration] = `${time}ms`\n        this.touch.initiated = false\n      },\n      _pad(num, n = 2) {\n        let len = num.toString().length\n        while (len &lt; n) {\n          num = &apos;0&apos; + num\n          len++\n        }\n        return num\n      },\n      _getPosAndScale() {\n        const targetWidth = 40\n        const paddingLeft = 40\n        const paddingBottom = 30\n        const paddingTop = 80\n        const width = window.innerWidth * 0.8\n        const scale = targetWidth / width\n        const x = -(window.innerWidth / 2 - paddingLeft)\n        const y = window.innerHeight - paddingTop - width / 2 - paddingBottom\n        return {\n          x,\n          y,\n          scale\n        }\n      },\n      ...mapMutations({\n        setFullScreen: &apos;SET_FULL_SCREEN&apos;\n      }),\n      ...mapActions([\n        &apos;savePlayHistory&apos;\n      ])\n    },\n    watch: {\n      currentSong(newSong, oldSong) {\n        if (!newSong.id) {\n          return\n        }\n        if (newSong.id === oldSong.id) {\n          return\n        }\n        if (this.currentLyric) {\n          this.currentLyric.stop()\n          this.currentTime = 0\n          this.playingLyric = &apos;&apos;\n          this.currentLineNum = 0\n        }\n        clearTimeout(this.timer)\n        this.timer = setTimeout(() =&gt; {\n          this.$refs.audio.play()\n          this.getLyric()\n        }, 1000)\n      },\n      playing(newPlaying) {\n        const audio = this.$refs.audio\n        this.$nextTick(() =&gt; {\n          newPlaying ? audio.play() : audio.pause()\n        })\n      },\n      fullScreen(newVal) {\n        if (newVal) {\n          setTimeout(() =&gt; {\n            this.$refs.lyricList.refresh()\n          }, 20)\n        }\n      }\n    },\n    components: {\n      ProgressBar,\n      ProgressCircle,\n      Scroll,\n      Playlist\n    }\n  }\n&lt;/script&gt;\n\n&lt;style scoped lang=&quot;stylus&quot; rel=&quot;stylesheet/stylus&quot;&gt;\n  @import &quot;~common/stylus/variable&quot;\n  @import &quot;~common/stylus/mixin&quot;\n\n  .player\n    .normal-player\n      position: fixed\n      left: 0\n      right: 0\n      top: 0\n      bottom: 0\n      z-index: 150\n      background: $color-background\n      .background\n        position: absolute\n        left: 0\n        top: 0\n        width: 100%\n        height: 100%\n        z-index: -1\n        opacity: 0.6\n        filter: blur(20px)\n      .top\n        position: relative\n        margin-bottom: 25px\n        .back\n          position absolute\n          top: 0\n          left: 6px\n          z-index: 50\n          .icon-back\n            display: block\n            padding: 9px\n            font-size: $font-size-large-x\n            color: $color-theme\n            transform: rotate(-90deg)\n        .title\n          width: 70%\n          margin: 0 auto\n          line-height: 40px\n          text-align: center\n          no-wrap()\n          font-size: $font-size-large\n          color: $color-text\n        .subtitle\n          line-height: 20px\n          text-align: center\n          font-size: $font-size-medium\n          color: $color-text\n      .middle\n        position: fixed\n        width: 100%\n        top: 80px\n        bottom: 170px\n        white-space: nowrap\n        font-size: 0\n        .middle-l\n          display: inline-block\n          vertical-align: top\n          position: relative\n          width: 100%\n          height: 0\n          padding-top: 80%\n          .cd-wrapper\n            position: absolute\n            left: 10%\n            top: 0\n            width: 80%\n            height: 100%\n            .cd\n              width: 100%\n              height: 100%\n              box-sizing: border-box\n              border: 10px solid rgba(255, 255, 255, 0.1)\n              border-radius: 50%\n              &amp;.play\n                animation: rotate 20s linear infinite\n              &amp;.pause\n                animation-play-state: paused\n              .image\n                position: absolute\n                left: 0\n                top: 0\n                width: 100%\n                height: 100%\n                border-radius: 50%\n\n          .playing-lyric-wrapper\n            width: 80%\n            margin: 30px auto 0 auto\n            overflow: hidden\n            text-align: center\n            .playing-lyric\n              height: 20px\n              line-height: 20px\n              font-size: $font-size-medium\n              color: $color-text-l\n        .middle-r\n          display: inline-block\n          vertical-align: top\n          width: 100%\n          height: 100%\n          overflow: hidden\n          .lyric-wrapper\n            width: 80%\n            margin: 0 auto\n            overflow: hidden\n            text-align: center\n            .text\n              line-height: 32px\n              color: $color-text-l\n              font-size: $font-size-medium\n              &amp;.current\n                color: $color-text\n      .bottom\n        position: absolute\n        bottom: 50px\n        width: 100%\n        .dot-wrapper\n          text-align: center\n          font-size: 0\n          .dot\n            display: inline-block\n            vertical-align: middle\n            margin: 0 4px\n            width: 8px\n            height: 8px\n            border-radius: 50%\n            background: $color-text-l\n            &amp;.active\n              width: 20px\n              border-radius: 5px\n              background: $color-text-ll\n        .progress-wrapper\n          display: flex\n          align-items: center\n          width: 80%\n          margin: 0px auto\n          padding: 10px 0\n          .time\n            color: $color-text\n            font-size: $font-size-small\n            flex: 0 0 30px\n            line-height: 30px\n            width: 30px\n            &amp;.time-l\n              text-align: left\n            &amp;.time-r\n              text-align: right\n          .progress-bar-wrapper\n            flex: 1\n        .operators\n          display: flex\n          align-items: center\n          .icon\n            flex: 1\n            color: $color-theme\n            &amp;.disable\n              color: $color-theme-d\n            i\n              font-size: 30px\n          .i-left\n            text-align: right\n          .i-center\n            padding: 0 20px\n            text-align: center\n            i\n              font-size: 40px\n          .i-right\n            text-align: left\n          .icon-favorite\n            color: $color-sub-theme\n      &amp;.normal-enter-active, &amp;.normal-leave-active\n        transition: all 0.4s\n        .top, .bottom\n          transition: all 0.4s cubic-bezier(0.86, 0.18, 0.82, 1.32)\n      &amp;.normal-enter, &amp;.normal-leave-to\n        opacity: 0\n        .top\n          transform: translate3d(0, -100px, 0)\n        .bottom\n          transform: translate3d(0, 100px, 0)\n    .mini-player\n      display: flex\n      align-items: center\n      position: fixed\n      left: 0\n      bottom: 0\n      z-index: 180\n      width: 100%\n      height: 60px\n      background: $color-highlight-background\n      &amp;.mini-enter-active, &amp;.mini-leave-active\n        transition: all 0.4s\n      &amp;.mini-enter, &amp;.mini-leave-to\n        opacity: 0\n      .icon\n        flex: 0 0 40px\n        width: 40px\n        padding: 0 10px 0 20px\n        img\n          border-radius: 50%\n          &amp;.play\n            animation: rotate 10s linear infinite\n          &amp;.pause\n            animation-play-state: paused\n      .text\n        display: flex\n        flex-direction: column\n        justify-content: center\n        flex: 1\n        line-height: 20px\n        overflow: hidden\n        .name\n          margin-bottom: 2px\n          no-wrap()\n          font-size: $font-size-medium\n          color: $color-text\n        .desc\n          no-wrap()\n          font-size: $font-size-small\n          color: $color-text-d\n      .control\n        flex: 0 0 30px\n        width: 30px\n        padding: 0 10px\n        .icon-play-mini, .icon-pause-mini, .icon-playlist\n          font-size: 30px\n          color: $color-theme-d\n        .icon-mini\n          font-size: 32px\n          position: absolute\n          left: 0\n          top: 0\n\n  @keyframes rotate\n    0%\n      transform: rotate(0)\n    100%\n      transform: rotate(360deg)\n&lt;/style&gt;</code></pre>\n';t=(t=(t=(t=t.replace(/"{/g,"{")).replace(/{"/g,"{")).replace(/"}/g,"}")).replace(/}"/g,"}"),$("#row").html(t)})</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>vuejs2.0 高级实战 全网稀缺 独立开发专属音乐WebAPP 更新中。。。</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000016137164">https://segmentfault.com/a/1190000016137164</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/b588ec07/" target="_blank">https://alili.tech/archive/b588ec07/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({el:".blog-post-comments",app_id:"ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz",app_key:"hLhtmd4tT0qJbyO2SgQ8odya",placeholder:"说点什么?",avatar:"retro",notify:!0,verify:!0})</script><ul id="more-post-list" class="archive readmore"><h3>推荐阅读</h3><li><a href="/archive/vi32h2qgdt/">JavaScript点击事件——美女合集<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/h1hfkoy4as/">Web UI 自动化测试技术选型<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/2ehenm5fx2r/">【基础】固定列宽的表格及示例演示<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/bp751dpaao6/">移动端开发单位——rem，动态使用<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/w0ea6x92n7j/">预告：Javascript全栈开发的系列文章<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/nh5d5ddjtjs/">CORS 跨域携带 Cookie 发送请求<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/32ufjbf3p3i/">ES6深入浅出 Generator<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/tgareq08se/">H5移动端开发<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/kuarhdceuz/">JS面试理论题<aside class="dates">2018-11-16</aside></a></li><li><a href="/archive/82gahy2bcol/">JavaScript ES6功能概述（ECMAScript 6和ES2015 &#43;）<aside class="dates">2018-11-16</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2018 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/js/main.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script>!function(){var d="http:"==document.location.protocol?"http://js.passport.qihucdn.com/11.0.1.js?05520debdbedd780ba345d83b7d5e6f4":"https://jspassport.ssl.qhimg.com/11.0.1.js?05520debdbedd780ba345d83b7d5e6f4";document.write('<script src="'+d+'" id="sozz"><\/script>')}()</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>