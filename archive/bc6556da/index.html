<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="$(function(){ var html = &#34;\n\x3ch1 id=\x22articleHeader0\x22\x3e1\x26#x3001;\x26#x51C6;\x26#x5907;\x26#x5DE5;\x26#x4F5C;\x3c\/h1\x3e\x3cp\x3e\x26#x7533;\x26#x8BF7;QQ\x26#x3001;\x26#x5FAE;\x26#x4FE1;\x"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="前后端分离项目 — SpringSocial 绑定与解绑社交账号如微信、QQ"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="$(function(){ var html = &#34;\n\x3ch1 id=\x22articleHeader0\x22\x3e1\x26#x3001;\x26#x51C6;\x26#x5907;\x26#x5DE5;\x26#x4F5C;\x3c\/h1\x3e\x3cp\x3e\x26#x7533;\x26#x8BF7;QQ\x26#x3001;\x26#x5FAE;\x26#x4FE1;\x"><meta property="og:site_name" content="Alili"><title>前后端分离项目 — SpringSocial 绑定与解绑社交账号如微信、QQ | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad()</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error",function(e){var t=e.target;"img"==t.tagName.toLowerCase()&&(t.style.display="none")},!0)</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/bc6556da/",
				"appid": "1613049289050283", 
				"title": "前后端分离项目 — SpringSocial 绑定与解绑社交账号如微信、QQ | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2018-11-06T15:28:31"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")' style="display:none"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/470c27fa/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class="icon" href="https://alili.tech/archive/3c0e25ac/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id="i-prev" class="info" style="display:none">Previous post</span> <span id="i-next" class="info" style="display:none">Next post</span> <span id="i-top" class="info" style="display:none">Back to top</span> <span id="i-share" class="info" style="display:none">Share post</span></span><br><div id="share" style="display:none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fbc6556da%2f&text=%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e9%a1%b9%e7%9b%ae%20%e2%80%94%20SpringSocial%20%e7%bb%91%e5%ae%9a%e4%b8%8e%e8%a7%a3%e7%bb%91%e7%a4%be%e4%ba%a4%e8%b4%a6%e5%8f%b7%e5%a6%82%e5%be%ae%e4%bf%a1%e3%80%81QQ"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fbc6556da%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fbc6556da%2f&text=%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e9%a1%b9%e7%9b%ae%20%e2%80%94%20SpringSocial%20%e7%bb%91%e5%ae%9a%e4%b8%8e%e8%a7%a3%e7%bb%91%e7%a4%be%e4%ba%a4%e8%b4%a6%e5%8f%b7%e5%a6%82%e5%be%ae%e4%bf%a1%e3%80%81QQ"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fbc6556da%2f&title=%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e9%a1%b9%e7%9b%ae%20%e2%80%94%20SpringSocial%20%e7%bb%91%e5%ae%9a%e4%b8%8e%e8%a7%a3%e7%bb%91%e7%a4%be%e4%ba%a4%e8%b4%a6%e5%8f%b7%e5%a6%82%e5%be%ae%e4%bf%a1%e3%80%81QQ"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fbc6556da%2f&is_video=false&description=%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e9%a1%b9%e7%9b%ae%20%e2%80%94%20SpringSocial%20%e7%bb%91%e5%ae%9a%e4%b8%8e%e8%a7%a3%e7%bb%91%e7%a4%be%e4%ba%a4%e8%b4%a6%e5%8f%b7%e5%a6%82%e5%be%ae%e4%bf%a1%e3%80%81QQ"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e9%a1%b9%e7%9b%ae%20%e2%80%94%20SpringSocial%20%e7%bb%91%e5%ae%9a%e4%b8%8e%e8%a7%a3%e7%bb%91%e7%a4%be%e4%ba%a4%e8%b4%a6%e5%8f%b7%e5%a6%82%e5%be%ae%e4%bf%a1%e3%80%81QQ&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fbc6556da%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fbc6556da%2f&title=%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e9%a1%b9%e7%9b%ae%20%e2%80%94%20SpringSocial%20%e7%bb%91%e5%ae%9a%e4%b8%8e%e8%a7%a3%e7%bb%91%e7%a4%be%e4%ba%a4%e8%b4%a6%e5%8f%b7%e5%a6%82%e5%be%ae%e4%bf%a1%e3%80%81QQ"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbc6556da%2f&title=%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e9%a1%b9%e7%9b%ae%20%e2%80%94%20SpringSocial%20%e7%bb%91%e5%ae%9a%e4%b8%8e%e8%a7%a3%e7%bb%91%e7%a4%be%e4%ba%a4%e8%b4%a6%e5%8f%b7%e5%a6%82%e5%be%ae%e4%bf%a1%e3%80%81QQ"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbc6556da%2f&title=%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e9%a1%b9%e7%9b%ae%20%e2%80%94%20SpringSocial%20%e7%bb%91%e5%ae%9a%e4%b8%8e%e8%a7%a3%e7%bb%91%e7%a4%be%e4%ba%a4%e8%b4%a6%e5%8f%b7%e5%a6%82%e5%be%ae%e4%bf%a1%e3%80%81QQ"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fbc6556da%2f&title=%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e9%a1%b9%e7%9b%ae%20%e2%80%94%20SpringSocial%20%e7%bb%91%e5%ae%9a%e4%b8%8e%e8%a7%a3%e7%bb%91%e7%a4%be%e4%ba%a4%e8%b4%a6%e5%8f%b7%e5%a6%82%e5%be%ae%e4%bf%a1%e3%80%81QQ"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">前后端分离项目 — SpringSocial 绑定与解绑社交账号如微信、QQ</h1><div class="meta"><div class="postdate"><time datetime="2018-11-06" itemprop="datePublished">2018-11-06</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><script>$(function(){var t='\n<h1 id="articleHeader0">1&#x3001;&#x51C6;&#x5907;&#x5DE5;&#x4F5C;</h1><p>&#x7533;&#x8BF7;QQ&#x3001;&#x5FAE;&#x4FE1;&#x76F8;&#x5173;AppId&#x548C;AppSecret&#xFF0C;&#x8FD9;&#x4E9B;&#x5927;&#x5BB6;&#x81EA;&#x5DF1;&#x5230;<a href="https://connect.qq.com/index.html" rel="nofollow noreferrer" target="_blank">QQ&#x4E92;&#x8054;</a>&#x548C;<a href="https://open.weixin.qq.com/cgi-bin/index" rel="nofollow noreferrer" target="_blank">&#x5FAE;&#x4FE1;&#x5F00;&#x53D1;&#x5E73;&#x53F0;</a> &#x53BB;&#x7533;&#x8BF7;&#x5427;<br>&#x8FD8;&#x6709;java&#x540E;&#x53F0;&#x8981;&#x5F15;&#x5165;&#x76F8;&#x5173;&#x7684;jar&#x5305;&#xFF0C;&#x5982;&#x4E0B;&#xFF1A;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text=" &lt;dependencies&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.springframework.security.oauth.boot&lt;/groupId&gt;\n         &lt;artifactId&gt;spring-security-oauth2-autoconfigure&lt;/artifactId&gt;\n     &lt;/dependency&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.springframework.security.oauth&lt;/groupId&gt;\n         &lt;artifactId&gt;spring-security-oauth2&lt;/artifactId&gt;\n         &lt;version&gt;2.3.3.RELEASE&lt;/version&gt;\n     &lt;/dependency&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n         &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n     &lt;/dependency&gt;\n     &lt;!--&lt;dependency&gt;--&gt;\n         &lt;!--&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;--&gt;\n         &lt;!--&lt;artifactId&gt;spring-cloud-starter-security&lt;/artifactId&gt;--&gt;\n     &lt;!--&lt;/dependency&gt;--&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n         &lt;artifactId&gt;spring-cloud-starter-security&lt;/artifactId&gt;\n     &lt;/dependency&gt;\n\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n         &lt;artifactId&gt;spring-cloud-starter-oauth2&lt;/artifactId&gt;\n     &lt;/dependency&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n         &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;\n     &lt;/dependency&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n         &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;\n     &lt;/dependency&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;mysql&lt;/groupId&gt;\n         &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n     &lt;/dependency&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.springframework.social&lt;/groupId&gt;\n         &lt;artifactId&gt;spring-social-config&lt;/artifactId&gt;\n         &lt;version&gt;1.1.6.RELEASE&lt;/version&gt;\n     &lt;/dependency&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.springframework.social&lt;/groupId&gt;\n         &lt;artifactId&gt;spring-social-core&lt;/artifactId&gt;\n         &lt;version&gt;1.1.6.RELEASE&lt;/version&gt;\n     &lt;/dependency&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.springframework.social&lt;/groupId&gt;\n         &lt;artifactId&gt;spring-social-security&lt;/artifactId&gt;\n         &lt;version&gt;1.1.6.RELEASE&lt;/version&gt;\n     &lt;/dependency&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.springframework.social&lt;/groupId&gt;\n         &lt;artifactId&gt;spring-social-web&lt;/artifactId&gt;\n         &lt;version&gt;1.1.6.RELEASE&lt;/version&gt;\n     &lt;/dependency&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;\n         &lt;artifactId&gt;jjwt&lt;/artifactId&gt;\n         &lt;version&gt;0.9.1&lt;/version&gt;\n     &lt;/dependency&gt;\n\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n         &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;\n         &lt;version&gt;3.7&lt;/version&gt;\n     &lt;/dependency&gt;\n\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n         &lt;artifactId&gt;commons-collections4&lt;/artifactId&gt;\n         &lt;version&gt;4.2&lt;/version&gt;\n     &lt;/dependency&gt;\n\n     &lt;dependency&gt;\n         &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;\n         &lt;artifactId&gt;commons-beanutils&lt;/artifactId&gt;\n         &lt;version&gt;1.9.3&lt;/version&gt;\n     &lt;/dependency&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n         &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;\n     &lt;/dependency&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;\n         &lt;artifactId&gt;spring-data-mongodb&lt;/artifactId&gt;\n         &lt;version&gt;2.0.9.RELEASE&lt;/version&gt;\n     &lt;/dependency&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n         &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt;\n         &lt;version&gt;2.0.4.RELEASE&lt;/version&gt;\n     &lt;/dependency&gt;\n     &lt;dependency&gt;\n         &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n         &lt;artifactId&gt;jackson-core&lt;/artifactId&gt;\n         &lt;version&gt;2.9.6&lt;/version&gt;\n     &lt;/dependency&gt;" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="hljs xml"><code> <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.security.oauth.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-security-oauth2-autoconfigure<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.security.oauth<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-security-oauth2<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.3.3.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n     <span class="hljs-comment">&lt;!--&lt;dependency&gt;--&gt;</span>\n         <span class="hljs-comment">&lt;!--&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;--&gt;</span>\n         <span class="hljs-comment">&lt;!--&lt;artifactId&gt;spring-cloud-starter-security&lt;/artifactId&gt;--&gt;</span>\n     <span class="hljs-comment">&lt;!--&lt;/dependency&gt;--&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-security<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-oauth2<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.social<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-social-config<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.6.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.social<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-social-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.6.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.social<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-social-security<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.6.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.social<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-social-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.6.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.jsonwebtoken<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jjwt<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.9.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.commons<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-lang3<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.7<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.commons<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-collections4<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-beanutils<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-beanutils<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.9.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.data<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-data-mongodb<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.9.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-mongodb<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.4.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>\n     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jackson-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>\n         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.9.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>\n     <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre><p>&#x7136;&#x540E;&#x5728;application.properties&#x91CC;&#x9762;&#x8BBE;&#x7F6E;&#x76F8;&#x5173;&#x914D;&#x7F6E;&#xFF0C;&#x5982;redis&#x3001;mysql&#x7B49;&#x8BBE;&#x7F6E;&#xFF0C;&#x5982;&#x4E0B;&#xFF1A;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text=" spring.datasource.url=\n spring.datasource.username=\n spring.datasource.password=\n spring.datasource.driverClassName=com.mysql.jdbc.Driver\n \n spring.redis.host=127.0.0.1\n spring.redis.password=your_pwd\n spring.redis.port=6379\n spring.redis.timeout=30000\n \n ssb.security.social.register-url=/social/signUp\n ssb.security.social.filter-processes-url=/social-login\n ssb.security.social.bind-url=https://website/social-bind/qq\n ssb.security.social.callback-url=https://website/social-login\n ssb.security.social.connect-url=https://website/social-connect\n\n //QQ&#x6388;&#x6743;\n ssb.security.social.qq.app-id=\n ssb.security.social.qq.app-secret=\n ssb.security.social.qq.provider-id=qq\n \n //WeChat&#x6388;&#x6743;\n ssb.security.social.wechat.app-id=\n ssb.security.social.wechat.app-secret=\n ssb.security.social.wechat.provider-id=wechat" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="hljs stylus"><code> spring<span class="hljs-selector-class">.datasource</span><span class="hljs-selector-class">.url</span>=\n spring<span class="hljs-selector-class">.datasource</span><span class="hljs-selector-class">.username</span>=\n spring<span class="hljs-selector-class">.datasource</span><span class="hljs-selector-class">.password</span>=\n spring<span class="hljs-selector-class">.datasource</span><span class="hljs-selector-class">.driverClassName</span>=com<span class="hljs-selector-class">.mysql</span><span class="hljs-selector-class">.jdbc</span><span class="hljs-selector-class">.Driver</span>\n \n spring<span class="hljs-selector-class">.redis</span><span class="hljs-selector-class">.host</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>\n spring<span class="hljs-selector-class">.redis</span><span class="hljs-selector-class">.password</span>=your_pwd\n spring<span class="hljs-selector-class">.redis</span><span class="hljs-selector-class">.port</span>=<span class="hljs-number">6379</span>\n spring<span class="hljs-selector-class">.redis</span><span class="hljs-selector-class">.timeout</span>=<span class="hljs-number">30000</span>\n \n ssb<span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.social</span><span class="hljs-selector-class">.register-url</span>=/social/signUp\n ssb<span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.social</span><span class="hljs-selector-class">.filter-processes-url</span>=/social-login\n ssb<span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.social</span><span class="hljs-selector-class">.bind-url</span>=https:<span class="hljs-comment">//website/social-bind/qq</span>\n ssb<span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.social</span><span class="hljs-selector-class">.callback-url</span>=https:<span class="hljs-comment">//website/social-login</span>\n ssb<span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.social</span><span class="hljs-selector-class">.connect-url</span>=https:<span class="hljs-comment">//website/social-connect</span>\n\n <span class="hljs-comment">//QQ&#x6388;&#x6743;</span>\n ssb<span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.social</span><span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.app-id</span>=\n ssb<span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.social</span><span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.app-secret</span>=\n ssb<span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.social</span><span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.provider-id</span>=qq\n \n <span class="hljs-comment">//WeChat&#x6388;&#x6743;</span>\n ssb<span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.social</span><span class="hljs-selector-class">.wechat</span><span class="hljs-selector-class">.app-id</span>=\n ssb<span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.social</span><span class="hljs-selector-class">.wechat</span><span class="hljs-selector-class">.app-secret</span>=\n ssb<span class="hljs-selector-class">.security</span><span class="hljs-selector-class">.social</span><span class="hljs-selector-class">.wechat</span><span class="hljs-selector-class">.provider-id</span>=wechat</code></pre><h1 id="articleHeader1">2&#x3001;&#x5206;&#x6790;&#x793E;&#x4EA4;&#x7ED1;&#x5B9A;ConnectController&#x7C7B;</h1><p>&#x51C6;&#x5907;&#x5DE5;&#x4F5C;&#x505A;&#x597D;&#x4E4B;&#x540E;&#xFF0C;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5F00;&#x59CB;&#x5206;&#x6790;&#x793E;&#x4EA4;&#x7ED1;&#x5B9A;&#xFF0C;&#x5176;&#x5B9E;spring-social&#x6846;&#x67B6;&#x91CC;&#x5DF2;&#x7ECF;&#x81EA;&#x5E26;&#x4E86;spring-social-web&#xFF0C;&#x8FD9;&#x4E2A;jar&#x5305;&#x91CC;&#x9762;&#x6709;&#x4E2A;ConnectController.java&#x7C7B;&#xFF0C;&#x8FD9;&#x4E2A;&#x7C7B;&#x5DF2;&#x7ECF;&#x5E2E;&#x6211;&#x4EEC;&#x5B9E;&#x73B0;&#x4E86;&#x76F8;&#x5173;&#x7ED1;&#x5B9A;&#x4E0E;&#x89E3;&#x7ED1;&#x5B9E;&#x73B0;&#x65B9;&#x6CD5;&#xFF0C;&#x95EE;&#x9898;&#x5728;&#x4E8E;&#x5B83;&#x662F;&#x57FA;&#x4E8E;Session&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x662F;&#x524D;&#x540E;&#x7AEF;&#x5206;&#x79BB;&#x9879;&#x76EE;&#x4F7F;&#x7528;Session&#x5F53;&#x7136;&#x5E94;&#x6709;&#x95EE;&#x9898;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8981;&#x7ED3;&#x5408;Redis&#x6765;&#x4F7F;&#x7528;&#xFF0C;&#x628A;&#x76F8;&#x5173;&#x53D8;&#x91CF;&#x90FD;&#x5B58;&#x5728;Redis&#x4E2D;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x4E0A;&#x9762;&#x5DF2;&#x7ECF;&#x914D;&#x7F6E;&#x597D;&#x4E86;Redis&#xFF0C;&#x6211;&#x4EEC;&#x518D;&#x6765;&#x770B;&#x770B;Redis&#x914D;&#x7F6E;&#x4EE3;&#x7801;&#xFF1A;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="@Configuration\npublic class RestTemplateConfig {\n\n    @Bean\n    public RestTemplate restTemplate(ClientHttpRequestFactory factory){\n        return new RestTemplate(factory);\n    }\n\n    @Bean\n    public ClientHttpRequestFactory simpleClientHttpRequestFactory(){\n        SimpleClientHttpRequestFactory factory = new SimpleClientHttpRequestFactory();\n        factory.setReadTimeout(50000);//&#x5355;&#x4F4D;&#x4E3A;ms\n        factory.setConnectTimeout(50000);//&#x5355;&#x4F4D;&#x4E3A;ms\n        return factory;\n    }\n}\n" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="hljs dart"><code><span class="hljs-meta">@Configuration</span>\npublic <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RestTemplateConfig</span> </span>{\n\n    <span class="hljs-meta">@Bean</span>\n    public RestTemplate restTemplate(ClientHttpRequestFactory <span class="hljs-keyword">factory</span>){\n        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> RestTemplate(<span class="hljs-keyword">factory</span>);\n    }\n\n    <span class="hljs-meta">@Bean</span>\n    public ClientHttpRequestFactory simpleClientHttpRequestFactory(){\n        SimpleClientHttpRequestFactory <span class="hljs-keyword">factory</span> = <span class="hljs-keyword">new</span> SimpleClientHttpRequestFactory();\n        <span class="hljs-keyword">factory</span>.setReadTimeout(<span class="hljs-number">50000</span>);<span class="hljs-comment">//&#x5355;&#x4F4D;&#x4E3A;ms</span>\n        <span class="hljs-keyword">factory</span>.setConnectTimeout(<span class="hljs-number">50000</span>);<span class="hljs-comment">//&#x5355;&#x4F4D;&#x4E3A;ms</span>\n        <span class="hljs-keyword">return</span> <span class="hljs-keyword">factory</span>;\n    }\n}\n</code></pre><h1 id="articleHeader2">3&#x3001;&#x83B7;&#x53D6;&#x7CFB;&#x7EDF;&#x5F53;&#x524D;&#x7528;&#x6237;&#x6240;&#x6709;&#x793E;&#x4EA4;&#x8D26;&#x53F7;&#x7ED1;&#x5B9A;&#x60C5;&#x51B5;</h1><p>&#x8BBE;&#x7F6E;&#x597D;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x5206;&#x6790;&#x4E00;&#x4E0B;spring-social-web&#x8FD9;&#x4E2A;jar&#x5305;&#x83B7;&#x53D6;&#x793E;&#x4EA4;&#x8D26;&#x53F7;&#x7ED1;&#x5B9A;&#x60C5;&#x51B5;&#xFF0C;&#x5B83;&#x7684;&#x8BF7;&#x6C42;&#x5730;&#x5740;&#x662F;/connect&#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="@Controller\n@RequestMapping({&quot;/connect&quot;})\npublic class ConnectController implements InitializingBean {\n    private static final Log logger = LogFactory.getLog(ConnectController.class);\n    private final ConnectionFactoryLocator connectionFactoryLocator;\n    private final ConnectionRepository connectionRepository;\n    private final MultiValueMap&lt;Class&lt;?&gt;, ConnectInterceptor&lt;?&gt;&gt; connectInterceptors = new LinkedMultiValueMap();\n    private final MultiValueMap&lt;Class&lt;?&gt;, DisconnectInterceptor&lt;?&gt;&gt; disconnectInterceptors = new LinkedMultiValueMap();\n    private ConnectSupport connectSupport;\n    private final UrlPathHelper urlPathHelper = new UrlPathHelper();\n    private String viewPath = &quot;connect/&quot;;\n    private SessionStrategy sessionStrategy = new HttpSessionSessionStrategy();\n    private String applicationUrl = null;\n    protected static final String DUPLICATE_CONNECTION_ATTRIBUTE = &quot;social_addConnection_duplicate&quot;;\n    protected static final String PROVIDER_ERROR_ATTRIBUTE = &quot;social_provider_error&quot;;\n    protected static final String AUTHORIZATION_ERROR_ATTRIBUTE = &quot;social_authorization_error&quot;;\n\n    @Inject\n    public ConnectController(ConnectionFactoryLocator connectionFactoryLocator, ConnectionRepository connectionRepository) {\n        this.connectionFactoryLocator = connectionFactoryLocator;\n        this.connectionRepository = connectionRepository;\n    }\n\n    /** @deprecated */\n    @Deprecated\n    public void setInterceptors(List&lt;ConnectInterceptor&lt;?&gt;&gt; interceptors) {\n        this.setConnectInterceptors(interceptors);\n    }\n\n    public void setConnectInterceptors(List&lt;ConnectInterceptor&lt;?&gt;&gt; interceptors) {\n        Iterator var2 = interceptors.iterator();\n\n        while(var2.hasNext()) {\n            ConnectInterceptor&lt;?&gt; interceptor = (ConnectInterceptor)var2.next();\n            this.addInterceptor(interceptor);\n        }\n\n    }\n\n    public void setDisconnectInterceptors(List&lt;DisconnectInterceptor&lt;?&gt;&gt; interceptors) {\n        Iterator var2 = interceptors.iterator();\n\n        while(var2.hasNext()) {\n            DisconnectInterceptor&lt;?&gt; interceptor = (DisconnectInterceptor)var2.next();\n            this.addDisconnectInterceptor(interceptor);\n        }\n\n    }\n\n    public void setApplicationUrl(String applicationUrl) {\n        this.applicationUrl = applicationUrl;\n    }\n\n    public void setViewPath(String viewPath) {\n        this.viewPath = viewPath;\n    }\n\n    public void setSessionStrategy(SessionStrategy sessionStrategy) {\n        this.sessionStrategy = sessionStrategy;\n    }\n\n    public void addInterceptor(ConnectInterceptor&lt;?&gt; interceptor) {\n        Class&lt;?&gt; serviceApiType = GenericTypeResolver.resolveTypeArgument(interceptor.getClass(), ConnectInterceptor.class);\n        this.connectInterceptors.add(serviceApiType, interceptor);\n    }\n\n    public void addDisconnectInterceptor(DisconnectInterceptor&lt;?&gt; interceptor) {\n        Class&lt;?&gt; serviceApiType = GenericTypeResolver.resolveTypeArgument(interceptor.getClass(), DisconnectInterceptor.class);\n        this.disconnectInterceptors.add(serviceApiType, interceptor);\n    }\n\n    @RequestMapping(\n        method = {RequestMethod.GET}\n    )\n    public String connectionStatus(NativeWebRequest request, Model model) {\n        this.setNoCache(request);\n        this.processFlash(request, model);\n        Map&lt;String, List&lt;Connection&lt;?&gt;&gt;&gt; connections = this.connectionRepository.findAllConnections();\n        model.addAttribute(&quot;providerIds&quot;, this.connectionFactoryLocator.registeredProviderIds());\n        model.addAttribute(&quot;connectionMap&quot;, connections);\n        return this.connectView();\n    }\n\n    @RequestMapping(\n        value = {&quot;/{providerId}&quot;},\n        method = {RequestMethod.GET}\n    )\n    public String connectionStatus(@PathVariable String providerId, NativeWebRequest request, Model model) {\n        this.setNoCache(request);\n        this.processFlash(request, model);\n        List&lt;Connection&lt;?&gt;&gt; connections = this.connectionRepository.findConnections(providerId);\n        this.setNoCache(request);\n        if(connections.isEmpty()) {\n            return this.connectView(providerId);\n        } else {\n            model.addAttribute(&quot;connections&quot;, connections);\n            return this.connectedView(providerId);\n        }\n    }\n\n    @RequestMapping(\n        value = {&quot;/{providerId}&quot;},\n        method = {RequestMethod.POST}\n    )\n    public RedirectView connect(@PathVariable String providerId, NativeWebRequest request) {\n        ConnectionFactory&lt;?&gt; connectionFactory = this.connectionFactoryLocator.getConnectionFactory(providerId);\n        MultiValueMap&lt;String, String&gt; parameters = new LinkedMultiValueMap();\n        this.preConnect(connectionFactory, parameters, request);\n\n        try {\n            return new RedirectView(this.connectSupport.buildOAuthUrl(connectionFactory, request, parameters));\n        } catch (Exception var6) {\n            this.sessionStrategy.setAttribute(request, &quot;social_provider_error&quot;, var6);\n            return this.connectionStatusRedirect(providerId, request);\n        }\n    }\n\n    @RequestMapping(\n        value = {&quot;/{providerId}&quot;},\n        method = {RequestMethod.GET},\n        params = {&quot;oauth_token&quot;}\n    )\n    public RedirectView oauth1Callback(@PathVariable String providerId, NativeWebRequest request) {\n        try {\n            OAuth1ConnectionFactory&lt;?&gt; connectionFactory = (OAuth1ConnectionFactory)this.connectionFactoryLocator.getConnectionFactory(providerId);\n            Connection&lt;?&gt; connection = this.connectSupport.completeConnection(connectionFactory, request);\n            this.addConnection(connection, connectionFactory, request);\n        } catch (Exception var5) {\n            this.sessionStrategy.setAttribute(request, &quot;social_provider_error&quot;, var5);\n            logger.warn(&quot;Exception while handling OAuth1 callback (&quot; + var5.getMessage() + &quot;). Redirecting to &quot; + providerId + &quot; connection status page.&quot;);\n        }\n\n        return this.connectionStatusRedirect(providerId, request);\n    }\n\n    @RequestMapping(\n        value = {&quot;/{providerId}&quot;},\n        method = {RequestMethod.GET},\n        params = {&quot;code&quot;}\n    )\n    public RedirectView oauth2Callback(@PathVariable String providerId, NativeWebRequest request) {\n        try {\n            OAuth2ConnectionFactory&lt;?&gt; connectionFactory = (OAuth2ConnectionFactory)this.connectionFactoryLocator.getConnectionFactory(providerId);\n            Connection&lt;?&gt; connection = this.connectSupport.completeConnection(connectionFactory, request);\n            this.addConnection(connection, connectionFactory, request);\n        } catch (Exception var5) {\n            this.sessionStrategy.setAttribute(request, &quot;social_provider_error&quot;, var5);\n            logger.warn(&quot;Exception while handling OAuth2 callback (&quot; + var5.getMessage() + &quot;). Redirecting to &quot; + providerId + &quot; connection status page.&quot;);\n        }\n\n        return this.connectionStatusRedirect(providerId, request);\n    }\n\n    @RequestMapping(\n        value = {&quot;/{providerId}&quot;},\n        method = {RequestMethod.GET},\n        params = {&quot;error&quot;}\n    )\n    public RedirectView oauth2ErrorCallback(@PathVariable String providerId, @RequestParam(&quot;error&quot;) String error, @RequestParam(value = &quot;error_description&quot;,required = false) String errorDescription, @RequestParam(value = &quot;error_uri&quot;,required = false) String errorUri, NativeWebRequest request) {\n        Map&lt;String, String&gt; errorMap = new HashMap();\n        errorMap.put(&quot;error&quot;, error);\n        if(errorDescription != null) {\n            errorMap.put(&quot;errorDescription&quot;, errorDescription);\n        }\n\n        if(errorUri != null) {\n            errorMap.put(&quot;errorUri&quot;, errorUri);\n        }\n\n        this.sessionStrategy.setAttribute(request, &quot;social_authorization_error&quot;, errorMap);\n        return this.connectionStatusRedirect(providerId, request);\n    }\n\n    @RequestMapping(\n        value = {&quot;/{providerId}&quot;},\n        method = {RequestMethod.DELETE}\n    )\n    public RedirectView removeConnections(@PathVariable String providerId, NativeWebRequest request) {\n        ConnectionFactory&lt;?&gt; connectionFactory = this.connectionFactoryLocator.getConnectionFactory(providerId);\n        this.preDisconnect(connectionFactory, request);\n        this.connectionRepository.removeConnections(providerId);\n        this.postDisconnect(connectionFactory, request);\n        return this.connectionStatusRedirect(providerId, request);\n    }\n\n    @RequestMapping(\n        value = {&quot;/{providerId}/{providerUserId}&quot;},\n        method = {RequestMethod.DELETE}\n    )\n    public RedirectView removeConnection(@PathVariable String providerId, @PathVariable String providerUserId, NativeWebRequest request) {\n        ConnectionFactory&lt;?&gt; connectionFactory = this.connectionFactoryLocator.getConnectionFactory(providerId);\n        this.preDisconnect(connectionFactory, request);\n        this.connectionRepository.removeConnection(new ConnectionKey(providerId, providerUserId));\n        this.postDisconnect(connectionFactory, request);\n        return this.connectionStatusRedirect(providerId, request);\n    }\n\n    protected String connectView() {\n        return this.getViewPath() + &quot;status&quot;;\n    }\n\n    protected String connectView(String providerId) {\n        return this.getViewPath() + providerId + &quot;Connect&quot;;\n    }\n\n    protected String connectedView(String providerId) {\n        return this.getViewPath() + providerId + &quot;Connected&quot;;\n    }\n\n    protected RedirectView connectionStatusRedirect(String providerId, NativeWebRequest request) {\n        HttpServletRequest servletRequest = (HttpServletRequest)request.getNativeRequest(HttpServletRequest.class);\n        String path = &quot;/connect/&quot; + providerId + this.getPathExtension(servletRequest);\n        if(this.prependServletPath(servletRequest)) {\n            path = servletRequest.getServletPath() + path;\n        }\n\n        return new RedirectView(path, true);\n    }\n\n    public void afterPropertiesSet() throws Exception {\n        this.connectSupport = new ConnectSupport(this.sessionStrategy);\n        if(this.applicationUrl != null) {\n            this.connectSupport.setApplicationUrl(this.applicationUrl);\n        }\n\n    }\n\n    private boolean prependServletPath(HttpServletRequest request) {\n        return !this.urlPathHelper.getPathWithinServletMapping(request).equals(&quot;&quot;);\n    }\n\n    private String getPathExtension(HttpServletRequest request) {\n        String fileName = this.extractFullFilenameFromUrlPath(request.getRequestURI());\n        String extension = StringUtils.getFilenameExtension(fileName);\n        return extension != null?&quot;.&quot; + extension:&quot;&quot;;\n    }\n\n    private String extractFullFilenameFromUrlPath(String urlPath) {\n        int end = urlPath.indexOf(63);\n        if(end == -1) {\n            end = urlPath.indexOf(35);\n            if(end == -1) {\n                end = urlPath.length();\n            }\n        }\n\n        int begin = urlPath.lastIndexOf(47, end) + 1;\n        int paramIndex = urlPath.indexOf(59, begin);\n        end = paramIndex != -1 &amp;&amp; paramIndex &lt; end?paramIndex:end;\n        return urlPath.substring(begin, end);\n    }\n\n    private String getViewPath() {\n        return this.viewPath;\n    }\n\n    private void addConnection(Connection&lt;?&gt; connection, ConnectionFactory&lt;?&gt; connectionFactory, WebRequest request) {\n        try {\n            this.connectionRepository.addConnection(connection);\n            this.postConnect(connectionFactory, connection, request);\n        } catch (DuplicateConnectionException var5) {\n            this.sessionStrategy.setAttribute(request, &quot;social_addConnection_duplicate&quot;, var5);\n        }\n\n    }\n\n    private void preConnect(ConnectionFactory&lt;?&gt; connectionFactory, MultiValueMap&lt;String, String&gt; parameters, WebRequest request) {\n        Iterator var4 = this.interceptingConnectionsTo(connectionFactory).iterator();\n\n        while(var4.hasNext()) {\n            ConnectInterceptor interceptor = (ConnectInterceptor)var4.next();\n            interceptor.preConnect(connectionFactory, parameters, request);\n        }\n\n    }\n\n    private void postConnect(ConnectionFactory&lt;?&gt; connectionFactory, Connection&lt;?&gt; connection, WebRequest request) {\n        Iterator var4 = this.interceptingConnectionsTo(connectionFactory).iterator();\n\n        while(var4.hasNext()) {\n            ConnectInterceptor interceptor = (ConnectInterceptor)var4.next();\n            interceptor.postConnect(connection, request);\n        }\n\n    }\n\n    private void preDisconnect(ConnectionFactory&lt;?&gt; connectionFactory, WebRequest request) {\n        Iterator var3 = this.interceptingDisconnectionsTo(connectionFactory).iterator();\n\n        while(var3.hasNext()) {\n            DisconnectInterceptor interceptor = (DisconnectInterceptor)var3.next();\n            interceptor.preDisconnect(connectionFactory, request);\n        }\n\n    }\n\n    private void postDisconnect(ConnectionFactory&lt;?&gt; connectionFactory, WebRequest request) {\n        Iterator var3 = this.interceptingDisconnectionsTo(connectionFactory).iterator();\n\n        while(var3.hasNext()) {\n            DisconnectInterceptor interceptor = (DisconnectInterceptor)var3.next();\n            interceptor.postDisconnect(connectionFactory, request);\n        }\n\n    }\n\n    private List&lt;ConnectInterceptor&lt;?&gt;&gt; interceptingConnectionsTo(ConnectionFactory&lt;?&gt; connectionFactory) {\n        Class&lt;?&gt; serviceType = GenericTypeResolver.resolveTypeArgument(connectionFactory.getClass(), ConnectionFactory.class);\n        List&lt;ConnectInterceptor&lt;?&gt;&gt; typedInterceptors = (List)this.connectInterceptors.get(serviceType);\n        if(typedInterceptors == null) {\n            typedInterceptors = Collections.emptyList();\n        }\n\n        return typedInterceptors;\n    }\n\n    private List&lt;DisconnectInterceptor&lt;?&gt;&gt; interceptingDisconnectionsTo(ConnectionFactory&lt;?&gt; connectionFactory) {\n        Class&lt;?&gt; serviceType = GenericTypeResolver.resolveTypeArgument(connectionFactory.getClass(), ConnectionFactory.class);\n        List&lt;DisconnectInterceptor&lt;?&gt;&gt; typedInterceptors = (List)this.disconnectInterceptors.get(serviceType);\n        if(typedInterceptors == null) {\n            typedInterceptors = Collections.emptyList();\n        }\n\n        return typedInterceptors;\n    }\n\n    private void processFlash(WebRequest request, Model model) {\n        this.convertSessionAttributeToModelAttribute(&quot;social_addConnection_duplicate&quot;, request, model);\n        this.convertSessionAttributeToModelAttribute(&quot;social_provider_error&quot;, request, model);\n        model.addAttribute(&quot;social_authorization_error&quot;, this.sessionStrategy.getAttribute(request, &quot;social_authorization_error&quot;));\n        this.sessionStrategy.removeAttribute(request, &quot;social_authorization_error&quot;);\n    }\n\n    private void convertSessionAttributeToModelAttribute(String attributeName, WebRequest request, Model model) {\n        if(this.sessionStrategy.getAttribute(request, attributeName) != null) {\n            model.addAttribute(attributeName, Boolean.TRUE);\n            this.sessionStrategy.removeAttribute(request, attributeName);\n        }\n\n    }\n\n    private void setNoCache(NativeWebRequest request) {\n        HttpServletResponse response = (HttpServletResponse)request.getNativeResponse(HttpServletResponse.class);\n        if(response != null) {\n            response.setHeader(&quot;Pragma&quot;, &quot;no-cache&quot;);\n            response.setDateHeader(&quot;Expires&quot;, 1L);\n            response.setHeader(&quot;Cache-Control&quot;, &quot;no-cache&quot;);\n            response.addHeader(&quot;Cache-Control&quot;, &quot;no-store&quot;);\n        }\n\n    }\n}" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre><code>@Controller\n@RequestMapping({&quot;/connect&quot;})\npublic class ConnectController implements InitializingBean {\n    private static final Log logger = LogFactory.getLog(ConnectController.class);\n    private final ConnectionFactoryLocator connectionFactoryLocator;\n    private final ConnectionRepository connectionRepository;\n    private final MultiValueMap&lt;Class&lt;?&gt;, ConnectInterceptor&lt;?&gt;&gt; connectInterceptors = new LinkedMultiValueMap();\n    private final MultiValueMap&lt;Class&lt;?&gt;, DisconnectInterceptor&lt;?&gt;&gt; disconnectInterceptors = new LinkedMultiValueMap();\n    private ConnectSupport connectSupport;\n    private final UrlPathHelper urlPathHelper = new UrlPathHelper();\n    private String viewPath = &quot;connect/&quot;;\n    private SessionStrategy sessionStrategy = new HttpSessionSessionStrategy();\n    private String applicationUrl = null;\n    protected static final String DUPLICATE_CONNECTION_ATTRIBUTE = &quot;social_addConnection_duplicate&quot;;\n    protected static final String PROVIDER_ERROR_ATTRIBUTE = &quot;social_provider_error&quot;;\n    protected static final String AUTHORIZATION_ERROR_ATTRIBUTE = &quot;social_authorization_error&quot;;\n\n    @Inject\n    public ConnectController(ConnectionFactoryLocator connectionFactoryLocator, ConnectionRepository connectionRepository) {\n        this.connectionFactoryLocator = connectionFactoryLocator;\n        this.connectionRepository = connectionRepository;\n    }\n\n    /** @deprecated */\n    @Deprecated\n    public void setInterceptors(List&lt;ConnectInterceptor&lt;?&gt;&gt; interceptors) {\n        this.setConnectInterceptors(interceptors);\n    }\n\n    public void setConnectInterceptors(List&lt;ConnectInterceptor&lt;?&gt;&gt; interceptors) {\n        Iterator var2 = interceptors.iterator();\n\n        while(var2.hasNext()) {\n            ConnectInterceptor&lt;?&gt; interceptor = (ConnectInterceptor)var2.next();\n            this.addInterceptor(interceptor);\n        }\n\n    }\n\n    public void setDisconnectInterceptors(List&lt;DisconnectInterceptor&lt;?&gt;&gt; interceptors) {\n        Iterator var2 = interceptors.iterator();\n\n        while(var2.hasNext()) {\n            DisconnectInterceptor&lt;?&gt; interceptor = (DisconnectInterceptor)var2.next();\n            this.addDisconnectInterceptor(interceptor);\n        }\n\n    }\n\n    public void setApplicationUrl(String applicationUrl) {\n        this.applicationUrl = applicationUrl;\n    }\n\n    public void setViewPath(String viewPath) {\n        this.viewPath = viewPath;\n    }\n\n    public void setSessionStrategy(SessionStrategy sessionStrategy) {\n        this.sessionStrategy = sessionStrategy;\n    }\n\n    public void addInterceptor(ConnectInterceptor&lt;?&gt; interceptor) {\n        Class&lt;?&gt; serviceApiType = GenericTypeResolver.resolveTypeArgument(interceptor.getClass(), ConnectInterceptor.class);\n        this.connectInterceptors.add(serviceApiType, interceptor);\n    }\n\n    public void addDisconnectInterceptor(DisconnectInterceptor&lt;?&gt; interceptor) {\n        Class&lt;?&gt; serviceApiType = GenericTypeResolver.resolveTypeArgument(interceptor.getClass(), DisconnectInterceptor.class);\n        this.disconnectInterceptors.add(serviceApiType, interceptor);\n    }\n\n    @RequestMapping(\n        method = {RequestMethod.GET}\n    )\n    public String connectionStatus(NativeWebRequest request, Model model) {\n        this.setNoCache(request);\n        this.processFlash(request, model);\n        Map&lt;String, List&lt;Connection&lt;?&gt;&gt;&gt; connections = this.connectionRepository.findAllConnections();\n        model.addAttribute(&quot;providerIds&quot;, this.connectionFactoryLocator.registeredProviderIds());\n        model.addAttribute(&quot;connectionMap&quot;, connections);\n        return this.connectView();\n    }\n\n    @RequestMapping(\n        value = {&quot;/{providerId}&quot;},\n        method = {RequestMethod.GET}\n    )\n    public String connectionStatus(@PathVariable String providerId, NativeWebRequest request, Model model) {\n        this.setNoCache(request);\n        this.processFlash(request, model);\n        List&lt;Connection&lt;?&gt;&gt; connections = this.connectionRepository.findConnections(providerId);\n        this.setNoCache(request);\n        if(connections.isEmpty()) {\n            return this.connectView(providerId);\n        } else {\n            model.addAttribute(&quot;connections&quot;, connections);\n            return this.connectedView(providerId);\n        }\n    }\n\n    @RequestMapping(\n        value = {&quot;/{providerId}&quot;},\n        method = {RequestMethod.POST}\n    )\n    public RedirectView connect(@PathVariable String providerId, NativeWebRequest request) {\n        ConnectionFactory&lt;?&gt; connectionFactory = this.connectionFactoryLocator.getConnectionFactory(providerId);\n        MultiValueMap&lt;String, String&gt; parameters = new LinkedMultiValueMap();\n        this.preConnect(connectionFactory, parameters, request);\n\n        try {\n            return new RedirectView(this.connectSupport.buildOAuthUrl(connectionFactory, request, parameters));\n        } catch (Exception var6) {\n            this.sessionStrategy.setAttribute(request, &quot;social_provider_error&quot;, var6);\n            return this.connectionStatusRedirect(providerId, request);\n        }\n    }\n\n    @RequestMapping(\n        value = {&quot;/{providerId}&quot;},\n        method = {RequestMethod.GET},\n        params = {&quot;oauth_token&quot;}\n    )\n    public RedirectView oauth1Callback(@PathVariable String providerId, NativeWebRequest request) {\n        try {\n            OAuth1ConnectionFactory&lt;?&gt; connectionFactory = (OAuth1ConnectionFactory)this.connectionFactoryLocator.getConnectionFactory(providerId);\n            Connection&lt;?&gt; connection = this.connectSupport.completeConnection(connectionFactory, request);\n            this.addConnection(connection, connectionFactory, request);\n        } catch (Exception var5) {\n            this.sessionStrategy.setAttribute(request, &quot;social_provider_error&quot;, var5);\n            logger.warn(&quot;Exception while handling OAuth1 callback (&quot; + var5.getMessage() + &quot;). Redirecting to &quot; + providerId + &quot; connection status page.&quot;);\n        }\n\n        return this.connectionStatusRedirect(providerId, request);\n    }\n\n    @RequestMapping(\n        value = {&quot;/{providerId}&quot;},\n        method = {RequestMethod.GET},\n        params = {&quot;code&quot;}\n    )\n    public RedirectView oauth2Callback(@PathVariable String providerId, NativeWebRequest request) {\n        try {\n            OAuth2ConnectionFactory&lt;?&gt; connectionFactory = (OAuth2ConnectionFactory)this.connectionFactoryLocator.getConnectionFactory(providerId);\n            Connection&lt;?&gt; connection = this.connectSupport.completeConnection(connectionFactory, request);\n            this.addConnection(connection, connectionFactory, request);\n        } catch (Exception var5) {\n            this.sessionStrategy.setAttribute(request, &quot;social_provider_error&quot;, var5);\n            logger.warn(&quot;Exception while handling OAuth2 callback (&quot; + var5.getMessage() + &quot;). Redirecting to &quot; + providerId + &quot; connection status page.&quot;);\n        }\n\n        return this.connectionStatusRedirect(providerId, request);\n    }\n\n    @RequestMapping(\n        value = {&quot;/{providerId}&quot;},\n        method = {RequestMethod.GET},\n        params = {&quot;error&quot;}\n    )\n    public RedirectView oauth2ErrorCallback(@PathVariable String providerId, @RequestParam(&quot;error&quot;) String error, @RequestParam(value = &quot;error_description&quot;,required = false) String errorDescription, @RequestParam(value = &quot;error_uri&quot;,required = false) String errorUri, NativeWebRequest request) {\n        Map&lt;String, String&gt; errorMap = new HashMap();\n        errorMap.put(&quot;error&quot;, error);\n        if(errorDescription != null) {\n            errorMap.put(&quot;errorDescription&quot;, errorDescription);\n        }\n\n        if(errorUri != null) {\n            errorMap.put(&quot;errorUri&quot;, errorUri);\n        }\n\n        this.sessionStrategy.setAttribute(request, &quot;social_authorization_error&quot;, errorMap);\n        return this.connectionStatusRedirect(providerId, request);\n    }\n\n    @RequestMapping(\n        value = {&quot;/{providerId}&quot;},\n        method = {RequestMethod.DELETE}\n    )\n    public RedirectView removeConnections(@PathVariable String providerId, NativeWebRequest request) {\n        ConnectionFactory&lt;?&gt; connectionFactory = this.connectionFactoryLocator.getConnectionFactory(providerId);\n        this.preDisconnect(connectionFactory, request);\n        this.connectionRepository.removeConnections(providerId);\n        this.postDisconnect(connectionFactory, request);\n        return this.connectionStatusRedirect(providerId, request);\n    }\n\n    @RequestMapping(\n        value = {&quot;/{providerId}/{providerUserId}&quot;},\n        method = {RequestMethod.DELETE}\n    )\n    public RedirectView removeConnection(@PathVariable String providerId, @PathVariable String providerUserId, NativeWebRequest request) {\n        ConnectionFactory&lt;?&gt; connectionFactory = this.connectionFactoryLocator.getConnectionFactory(providerId);\n        this.preDisconnect(connectionFactory, request);\n        this.connectionRepository.removeConnection(new ConnectionKey(providerId, providerUserId));\n        this.postDisconnect(connectionFactory, request);\n        return this.connectionStatusRedirect(providerId, request);\n    }\n\n    protected String connectView() {\n        return this.getViewPath() + &quot;status&quot;;\n    }\n\n    protected String connectView(String providerId) {\n        return this.getViewPath() + providerId + &quot;Connect&quot;;\n    }\n\n    protected String connectedView(String providerId) {\n        return this.getViewPath() + providerId + &quot;Connected&quot;;\n    }\n\n    protected RedirectView connectionStatusRedirect(String providerId, NativeWebRequest request) {\n        HttpServletRequest servletRequest = (HttpServletRequest)request.getNativeRequest(HttpServletRequest.class);\n        String path = &quot;/connect/&quot; + providerId + this.getPathExtension(servletRequest);\n        if(this.prependServletPath(servletRequest)) {\n            path = servletRequest.getServletPath() + path;\n        }\n\n        return new RedirectView(path, true);\n    }\n\n    public void afterPropertiesSet() throws Exception {\n        this.connectSupport = new ConnectSupport(this.sessionStrategy);\n        if(this.applicationUrl != null) {\n            this.connectSupport.setApplicationUrl(this.applicationUrl);\n        }\n\n    }\n\n    private boolean prependServletPath(HttpServletRequest request) {\n        return !this.urlPathHelper.getPathWithinServletMapping(request).equals(&quot;&quot;);\n    }\n\n    private String getPathExtension(HttpServletRequest request) {\n        String fileName = this.extractFullFilenameFromUrlPath(request.getRequestURI());\n        String extension = StringUtils.getFilenameExtension(fileName);\n        return extension != null?&quot;.&quot; + extension:&quot;&quot;;\n    }\n\n    private String extractFullFilenameFromUrlPath(String urlPath) {\n        int end = urlPath.indexOf(63);\n        if(end == -1) {\n            end = urlPath.indexOf(35);\n            if(end == -1) {\n                end = urlPath.length();\n            }\n        }\n\n        int begin = urlPath.lastIndexOf(47, end) + 1;\n        int paramIndex = urlPath.indexOf(59, begin);\n        end = paramIndex != -1 &amp;&amp; paramIndex &lt; end?paramIndex:end;\n        return urlPath.substring(begin, end);\n    }\n\n    private String getViewPath() {\n        return this.viewPath;\n    }\n\n    private void addConnection(Connection&lt;?&gt; connection, ConnectionFactory&lt;?&gt; connectionFactory, WebRequest request) {\n        try {\n            this.connectionRepository.addConnection(connection);\n            this.postConnect(connectionFactory, connection, request);\n        } catch (DuplicateConnectionException var5) {\n            this.sessionStrategy.setAttribute(request, &quot;social_addConnection_duplicate&quot;, var5);\n        }\n\n    }\n\n    private void preConnect(ConnectionFactory&lt;?&gt; connectionFactory, MultiValueMap&lt;String, String&gt; parameters, WebRequest request) {\n        Iterator var4 = this.interceptingConnectionsTo(connectionFactory).iterator();\n\n        while(var4.hasNext()) {\n            ConnectInterceptor interceptor = (ConnectInterceptor)var4.next();\n            interceptor.preConnect(connectionFactory, parameters, request);\n        }\n\n    }\n\n    private void postConnect(ConnectionFactory&lt;?&gt; connectionFactory, Connection&lt;?&gt; connection, WebRequest request) {\n        Iterator var4 = this.interceptingConnectionsTo(connectionFactory).iterator();\n\n        while(var4.hasNext()) {\n            ConnectInterceptor interceptor = (ConnectInterceptor)var4.next();\n            interceptor.postConnect(connection, request);\n        }\n\n    }\n\n    private void preDisconnect(ConnectionFactory&lt;?&gt; connectionFactory, WebRequest request) {\n        Iterator var3 = this.interceptingDisconnectionsTo(connectionFactory).iterator();\n\n        while(var3.hasNext()) {\n            DisconnectInterceptor interceptor = (DisconnectInterceptor)var3.next();\n            interceptor.preDisconnect(connectionFactory, request);\n        }\n\n    }\n\n    private void postDisconnect(ConnectionFactory&lt;?&gt; connectionFactory, WebRequest request) {\n        Iterator var3 = this.interceptingDisconnectionsTo(connectionFactory).iterator();\n\n        while(var3.hasNext()) {\n            DisconnectInterceptor interceptor = (DisconnectInterceptor)var3.next();\n            interceptor.postDisconnect(connectionFactory, request);\n        }\n\n    }\n\n    private List&lt;ConnectInterceptor&lt;?&gt;&gt; interceptingConnectionsTo(ConnectionFactory&lt;?&gt; connectionFactory) {\n        Class&lt;?&gt; serviceType = GenericTypeResolver.resolveTypeArgument(connectionFactory.getClass(), ConnectionFactory.class);\n        List&lt;ConnectInterceptor&lt;?&gt;&gt; typedInterceptors = (List)this.connectInterceptors.get(serviceType);\n        if(typedInterceptors == null) {\n            typedInterceptors = Collections.emptyList();\n        }\n\n        return typedInterceptors;\n    }\n\n    private List&lt;DisconnectInterceptor&lt;?&gt;&gt; interceptingDisconnectionsTo(ConnectionFactory&lt;?&gt; connectionFactory) {\n        Class&lt;?&gt; serviceType = GenericTypeResolver.resolveTypeArgument(connectionFactory.getClass(), ConnectionFactory.class);\n        List&lt;DisconnectInterceptor&lt;?&gt;&gt; typedInterceptors = (List)this.disconnectInterceptors.get(serviceType);\n        if(typedInterceptors == null) {\n            typedInterceptors = Collections.emptyList();\n        }\n\n        return typedInterceptors;\n    }\n\n    private void processFlash(WebRequest request, Model model) {\n        this.convertSessionAttributeToModelAttribute(&quot;social_addConnection_duplicate&quot;, request, model);\n        this.convertSessionAttributeToModelAttribute(&quot;social_provider_error&quot;, request, model);\n        model.addAttribute(&quot;social_authorization_error&quot;, this.sessionStrategy.getAttribute(request, &quot;social_authorization_error&quot;));\n        this.sessionStrategy.removeAttribute(request, &quot;social_authorization_error&quot;);\n    }\n\n    private void convertSessionAttributeToModelAttribute(String attributeName, WebRequest request, Model model) {\n        if(this.sessionStrategy.getAttribute(request, attributeName) != null) {\n            model.addAttribute(attributeName, Boolean.TRUE);\n            this.sessionStrategy.removeAttribute(request, attributeName);\n        }\n\n    }\n\n    private void setNoCache(NativeWebRequest request) {\n        HttpServletResponse response = (HttpServletResponse)request.getNativeResponse(HttpServletResponse.class);\n        if(response != null) {\n            response.setHeader(&quot;Pragma&quot;, &quot;no-cache&quot;);\n            response.setDateHeader(&quot;Expires&quot;, 1L);\n            response.setHeader(&quot;Cache-Control&quot;, &quot;no-cache&quot;);\n            response.addHeader(&quot;Cache-Control&quot;, &quot;no-store&quot;);\n        }\n\n    }\n}</code></pre><p>&#x4E0A;&#x9762;&#x5C31;&#x662F;ConnectController&#x7684;&#x6E90;&#x7801;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x5206;&#x6790;&#x4E00;&#x4E0B;&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x7528;&#x6237;&#x793E;&#x4EA4;&#x7ED1;&#x5B9A;&#x60C5;&#x51B5;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="      @RequestMapping(\n      method = {RequestMethod.GET}\n  )\n  public String connectionStatus(NativeWebRequest request, Model model) {\n      this.setNoCache(request);\n      this.processFlash(request, model);\n      Map&lt;String, List&lt;Connection&lt;?&gt;&gt;&gt; connections = this.connectionRepository.findAllConnections();\n      model.addAttribute(&quot;providerIds&quot;, this.connectionFactoryLocator.registeredProviderIds());\n      model.addAttribute(&quot;connectionMap&quot;, connections);\n      return this.connectView();\n  }\n\n  @RequestMapping(\n      value = {&quot;/{providerId}&quot;},\n      method = {RequestMethod.GET}\n  )\n  public String connectionStatus(@PathVariable String providerId, NativeWebRequest request, Model model) {\n      this.setNoCache(request);\n      this.processFlash(request, model);\n      List&lt;Connection&lt;?&gt;&gt; connections = this.connectionRepository.findConnections(providerId);\n      this.setNoCache(request);\n      if(connections.isEmpty()) {\n          return this.connectView(providerId);\n      } else {\n          model.addAttribute(&quot;connections&quot;, connections);\n          return this.connectedView(providerId);\n      }\n  }" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="hljs kotlin"><code>      <span class="hljs-meta">@RequestMapping(\n      method = {RequestMethod.GET}\n  )</span>\n  <span class="hljs-keyword">public</span> String connectionStatus(NativeWebRequest request, Model model) {\n      <span class="hljs-keyword">this</span>.setNoCache(request);\n      <span class="hljs-keyword">this</span>.processFlash(request, model);\n      Map&lt;String, List&lt;Connection&lt;?&gt;&gt;&gt; connections = <span class="hljs-keyword">this</span>.connectionRepository.findAllConnections();\n      model.addAttribute(<span class="hljs-string">&quot;providerIds&quot;</span>, <span class="hljs-keyword">this</span>.connectionFactoryLocator.registeredProviderIds());\n      model.addAttribute(<span class="hljs-string">&quot;connectionMap&quot;</span>, connections);\n      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.connectView();\n  }\n\n  <span class="hljs-meta">@RequestMapping(\n      value = {<span class="hljs-meta-string">&quot;/{providerId}&quot;</span>},\n      method = {RequestMethod.GET}\n  )</span>\n  <span class="hljs-keyword">public</span> String connectionStatus(<span class="hljs-meta">@PathVariable</span> String providerId, NativeWebRequest request, Model model) {\n      <span class="hljs-keyword">this</span>.setNoCache(request);\n      <span class="hljs-keyword">this</span>.processFlash(request, model);\n      List&lt;Connection&lt;?&gt;&gt; connections = <span class="hljs-keyword">this</span>.connectionRepository.findConnections(providerId);\n      <span class="hljs-keyword">this</span>.setNoCache(request);\n      <span class="hljs-keyword">if</span>(connections.isEmpty()) {\n          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.connectView(providerId);\n      } <span class="hljs-keyword">else</span> {\n          model.addAttribute(<span class="hljs-string">&quot;connections&quot;</span>, connections);\n          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.connectedView(providerId);\n      }\n  }</code></pre><p>&#x5BF9;&#x4E86;&#xFF0C;&#x5C31;&#x662F;&#x8FD9;&#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x524D;&#x9762;&#x7B2C;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x8BF7;&#x6C42;&#x7684;&#x5730;&#x5740;&#x662F;&#xFF1A;/connect(&#x9700;&#x8981;&#x7528;&#x6237;&#x767B;&#x5F55;) &#x8FD9;&#x4E2A;&#x5730;&#x5740;&#x662F;&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x7528;&#x6237;&#x6240;&#x6709;&#x793E;&#x4EA4;&#x8D26;&#x53F7;&#x7ED1;&#x5B9A;&#x60C5;&#x51B5;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x65B9;&#x6CD5;&#x8BF7;&#x6C42;&#x7684;&#x5730;&#x5740;&#x662F;&#xFF1A;/connect/{providerId}(&#x9700;&#x8981;&#x7528;&#x6237;&#x767B;&#x5F55;) &#x8FD9;&#x4E2A;&#x5730;&#x5740;&#x662F;&#x83B7;&#x53D6;&#x67D0;&#x4E2A;&#x793E;&#x4EA4;&#x8D26;&#x53F7;&#x7ED1;&#x5B9A;&#x60C5;&#x51B5;&#xFF0C;&#x5982;/connect/qq&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8981;&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x7528;&#x6237;&#x7ED1;&#x5B9A;&#x7684;&#x6240;&#x6709;&#x793E;&#x4EA4;&#x8D26;&#x53F7;&#x7ED1;&#x5B9A;&#x60C5;&#x51B5;&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x7B2C;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x4F46;&#x662F;&#x73B0;&#x5728;&#x6709;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x83B7;&#x53D6;&#x5B8C;&#x4E4B;&#x540E; &#x5B83;&#x662F;&#x76F4;&#x63A5;&#x8DF3;&#x8F6C;&#x9875;&#x9762;&#x5230;/connect/status&#xFF0C;&#x5F53;&#x7136;&#x8FD9;&#x4E0D;&#x662F;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x4FEE;&#x6539;&#x8FD9;&#x4E2A;&#x7C7B;&#xFF0C;&#x6BD4;&#x5982;&#x5730;&#x5740;&#x6362;&#x6210;/socialConnect&#xFF0C;&#x8FD9;&#x4E2A;&#x6362;&#x6210;&#x81EA;&#x5DF1;&#x7684;&#x5C31;&#x597D;&#xFF0C;&#x7136;&#x540E;&#x6211;&#x4EEC;&#x6765;&#x6539;&#x4E0B;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x5982;&#x4E0B;&#xFF1A;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text=" @RequestMapping(\n         method = {RequestMethod.GET}\n )\n public ResponseEntity&lt;?&gt; connectionStatus(NativeWebRequest request, Model model) throws JsonProcessingException {\n     this.setNoCache(request);\n     this.processFlash(request, model);\n     Map&lt;String, List&lt;Connection&lt;?&gt;&gt;&gt; connections = this.connectionRepository.findAllConnections();\n     model.addAttribute(&quot;providerIds&quot;, this.connectionFactoryLocator.registeredProviderIds());\n     model.addAttribute(&quot;connectionMap&quot;, connections);\n     Map&lt;String,Boolean&gt; result = new HashMap&lt;String, Boolean&gt;();\n     for (String key : connections.keySet()){\n         result.put(key, org.apache.commons.collections.CollectionUtils.isNotEmpty(connections.get(key)));\n     }\n     return ResponseEntity.ok(objectMapper.writeValueAsString(result));\n }" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="hljs processing"><code> @RequestMapping(\n         method = {RequestMethod.GET}\n )\n <span class="hljs-keyword">public</span> ResponseEntity&lt;?&gt; connectionStatus(NativeWebRequest request, Model model) <span class="hljs-keyword">throws</span> JsonProcessingException {\n     <span class="hljs-keyword">this</span>.setNoCache(request);\n     <span class="hljs-keyword">this</span>.processFlash(request, model);\n     Map&lt;<span class="hljs-keyword">String</span>, List&lt;Connection&lt;?&gt;&gt;&gt; connections = <span class="hljs-keyword">this</span>.connectionRepository.findAllConnections();\n     model.addAttribute(<span class="hljs-string">&quot;providerIds&quot;</span>, <span class="hljs-keyword">this</span>.connectionFactoryLocator.registeredProviderIds());\n     model.addAttribute(<span class="hljs-string">&quot;connectionMap&quot;</span>, connections);\n     Map&lt;<span class="hljs-keyword">String</span>,Boolean&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-keyword">HashMap</span>&lt;<span class="hljs-keyword">String</span>, Boolean&gt;();\n     <span class="hljs-keyword">for</span> (<span class="hljs-keyword">String</span> <span class="hljs-built_in">key</span> : connections.keySet()){\n         result.put(<span class="hljs-built_in">key</span>, org.apache.commons.collections.CollectionUtils.isNotEmpty(connections.<span class="hljs-built_in">get</span>(<span class="hljs-built_in">key</span>)));\n     }\n     <span class="hljs-keyword">return</span> ResponseEntity.ok(objectMapper.writeValueAsString(result));\n }</code></pre><p>&#x6539;&#x597D;&#x7684;&#x4EE3;&#x7801;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;Json&#x6570;&#x636E;&#x7ED9;&#x524D;&#x7AEF;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x8DF3;&#x8F6C;&#x9875;&#x9762;&#xFF0C;&#x5B8C;&#x7F8E;&#x89E3;&#x51B3;&#x4E86;&#x524D;&#x540E;&#x7AEF;&#x5206;&#x79BB;&#x9879;&#x76EE;&#x95EE;&#x9898;&#xFF0C;&#x597D;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;postman&#x53D1;&#x9001;&#x8BF7;&#x6C42;&#x6D4B;&#x8BD5;&#x770B;&#x770B;&#xFF1A;</p><p><span class="img-wrap"><img data-src="/img/bVbhzv5?w=2260&amp;h=846" src="https://static.alili.tech/img/bVbhzv5?w=2260&amp;h=846" alt="clipboard.png" title="clipboard.png" style="cursor:pointer;display:inline"></span></p><p>&#x5982;&#x56FE;&#x6240;&#x793A;&#xFF0C;&#x6211;&#x4EEC;&#x6210;&#x529F;&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x767B;&#x5F55;&#x7528;&#x6237;&#x6240;&#x6709;&#x793E;&#x4EA4;&#x8D26;&#x53F7;&#x7ED1;&#x5B9A;&#x60C5;&#x51B5;&#x4E86;(&#x4E3A;&#x4EC0;&#x4E48;&#x8FD9;&#x91CC;&#x53EA;&#x6709;qq&#x548C;&#x5FAE;&#x4FE1;&#xFF1F;&#x793E;&#x4EA4;&#x8D26;&#x53F7;&#x7684;&#x7C7B;&#x578B;&#x662F;&#x4F60;application.proterties&#x91CC;&#x9762;&#x914D;&#x7F6E;&#x7684;)&#x3002;</p><h1 id="articleHeader3">4&#x3001;&#x7ED1;&#x5B9A;&#x793E;&#x4EA4;&#x8D26;&#x53F7;</h1><p>&#x597D;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x770B;&#x7ED1;&#x5B9A;&#x793E;&#x4EA4;&#x8D26;&#x53F7;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="  @RequestMapping(\n      value = {&quot;/{providerId}&quot;},\n      method = {RequestMethod.POST}\n  )\n  public RedirectView connect(@PathVariable String providerId, NativeWebRequest request) {\n      ConnectionFactory&lt;?&gt; connectionFactory = this.connectionFactoryLocator.getConnectionFactory(providerId);\n      MultiValueMap&lt;String, String&gt; parameters = new LinkedMultiValueMap();\n      this.preConnect(connectionFactory, parameters, request);\n\n      try {\n          return new RedirectView(this.connectSupport.buildOAuthUrl(connectionFactory, request, parameters));\n      } catch (Exception var6) {\n          this.sessionStrategy.setAttribute(request, &quot;social_provider_error&quot;, var6);\n          return this.connectionStatusRedirect(providerId, request);\n      }\n  }\n  \n  @RequestMapping(\n      value = {&quot;/{providerId}&quot;},\n      method = {RequestMethod.GET},\n      params = {&quot;code&quot;}\n  )\n  public RedirectView oauth2Callback(@PathVariable String providerId, NativeWebRequest request) {\n      try {\n          OAuth2ConnectionFactory&lt;?&gt; connectionFactory = (OAuth2ConnectionFactory)this.connectionFactoryLocator.getConnectionFactory(providerId);\n          Connection&lt;?&gt; connection = this.connectSupport.completeConnection(connectionFactory, request);\n          this.addConnection(connection, connectionFactory, request);\n      } catch (Exception var5) {\n          this.sessionStrategy.setAttribute(request, &quot;social_provider_error&quot;, var5);\n          logger.warn(&quot;Exception while handling OAuth2 callback (&quot; + var5.getMessage() + &quot;). Redirecting to &quot; + providerId + &quot; connection status page.&quot;);\n      }\n\n      return this.connectionStatusRedirect(providerId, request);\n  }" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="hljs kotlin"><code>  <span class="hljs-meta">@RequestMapping(\n      value = {<span class="hljs-meta-string">&quot;/{providerId}&quot;</span>},\n      method = {RequestMethod.POST}\n  )</span>\n  <span class="hljs-keyword">public</span> RedirectView connect(<span class="hljs-meta">@PathVariable</span> String providerId, NativeWebRequest request) {\n      ConnectionFactory&lt;?&gt; connectionFactory = <span class="hljs-keyword">this</span>.connectionFactoryLocator.getConnectionFactory(providerId);\n      MultiValueMap&lt;String, String&gt; parameters = new LinkedMultiValueMap();\n      <span class="hljs-keyword">this</span>.preConnect(connectionFactory, parameters, request);\n\n      <span class="hljs-keyword">try</span> {\n          <span class="hljs-keyword">return</span> new RedirectView(<span class="hljs-keyword">this</span>.connectSupport.buildOAuthUrl(connectionFactory, request, parameters));\n      } <span class="hljs-keyword">catch</span> (Exception var6) {\n          <span class="hljs-keyword">this</span>.sessionStrategy.setAttribute(request, <span class="hljs-string">&quot;social_provider_error&quot;</span>, var6);\n          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.connectionStatusRedirect(providerId, request);\n      }\n  }\n  \n  <span class="hljs-meta">@RequestMapping(\n      value = {<span class="hljs-meta-string">&quot;/{providerId}&quot;</span>},\n      method = {RequestMethod.GET},\n      params = {<span class="hljs-meta-string">&quot;code&quot;</span>}\n  )</span>\n  <span class="hljs-keyword">public</span> RedirectView oauth2Callback(<span class="hljs-meta">@PathVariable</span> String providerId, NativeWebRequest request) {\n      <span class="hljs-keyword">try</span> {\n          OAuth2ConnectionFactory&lt;?&gt; connectionFactory = (OAuth2ConnectionFactory)<span class="hljs-keyword">this</span>.connectionFactoryLocator.getConnectionFactory(providerId);\n          Connection&lt;?&gt; connection = <span class="hljs-keyword">this</span>.connectSupport.completeConnection(connectionFactory, request);\n          <span class="hljs-keyword">this</span>.addConnection(connection, connectionFactory, request);\n      } <span class="hljs-keyword">catch</span> (Exception var5) {\n          <span class="hljs-keyword">this</span>.sessionStrategy.setAttribute(request, <span class="hljs-string">&quot;social_provider_error&quot;</span>, var5);\n          logger.warn(<span class="hljs-string">&quot;Exception while handling OAuth2 callback (&quot;</span> + var5.getMessage() + <span class="hljs-string">&quot;). Redirecting to &quot;</span> + providerId + <span class="hljs-string">&quot; connection status page.&quot;</span>);\n      }\n\n      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.connectionStatusRedirect(providerId, request);\n  }</code></pre><p>&#x73B0;&#x5728;&#x6765;&#x5206;&#x6790; &#x4E0B;&#x8FD9;&#x4E24;&#x4E2A; &#x65B9;&#x6CD5;&#x7684;&#x4F5C;&#x7528;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x8BF7;&#x6C42;&#x7684;&#x5730;&#x5740;&#x662F;&#xFF1A;POST /connect/{providerId}(&#x9700;&#x8981;&#x767B;&#x5F55;) &#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x65B9;&#x6CD5;&#x8BF7;&#x6C42;&#x5730;&#x5740;&#x662F;&#xFF1A;GET /connect/{providerId}?code=&amp;state=(&#x9700;&#x8981;&#x767B;&#x5F55;)&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x662F;&#x83B7;&#x53D6;&#x793E;&#x4EA4;&#x6388;&#x6743;&#x8FDE;&#x63A5;&#x5730;&#x5740;&#xFF08;&#x8FD9;&#x4E2A;&#x662F;&#x4F60;&#x81EA;&#x5DF1;&#x793E;&#x4EA4;&#x767B;&#x5F55;&#x65F6;&#x5019;&#x5C01;&#x88C5;&#x597D;&#x7684;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4E0D;&#x6253;&#x7B97;&#x8BE6;&#x7EC6;&#x8BB2;&#x89E3;&#xFF0C;&#x540E;&#x9762;&#x8BFE;&#x7A0B;&#x518D;&#x653E;&#x51FA;&#x6765;&#x5427;&#xFF09;&#x6BD4;&#x5982;qq&#x7684;&#x6388;&#x6743;&#x5730;&#x5740;&#xFF1A;<a href="https://graph.qq.com/oauth2.0/show?which=Login&amp;display=pc&amp;client_id=&amp;response_type=code&amp;redirect_uri=&amp;state=" rel="nofollow noreferrer" target="_blank">https://graph.qq.com/oauth2.0...</a>&#xFF0C;&#x8FD9;&#x6837;&#x5F53;&#x4F60;&#x6388;&#x6743;&#x6210;&#x529F;&#x4E4B;&#x540E;&#x5C31;&#x56DE;&#x8C03;&#x5230;&#x4E86;&#x7B2C;&#x4E8C;&#x4E2A;&#x65B9;&#x6CD5;&#x91CC;&#x9762;&#xFF0C;&#x987A;&#x4FBF;&#x628A;code&#x548C;state&#x539F;&#x6837;&#x8FD4;&#x56DE;&#x8FC7;&#x6765;&#xFF0C;&#x8FD9;&#x4E00;&#x5957;&#x7ED1;&#x5B9A;&#x673A;&#x5236;&#x90FD;&#x662F;&#x57FA;&#x4E8E;session&#x7684;&#xFF0C;&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x6765;&#x5206;&#x6790;&#x770B;&#x4E0B;&#x4ED6;&#x662F;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x7684;&#x3002;</p><p>&#x6211;&#x4EEC;&#x4EE5;&#x5FAE;&#x4FE1;&#x4E3A;&#x4F8B;&#xFF0C;&#x9996;&#x5148;&#x6211;&#x4EEC;&#x53D1;&#x9001;&#x4E00;&#x4E2A;POST&#x8BF7;&#x6C42;/connect/wechat&#xFF0C;&#x56E0;&#x4E3A;&#x4F60;&#x5DF2;&#x7ECF;&#x767B;&#x5F55;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x540E;&#x53F0;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5F53;&#x524D;user&#x662F;&#x8C01;&#xFF0C;&#x7136;&#x540E;&#x5C31;&#x83B7;&#x53D6;&#x5230;&#x8BF7;&#x6C42;&#x7684;&#x94FE;&#x63A5;&#xFF1A;<a href="https://open.weixin.qq.com/connect/qrconnect?client_id=&amp;response_type=code&amp;redirect_uri=&amp;state=&amp;appid=&amp;scope=snsapi_login" rel="nofollow noreferrer" target="_blank">https://open.weixin.qq.com/co...</a>&#xFF0C;&#x6700;&#x540E;&#x5C31;&#x662F;&#x8DF3;&#x8F6C;&#x5230;&#x8FD9;&#x4E2A;&#x94FE;&#x63A5;&#x4E0A;&#x9762;&#x53BB;&#x3002;&#x8FD9;&#x662F;&#x7B2C;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x4F5C;&#x7528;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x5206;&#x6790;&#x7B2C;&#x4E8C;&#x4E2A;&#x65B9;&#x6CD5;&#x3002;</p><p>&#x8BF7;&#x6C42;&#x4E0A;&#x9762;&#x7684;&#x94FE;&#x63A5;&#x4E4B;&#x540E;&#x5C31;&#x662F;&#x8DF3;&#x8F6C;&#x5230;&#x5FAE;&#x4FE1;&#x626B;&#x7801;&#x7684;&#x9875;&#x9762;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p><p><span class="img-wrap"><img data-src="/img/bVbhAMI?w=1440&amp;h=1156" src="https://static.alili.tech/img/bVbhAMI?w=1440&amp;h=1156" alt="clipboard.png" title="clipboard.png" style="cursor:pointer"></span></p><p>&#x626B;&#x5B8C;&#x4E4B;&#x540E;&#x7ACB;&#x9A6C;&#x5C31;&#x8DF3;&#x5230;&#x4E0A;&#x9762;&#x94FE;&#x63A5;redirect_uri&#x5730;&#x5740;&#x4E0A;&#x9762;&#x53BB;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x73B0;&#x5728;&#x7684;&#x7B2C;&#x4E8C;&#x4E2A;&#x65B9;&#x6CD5;&#x4E0A;&#x9762;&#xFF0C;&#x800C;&#x4E14;&#x662F;&#x5E26;&#x7740;state&#x548C;code&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x540E;&#x53F0;&#x5F00;&#x59CB;&#x9A8C;&#x8BC1;&#x4F60;&#x56DE;&#x4F20;&#x8FC7;&#x6765;&#x7684;state&#x503C;&#x662F;&#x4E0D;&#x662F;&#x5339;&#x914D;&#x7684;&#xFF0C;&#x4E0D;&#x5339;&#x914D;&#x5C31;&#x62A5;&#x9519;&#x5E76;&#x4E14;&#x8DF3;&#x8F6C;&#x5230;&#x51FA;&#x9519;&#x9875;&#x9762;&#xFF0C;&#x5339;&#x914D;&#x7684;&#x8BDD;&#x5C31;&#x5F80;&#x4E0B;&#x8D70;&#xFF0C;&#x5E76;&#x4E14;&#x901A;&#x8FC7;code&#x83B7;&#x53D6;SpringSecurity OAuth&#x76F8;&#x5173;&#x793E;&#x4EA4;&#x7528;&#x6237;&#x4FE1;&#x606F;&#x5E76;&#x4FDD;&#x5B58;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;code&#x548C;state&#x7684;&#x4F5C;&#x7528;&#xFF0C;&#x9A8C;&#x8BC1;&#x548C;&#x83B7;&#x53D6;&#x5B8C;&#x4E4B;&#x540E;&#x5C31;&#x53EF;&#x4EE5;&#xFF0C;&#x8FD9;&#x6837;&#x4F60;&#x5C31;&#x7ED1;&#x5B9A;&#x6210;&#x529F;&#x4E86;&#xFF0C;&#x6700;&#x540E;&#x8DF3;&#x8F6C;&#x5230;/connected/wechat&#x9875;&#x9762;&#x4E86;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x7ED3;&#x675F;&#x4E86;&#x7ED1;&#x5B9A;&#x529F;&#x80FD;&#x4E86;&#x3002;</p><p>&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x524D;&#x540E;&#x7AEF;&#x5206;&#x79BB;&#x9879;&#x76EE;&#x8981;&#x4F7F;&#x7528;&#x8FD9;&#x5957;&#x673A;&#x5236;&#xFF0C;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x6539;&#x4E00;&#x4E0B;&#x4ED6;&#x7684;&#x6E90;&#x7801;&#x4E86;&#x3002;</p><p>&#x9996;&#x5148;&#x7B2C;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x628A;userId&#x4FDD;&#x5B58;&#x5230;&#x4EE5;state&#x7684;redis&#x952E;&#x503C;&#x5BF9;&#x4E2D;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#xFF1A;{state:userId}&#xFF0C;&#x7136;&#x540E;&#x4EE5;JSON&#x7684;&#x683C;&#x5F0F;&#x8FD4;&#x56DE;&#x793E;&#x4EA4;&#x6388;&#x6743;&#x7684;&#x94FE;&#x63A5;&#x7ED9;&#x524D;&#x53F0;&#xFF0C;&#x8FD9;&#x662F;&#x7B2C;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x8981;&#x4FEE;&#x6539;&#x7684;&#x601D;&#x8DEF;&#x3002;</p><p>&#x7136;&#x540E;&#x7B2C;&#x4E8C;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x662F;&#x793E;&#x4EA4;&#x6388;&#x6743;&#x94FE;&#x63A5;&#x8FD4;&#x56DE;&#x56DE;&#x6765;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x524D;&#x540E;&#x7AEF;&#x5206;&#x79BB;&#x9879;&#x76EE;session&#x5C31;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x83B7;&#x53D6;&#x7528;&#x6237;&#x4FE1;&#x606F;&#x5FC5;&#x987B;&#x901A;&#x8FC7;&#x4E0A;&#x9762;redis&#x4FDD;&#x5B58;&#x7684;{state:userId}&#xFF0C;&#x6765;&#x83B7;&#x53D6;&#x7528;&#x6237;id&#x3002;&#x518D;&#x4E00;&#x4E2A;&#x6211;&#x4EEC;&#x901A;&#x8FC7;code&#x83B7;&#x53D6;&#x793E;&#x4EA4;&#x7528;&#x6237;&#x4FE1;&#x606F;&#xFF0C;&#x4E24;&#x4E2A;&#x6570;&#x636E;&#x90FD;&#x83B7;&#x53D6;&#x4E86;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x5B89;&#x5FC3;&#x7684;&#x628A;&#x793E;&#x4EA4;&#x7528;&#x6237;&#x4FE1;&#x606F;&#x4FDD;&#x5B58;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E2D;(&#x8FD9;&#x91CC;&#x7684;&#x901A;&#x8FC7;state&#x4ECE;redis&#x4E2D;&#x83B7;&#x53D6;userId&#xFF0C;&#x5176;&#x5B9E;&#x4E5F;&#x662F;&#x4E00;&#x79CD;&#x9A8C;&#x8BC1;state&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x4F60;&#x60F3;&#x60F3;&#x53EF;&#x662F;&#x5462;&#xFF01;)&#xFF0C;&#x6700;&#x540E;&#x5C31;&#x8DF3;&#x8F6C;&#x5230;&#x4F60;&#x60F3;&#x8981;&#x7684;&#x9875;&#x9762;&#x5C31;&#x597D;&#x4E86;&#xFF0C;&#x4E0B;&#x9762;&#x5C31;&#x662F;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x4EE3;&#x7801;&#x4E86;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x770B;&#xFF1A;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="@RequestMapping(\n            value = {&quot;/{providerId}&quot;},\n            method = {RequestMethod.POST}\n    )\n    public ResponseEntity&lt;?&gt; connect(@PathVariable String providerId,\n                                     NativeWebRequest request) {\n        HttpServletRequest nativeRequest = request.getNativeRequest(HttpServletRequest.class);\n        Principal user = nativeRequest.getUserPrincipal();\n        ConnectionFactory&lt;?&gt; connectionFactory = this.connectionFactoryLocator.getConnectionFactory(providerId);\n        MultiValueMap&lt;String, String&gt; parameters = new LinkedMultiValueMap();\n        this.preConnect(connectionFactory, parameters, request);\n        try {\n            String social_connect_url = this.connectSupport.buildOAuthUrl(connectionFactory, request, parameters);\n            String state = (String) this.sessionStrategy.getAttribute(request, &quot;oauth2State&quot;);\n            this.sessionStrategy.removeAttribute(request, &quot;oauth2State&quot;);\n            //&#x628A;userId&#x4EE5;state&#x4E3A;key&#x7684;&#x5F62;&#x5F0F;&#x4FDD;&#x5B58;&#x5230;redis&#x4E2D;\n            socialRedisHelper.saveStateUserId(state, user.getName());\n            //&#x8FD4;&#x56DE;&#x793E;&#x4EA4;&#x94FE;&#x63A5;&#x5730;&#x5740;\n            return ResponseEntity.ok(social_connect_url);\n        } catch (Exception var6) {\n            this.sessionStrategy.setAttribute(request, &quot;social_provider_error&quot;, var6);\n            logger.info(var6.getMessage());\n            return null;\n        }\n    }\n    \n    //&#x8F85;&#x52A9;&#x65B9;&#x6CD5;1\n    protected String callbackUrl(NativeWebRequest request) {\n        if (this.callbackUrl != null) {\n            return this.callbackUrl;\n        } else {\n            HttpServletRequest nativeRequest = request.getNativeRequest(HttpServletRequest.class);\n            return this.applicationUrl != null ? this.applicationUrl + this.connectPath(nativeRequest) : nativeRequest.getRequestURL().toString();\n        }\n    }\n\n    //&#x8F85;&#x52A9;&#x65B9;&#x6CD5;2\n    private String connectPath(HttpServletRequest request) {\n        String pathInfo = request.getPathInfo();\n        return request.getServletPath() + (pathInfo != null ? pathInfo : &quot;&quot;);\n    }\n\n    //&#x56DE;&#x8C03;&#x65B9;&#x6CD5;\n    @RequestMapping(\n            value = {&quot;/{providerId}&quot;},\n            method = {RequestMethod.GET},\n            params = {&quot;code&quot;}\n    )\n    public void oauth2Callback(@PathVariable String providerId,\n                               NativeWebRequest request,\n                               HttpServletResponse response) {\n        try {\n            //ConnectController&#x662F;&#x5148;&#x4FDD;&#x5B58;&#x5728;session&#x91CC;&#x9762;&#xFF0C;&#x7136;&#x540E;&#x56DE;&#x8C03;&#x4ECE;session&#x91CC;&#x9762;&#x53D6;&#x51FA;&#x6765;&#x6821;&#x9A8C;\n            //&#x6211;&#x73B0;&#x5728;&#x662F;&#x901A;&#x8FC7;redis&#x4FDD;&#x5B58;state &#x7684; userId&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x6821;&#x9A8C;&#x4E86;state\n            String state = request.getParameter(&quot;state&quot;);\n            String code = request.getParameter(&quot;code&quot;);\n            OAuth2ConnectionFactory&lt;?&gt; connectionFactory = (OAuth2ConnectionFactory) this.connectionFactoryLocator.getConnectionFactory(providerId);\n            AccessGrant accessGrant = connectionFactory.getOAuthOperations().exchangeForAccess(code, this.callbackUrl(request), null);\n            Connection&lt;?&gt; connection = connectionFactory.createConnection(accessGrant);\n            //&#x4ECE;redis&#x4E2D;&#x83B7;&#x53D6;userid\n            String userId = socialRedisHelper.getStateUserId(state);\n            //&#x4FDD;&#x5B58;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E2D;\n            jdbcConnectionRepository.createConnectionRepository(userId).addConnection(connection);\n            //&#x8DF3;&#x8F6C;&#x9875;&#x9762;&#x5230;&#x524D;&#x53F0;&#x4EFB;&#x4F55;&#x4F60;&#x60F3;&#x8BBE;&#x7F6E;&#x7684;&#x5730;&#x5740;\n            response.sendRedirect(connectUrl);\n        } catch (Exception ex) {\n            logger.info(ex.getMessage());\n        }\n    }" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="hljs kotlin"><code><span class="hljs-meta">@RequestMapping(\n            value = {<span class="hljs-meta-string">&quot;/{providerId}&quot;</span>},\n            method = {RequestMethod.POST}\n    )</span>\n    <span class="hljs-keyword">public</span> ResponseEntity&lt;?&gt; connect(<span class="hljs-meta">@PathVariable</span> String providerId,\n                                     NativeWebRequest request) {\n        HttpServletRequest nativeRequest = request.getNativeRequest(HttpServletRequest.<span class="hljs-keyword">class</span>);\n        Principal user = nativeRequest.getUserPrincipal();\n        ConnectionFactory&lt;?&gt; connectionFactory = <span class="hljs-keyword">this</span>.connectionFactoryLocator.getConnectionFactory(providerId);\n        MultiValueMap&lt;String, String&gt; parameters = new LinkedMultiValueMap();\n        <span class="hljs-keyword">this</span>.preConnect(connectionFactory, parameters, request);\n        <span class="hljs-keyword">try</span> {\n            String social_connect_url = <span class="hljs-keyword">this</span>.connectSupport.buildOAuthUrl(connectionFactory, request, parameters);\n            String state = (String) <span class="hljs-keyword">this</span>.sessionStrategy.getAttribute(request, <span class="hljs-string">&quot;oauth2State&quot;</span>);\n            <span class="hljs-keyword">this</span>.sessionStrategy.removeAttribute(request, <span class="hljs-string">&quot;oauth2State&quot;</span>);\n            <span class="hljs-comment">//&#x628A;userId&#x4EE5;state&#x4E3A;key&#x7684;&#x5F62;&#x5F0F;&#x4FDD;&#x5B58;&#x5230;redis&#x4E2D;</span>\n            socialRedisHelper.saveStateUserId(state, user.getName());\n            <span class="hljs-comment">//&#x8FD4;&#x56DE;&#x793E;&#x4EA4;&#x94FE;&#x63A5;&#x5730;&#x5740;</span>\n            <span class="hljs-keyword">return</span> ResponseEntity.ok(social_connect_url);\n        } <span class="hljs-keyword">catch</span> (Exception var6) {\n            <span class="hljs-keyword">this</span>.sessionStrategy.setAttribute(request, <span class="hljs-string">&quot;social_provider_error&quot;</span>, var6);\n            logger.info(var6.getMessage());\n            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;\n        }\n    }\n    \n    <span class="hljs-comment">//&#x8F85;&#x52A9;&#x65B9;&#x6CD5;1</span>\n    <span class="hljs-keyword">protected</span> String callbackUrl(NativeWebRequest request) {\n        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.callbackUrl != <span class="hljs-literal">null</span>) {\n            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.callbackUrl;\n        } <span class="hljs-keyword">else</span> {\n            HttpServletRequest nativeRequest = request.getNativeRequest(HttpServletRequest.<span class="hljs-keyword">class</span>);\n            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.applicationUrl != <span class="hljs-literal">null</span> ? <span class="hljs-keyword">this</span>.applicationUrl + <span class="hljs-keyword">this</span>.connectPath(nativeRequest) : nativeRequest.getRequestURL().toString();\n        }\n    }\n\n    <span class="hljs-comment">//&#x8F85;&#x52A9;&#x65B9;&#x6CD5;2</span>\n    <span class="hljs-keyword">private</span> String connectPath(HttpServletRequest request) {\n        String pathInfo = request.getPathInfo();\n        <span class="hljs-keyword">return</span> request.getServletPath() + (pathInfo != <span class="hljs-literal">null</span> ? pathInfo : <span class="hljs-string">&quot;&quot;</span>);\n    }\n\n    <span class="hljs-comment">//&#x56DE;&#x8C03;&#x65B9;&#x6CD5;</span>\n    <span class="hljs-meta">@RequestMapping(\n            value = {<span class="hljs-meta-string">&quot;/{providerId}&quot;</span>},\n            method = {RequestMethod.GET},\n            params = {<span class="hljs-meta-string">&quot;code&quot;</span>}\n    )</span>\n    <span class="hljs-keyword">public</span> void oauth2Callback(<span class="hljs-meta">@PathVariable</span> String providerId,\n                               NativeWebRequest request,\n                               HttpServletResponse response) {\n        <span class="hljs-keyword">try</span> {\n            <span class="hljs-comment">//ConnectController&#x662F;&#x5148;&#x4FDD;&#x5B58;&#x5728;session&#x91CC;&#x9762;&#xFF0C;&#x7136;&#x540E;&#x56DE;&#x8C03;&#x4ECE;session&#x91CC;&#x9762;&#x53D6;&#x51FA;&#x6765;&#x6821;&#x9A8C;</span>\n            <span class="hljs-comment">//&#x6211;&#x73B0;&#x5728;&#x662F;&#x901A;&#x8FC7;redis&#x4FDD;&#x5B58;state &#x7684; userId&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x6821;&#x9A8C;&#x4E86;state</span>\n            String state = request.getParameter(<span class="hljs-string">&quot;state&quot;</span>);\n            String code = request.getParameter(<span class="hljs-string">&quot;code&quot;</span>);\n            OAuth2ConnectionFactory&lt;?&gt; connectionFactory = (OAuth2ConnectionFactory) <span class="hljs-keyword">this</span>.connectionFactoryLocator.getConnectionFactory(providerId);\n            AccessGrant accessGrant = connectionFactory.getOAuthOperations().exchangeForAccess(code, <span class="hljs-keyword">this</span>.callbackUrl(request), <span class="hljs-literal">null</span>);\n            Connection&lt;?&gt; connection = connectionFactory.createConnection(accessGrant);\n            <span class="hljs-comment">//&#x4ECE;redis&#x4E2D;&#x83B7;&#x53D6;userid</span>\n            String userId = socialRedisHelper.getStateUserId(state);\n            <span class="hljs-comment">//&#x4FDD;&#x5B58;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E2D;</span>\n            jdbcConnectionRepository.createConnectionRepository(userId).addConnection(connection);\n            <span class="hljs-comment">//&#x8DF3;&#x8F6C;&#x9875;&#x9762;&#x5230;&#x524D;&#x53F0;&#x4EFB;&#x4F55;&#x4F60;&#x60F3;&#x8BBE;&#x7F6E;&#x7684;&#x5730;&#x5740;</span>\n            response.sendRedirect(connectUrl);\n        } <span class="hljs-keyword">catch</span> (Exception ex) {\n            logger.info(ex.getMessage());\n        }\n    }</code></pre><p>&#x8FD9;&#x6837;&#x4F60;&#x5C31;&#x5B8C;&#x6210;&#x4E86;&#x540E;&#x53F0;&#x7ED1;&#x5B9A;&#x76F8;&#x5173;&#x5DE5;&#x4F5C;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x628A;&#x524D;&#x7AEF;&#x76F8;&#x5173;&#x4EE3;&#x7801;&#x4E5F;&#x653E;&#x51FA;&#x6765;&#x5927;&#x5BB6;&#x770B;&#x4E0B;&#x5427;&#xFF1A;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="gotoBind(type){\n            let url = `${this.$url}/socialConnect/${type}`;\n            this.$post(url)\n            .then(res=&gt;{\n                if(res.code == 0){\n                    this.openWindow(res.data.redirect_uri)\n                }\n            })\n        },\nopenWindow(url){\n            let sf_H = 550;\n            let sf_W = 720;\n            var iTop = (window.screen.height-30 -sf_H)/2; //&#x83B7;&#x5F97;&#x7A97;&#x53E3;&#x7684;&#x5782;&#x76F4;&#x4F4D;&#x7F6E;;  \n            var iLeft = (window.screen.width-10 -sf_W)/2; //&#x83B7;&#x5F97;&#x7A97;&#x53E3;&#x7684;&#x6C34;&#x5E73;&#x4F4D;&#x7F6E;;\n            let s = window.open(url,&quot;social_bind_form&quot;,&apos;height=&apos;+sf_H+\n            &apos;, width=&apos;+sf_W+&apos;,top=&apos;+iTop+&apos;,left=&apos;+iLeft+&apos;toolbar=no, menubar=no, scrollbars=no, status=no, location=yes, resizable=yes&apos;);\n        }," title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="hljs qml"><code>gotoBind(type){\n            <span class="hljs-keyword">let</span> <span class="hljs-built_in">url</span> = <span class="hljs-string">`<span class="hljs-subst">${this.$url}</span>/socialConnect/<span class="hljs-subst">${type}</span>`</span>;\n            <span class="hljs-keyword">this</span>.$post(<span class="hljs-built_in">url</span>)\n            .then(res=&gt;{\n                <span class="hljs-keyword">if</span>(res.code == <span class="hljs-number">0</span>){\n                    <span class="hljs-keyword">this</span>.openWindow(res.data.redirect_uri)\n                }\n            })\n        },\nopenWindow(<span class="hljs-built_in">url</span>){\n            <span class="hljs-keyword">let</span> sf_H = <span class="hljs-number">550</span>;\n            <span class="hljs-keyword">let</span> sf_W = <span class="hljs-number">720</span>;\n            <span class="hljs-built_in">var</span> iTop = (<span class="hljs-built_in">window</span>.screen.height<span class="hljs-number">-30</span> -sf_H)/<span class="hljs-number">2</span>; <span class="hljs-comment">//&#x83B7;&#x5F97;&#x7A97;&#x53E3;&#x7684;&#x5782;&#x76F4;&#x4F4D;&#x7F6E;;  </span>\n            <span class="hljs-built_in">var</span> iLeft = (<span class="hljs-built_in">window</span>.screen.width<span class="hljs-number">-10</span> -sf_W)/<span class="hljs-number">2</span>; <span class="hljs-comment">//&#x83B7;&#x5F97;&#x7A97;&#x53E3;&#x7684;&#x6C34;&#x5E73;&#x4F4D;&#x7F6E;;</span>\n            <span class="hljs-keyword">let</span> s = <span class="hljs-built_in">window</span>.open(<span class="hljs-built_in">url</span>,<span class="hljs-string">&quot;social_bind_form&quot;</span>,<span class="hljs-string">&apos;height=&apos;</span>+sf_H+\n            <span class="hljs-string">&apos;, width=&apos;</span>+sf_W+<span class="hljs-string">&apos;,top=&apos;</span>+iTop+<span class="hljs-string">&apos;,left=&apos;</span>+iLeft+<span class="hljs-string">&apos;toolbar=no, menubar=no, scrollbars=no, status=no, location=yes, resizable=yes&apos;</span>);\n        },</code></pre><p>&#x4E0A;&#x9762;&#x662F;&#x83B7;&#x53D6;&#x793E;&#x4EA4;&#x7ED1;&#x5B9A;&#x5730;&#x5740;&#x5E76;&#x8DF3;&#x8F6C;&#xFF0C;&#x4E0B;&#x9762;&#x662F;&#x56DE;&#x8C03;&#x6210;&#x529F;&#x4E4B;&#x540E;&#x5173;&#x95ED;&#x5BF9;&#x8BDD;&#x6846;&#x5E76;&#x5237;&#x65B0;&#x7684;&#x9875;&#x9762;&#x4EE3;&#x7801;&#x3002;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="&lt;template&gt;\n    &lt;section&gt;\n        &lt;!--&#x793E;&#x4EA4;&#x7ED1;&#x5B9A;&#x6210;&#x529F;&#x5904;&#x7406;&#x9875;&#x9762;--&gt;\n    &lt;/section&gt;\n&lt;/template&gt;\n&lt;script&gt;\nimport {mapActions,mapState} from &apos;vuex&apos;\n\nexport default {\n    data(){\n        return{\n        }\n    },\n    created(){\n        window.close(); \n        opener.location.reload();\n    },\n    methods:{\n        \n    }\n}\n&lt;/script&gt;\n" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="hljs xml"><code><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>\n        <span class="hljs-comment">&lt;!--&#x793E;&#x4EA4;&#x7ED1;&#x5B9A;&#x6210;&#x529F;&#x5904;&#x7406;&#x9875;&#x9762;--&gt;</span>\n    <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">\n<span class="hljs-keyword">import</span> {mapActions,mapState} <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;vuex&apos;</span>\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n    data(){\n        <span class="hljs-keyword">return</span>{\n        }\n    },\n    created(){\n        <span class="hljs-built_in">window</span>.close(); \n        opener.location.reload();\n    },\n    <span class="hljs-attr">methods</span>:{\n        \n    }\n}\n</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n</code></pre><p>&#x6211;&#x4EEC;&#x6765;&#x6F14;&#x793A;&#x4E00;&#x4E0B;&#xFF1A;</p><p><span class="img-wrap"><img data-src="/img/bVbhAMa?w=1720&amp;h=862" src="https://static.alili.tech/img/bVbhAMa?w=1720&amp;h=862" alt="clipboard.png" title="clipboard.png" style="cursor:pointer"></span></p><p><span class="img-wrap"><img data-src="/img/bVbhAMI?w=1440&amp;h=1156" src="https://static.alili.tech/img/bVbhAMI?w=1440&amp;h=1156" alt="clipboard.png" title="clipboard.png" style="cursor:pointer"></span></p><p><span class="img-wrap"><img data-src="/img/bVbhAM4?w=1686&amp;h=762" src="https://static.alili.tech/img/bVbhAM4?w=1686&amp;h=762" alt="clipboard.png" title="clipboard.png" style="cursor:pointer"></span></p><p><span class="img-wrap"><img data-src="/img/bVbhANd?w=2394&amp;h=628" src="https://static.alili.tech/img/bVbhANd?w=2394&amp;h=628" alt="clipboard.png" title="clipboard.png" style="cursor:pointer"></span></p><h1 id="articleHeader4">5&#x3001;&#x89E3;&#x7ED1;&#x793E;&#x4EA4;&#x8D26;&#x53F7;</h1><p>&#x7ED1;&#x5B9A;&#x793E;&#x4EA4;&#x8D26;&#x53F7;&#x5DF2;&#x7ECF;&#x6210;&#x529F;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x5982;&#x4F55;&#x89E3;&#x7ED1;&#x793E;&#x4EA4;&#x8D26;&#x53F7;&#x5427;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x770B;&#x4E0B;&#x6E90;&#x7801;&#x662F;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x5982;&#x4E0B;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="@RequestMapping(\n        value = {&quot;/{providerId}&quot;},\n        method = {RequestMethod.DELETE}\n    )\n    public RedirectView removeConnections(@PathVariable String providerId, NativeWebRequest request) {\n        ConnectionFactory&lt;?&gt; connectionFactory = this.connectionFactoryLocator.getConnectionFactory(providerId);\n        this.preDisconnect(connectionFactory, request);\n        this.connectionRepository.removeConnections(providerId);\n        this.postDisconnect(connectionFactory, request);\n        return this.connectionStatusRedirect(providerId, request);\n    }\n\n    @RequestMapping(\n        value = {&quot;/{providerId}/{providerUserId}&quot;},\n        method = {RequestMethod.DELETE}\n    )\n    public RedirectView removeConnection(@PathVariable String providerId, @PathVariable String providerUserId, NativeWebRequest request) {\n        ConnectionFactory&lt;?&gt; connectionFactory = this.connectionFactoryLocator.getConnectionFactory(providerId);\n        this.preDisconnect(connectionFactory, request);\n        this.connectionRepository.removeConnection(new ConnectionKey(providerId, providerUserId));\n        this.postDisconnect(connectionFactory, request);\n        return this.connectionStatusRedirect(providerId, request);\n    }" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="hljs kotlin"><code><span class="hljs-meta">@RequestMapping(\n        value = {<span class="hljs-meta-string">&quot;/{providerId}&quot;</span>},\n        method = {RequestMethod.DELETE}\n    )</span>\n    <span class="hljs-keyword">public</span> RedirectView removeConnections(<span class="hljs-meta">@PathVariable</span> String providerId, NativeWebRequest request) {\n        ConnectionFactory&lt;?&gt; connectionFactory = <span class="hljs-keyword">this</span>.connectionFactoryLocator.getConnectionFactory(providerId);\n        <span class="hljs-keyword">this</span>.preDisconnect(connectionFactory, request);\n        <span class="hljs-keyword">this</span>.connectionRepository.removeConnections(providerId);\n        <span class="hljs-keyword">this</span>.postDisconnect(connectionFactory, request);\n        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.connectionStatusRedirect(providerId, request);\n    }\n\n    <span class="hljs-meta">@RequestMapping(\n        value = {<span class="hljs-meta-string">&quot;/{providerId}/{providerUserId}&quot;</span>},\n        method = {RequestMethod.DELETE}\n    )</span>\n    <span class="hljs-keyword">public</span> RedirectView removeConnection(<span class="hljs-meta">@PathVariable</span> String providerId, <span class="hljs-meta">@PathVariable</span> String providerUserId, NativeWebRequest request) {\n        ConnectionFactory&lt;?&gt; connectionFactory = <span class="hljs-keyword">this</span>.connectionFactoryLocator.getConnectionFactory(providerId);\n        <span class="hljs-keyword">this</span>.preDisconnect(connectionFactory, request);\n        <span class="hljs-keyword">this</span>.connectionRepository.removeConnection(new ConnectionKey(providerId, providerUserId));\n        <span class="hljs-keyword">this</span>.postDisconnect(connectionFactory, request);\n        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.connectionStatusRedirect(providerId, request);\n    }</code></pre><p>&#x7B2C;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x8BF7;&#x6C42;&#x5730;&#x5740;&#x662F;&#xFF1A;Delete /connect/{providerId}(&#x9700;&#x767B;&#x5F55;)&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x65B9;&#x6CD5;&#x8BF7;&#x6C42;&#x5730;&#x5740;&#x662F;&#xFF1A;Delete /connect/{providerId}/{providerUserId}(&#x9700;&#x767B;&#x5F55;)&#xFF0C;&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x7684;providerUserId&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x793E;&#x4EA4;&#x7528;&#x6237;id,&#x6BD4;&#x5982;&#x5FAE;&#x4FE1;&#x7684;openId&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x662F;&#x6839;&#x636E;&#x767B;&#x5F55;&#x7684;userId&#x548C;providerId&#x6765;&#x5220;&#x9664;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x7ED1;&#x5B9A;&#x7684;&#x793E;&#x4EA4;&#x7528;&#x6237;&#x6570;&#x636E;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x65B9;&#x6CD5;&#x662F;&#x6839;&#x636E;&#x767B;&#x5F55;&#x7684;userId&#x548C;providerId&#x8FD8;&#x6709;providerUserId&#x6765;&#x5220;&#x9664;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x7ED1;&#x5B9A;&#x7684;&#x793E;&#x4EA4;&#x7528;&#x6237;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A; &#x65B9;&#x6CD5;&#x90FD;&#x6709;&#x76F8;&#x540C;&#x7684;&#x4E00;&#x70B9;&#x5C31;&#x662F;&#x8DF3;&#x8F6C;&#x5230;&#x5220;&#x9664;&#x4E4B;&#x540E;&#x7684;&#x9875;&#x9762;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EA;&#x8981;&#x628A;&#x8DF3;&#x8F6C;&#x9875;&#x9762;&#x4EE5;JSON&#x7684;&#x5F62;&#x5F0F;&#x8FD4;&#x56DE;&#x7ED9;&#x524D;&#x7AEF;&#x5C31;&#x597D;&#xFF0C;&#x4E0B;&#x9762;&#x5C31;&#x662F;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text=" @RequestMapping(\n            value = {&quot;/{providerId}&quot;},\n            method = {RequestMethod.DELETE}\n    )\n    public ResponseEntity&lt;?&gt; removeConnections(@PathVariable String providerId, NativeWebRequest request) {\n        ConnectionFactory&lt;?&gt; connectionFactory = this.connectionFactoryLocator.getConnectionFactory(providerId);\n        this.preDisconnect(connectionFactory, request);\n        this.connectionRepository.removeConnections(providerId);\n        this.postDisconnect(connectionFactory, request);\n        return ResponseEntity.ok(&quot;success&quot;);\n    }\n\n    @RequestMapping(\n            value = {&quot;/{providerId}/{providerUserId}&quot;},\n            method = {RequestMethod.DELETE}\n    )\n    public ResponseEntity&lt;?&gt; removeConnection(@PathVariable String providerId,\n                                              @PathVariable String providerUserId,\n                                              NativeWebRequest request) throws IOException {\n        try {\n            ConnectionFactory&lt;?&gt; connectionFactory = this.connectionFactoryLocator.getConnectionFactory(providerId);\n            this.preDisconnect(connectionFactory, request);\n            this.connectionRepository.removeConnection(new ConnectionKey(providerId, providerUserId));\n            this.postDisconnect(connectionFactory, request);\n        } catch (Exception ex) {\n            logger.info(ex.getMessage());\n        }\n        return ResponseEntity.ok(&quot;success&quot;);\n    }" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="hljs kotlin"><code> <span class="hljs-meta">@RequestMapping(\n            value = {<span class="hljs-meta-string">&quot;/{providerId}&quot;</span>},\n            method = {RequestMethod.DELETE}\n    )</span>\n    <span class="hljs-keyword">public</span> ResponseEntity&lt;?&gt; removeConnections(<span class="hljs-meta">@PathVariable</span> String providerId, NativeWebRequest request) {\n        ConnectionFactory&lt;?&gt; connectionFactory = <span class="hljs-keyword">this</span>.connectionFactoryLocator.getConnectionFactory(providerId);\n        <span class="hljs-keyword">this</span>.preDisconnect(connectionFactory, request);\n        <span class="hljs-keyword">this</span>.connectionRepository.removeConnections(providerId);\n        <span class="hljs-keyword">this</span>.postDisconnect(connectionFactory, request);\n        <span class="hljs-keyword">return</span> ResponseEntity.ok(<span class="hljs-string">&quot;success&quot;</span>);\n    }\n\n    <span class="hljs-meta">@RequestMapping(\n            value = {<span class="hljs-meta-string">&quot;/{providerId}/{providerUserId}&quot;</span>},\n            method = {RequestMethod.DELETE}\n    )</span>\n    <span class="hljs-keyword">public</span> ResponseEntity&lt;?&gt; removeConnection(<span class="hljs-meta">@PathVariable</span> String providerId,\n                                              <span class="hljs-meta">@PathVariable</span> String providerUserId,\n                                              NativeWebRequest request) throws IOException {\n        <span class="hljs-keyword">try</span> {\n            ConnectionFactory&lt;?&gt; connectionFactory = <span class="hljs-keyword">this</span>.connectionFactoryLocator.getConnectionFactory(providerId);\n            <span class="hljs-keyword">this</span>.preDisconnect(connectionFactory, request);\n            <span class="hljs-keyword">this</span>.connectionRepository.removeConnection(new ConnectionKey(providerId, providerUserId));\n            <span class="hljs-keyword">this</span>.postDisconnect(connectionFactory, request);\n        } <span class="hljs-keyword">catch</span> (Exception ex) {\n            logger.info(ex.getMessage());\n        }\n        <span class="hljs-keyword">return</span> ResponseEntity.ok(<span class="hljs-string">&quot;success&quot;</span>);\n    }</code></pre><p>&#x6211;&#x4EEC;&#x518D;&#x628A;&#x524D;&#x7AEF;&#x4EE3;&#x7801;&#x8D34;&#x51FA;&#x6765;&#xFF1A;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="gotoUnBind(type){\n            let url = `${this.$url}/socialConnect/${type}`;\n            this.$delete(url)\n            .then(res=&gt;{\n                if(res.code == 0){\n                    this.$Message.success(&apos;&#x89E3;&#x7ED1;&#x6210;&#x529F;&#xFF01;&apos;)\n                    location.reload();\n                }\n            })\n        }," title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="hljs javascript"><code>gotoUnBind(type){\n            <span class="hljs-keyword">let</span> url = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.$url}</span>/socialConnect/<span class="hljs-subst">${type}</span>`</span>;\n            <span class="hljs-keyword">this</span>.$<span class="hljs-keyword">delete</span>(url)\n            .then(<span class="hljs-function"><span class="hljs-params">res</span>=&gt;</span>{\n                <span class="hljs-keyword">if</span>(res.code == <span class="hljs-number">0</span>){\n                    <span class="hljs-keyword">this</span>.$Message.success(<span class="hljs-string">&apos;&#x89E3;&#x7ED1;&#x6210;&#x529F;&#xFF01;&apos;</span>)\n                    location.reload();\n                }\n            })\n        },</code></pre><h1 id="articleHeader5">6&#x3001;&#x603B;&#x7ED3;&#xFF1A;</h1><p>1&#x3001;&#x53EA;&#x8981;&#x628A;&#x601D;&#x8DEF;&#x7406;&#x6E05;&#x695A;&#x4E86;&#xFF0C;&#x5176;&#x5B9E;&#x4FEE;&#x6539;&#x6210;&#x81EA;&#x5DF1;&#x60F3;&#x8981;&#x7684;&#x4EE3;&#x7801;&#x5C31;&#x4E0D;&#x96BE;<br>2&#x3001;&#x6CE8;&#x610F;ConnectController&#x4EE3;&#x7801;&#x662F;&#x57FA;&#x4E8E;Session&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x4F60;&#x5FC5;&#x987B;&#x8981;&#x767B;&#x5F55;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x624D;&#x80FD;&#x4F7F;&#x7528;<br>3&#x3001;redis&#x7684;&#x4F7F;&#x7528;&#x5728;&#x8FD9;&#x91CC;&#x53D1;&#x6325;&#x5230;&#x4E86;&#x4E00;&#x5B9A;&#x4F5C;&#x7528;&#xFF0C;&#x6240;&#x4EE5;&#x8BF4;&#x524D;&#x540E;&#x7AEF;&#x5206;&#x79BB;&#x9879;&#x76EE;&#x79BB;&#x4E0D;&#x5F00;redis</p><p>&#x5982;&#x679C;&#x4F60;&#x89C9;&#x5F97;&#x5E2E;&#x52A9;&#x5230;&#x4F60;&#x4E86;&#xFF0C;&#x53EF;&#x4EE5;&#x6253;&#x8D4F;&#x6211;&#x66F4;&#x6709;&#x52A8;&#x529B;&#x6765;&#x66F4;&#x65B0;&#x6587;&#x7AE0;</p><p><span class="img-wrap"><img data-src="/img/bVbhA0O?w=900&amp;h=1350" src="https://static.alili.tech/img/bVbhA0O?w=900&amp;h=1350" alt="clipboard.png" title="clipboard.png" style="cursor:pointer;display:inline"></span></p><h1 id="articleHeader6">7&#x3001;&#x5F15;&#x7528;</h1><p><a href="http://wiki.connect.qq.com/get_user_info" rel="nofollow noreferrer" target="_blank">qq&#x4E92;&#x8054;&#x6587;&#x6863;</a><br><a href="https://my.oschina.net/giegie/blog/1605932" rel="nofollow noreferrer" target="_blank">Spring Security Oauth2.0 &#x5B9E;&#x73B0;&#x77ED;&#x4FE1;&#x9A8C;&#x8BC1;&#x7801;&#x767B;&#x5F55;</a><br><a href="http://www.dewafer.com/2016/10/01/dive-into-spring-security/" rel="nofollow noreferrer" target="_blank">&#x6DF1;&#x5165;&#x4E86;&#x89E3; Spring Security</a><br><a href="https://github.com/longfeizheng/logback" rel="nofollow noreferrer" target="_blank">SpringBoot+Spring Security&#x57FA;&#x672C;&#x914D;&#x7F6E;</a><br><a href="https://github.com/trautonen/spring-social-mongodb" rel="nofollow noreferrer" target="_blank">spring-social-mongodb</a><br><a href="https://blog.csdn.net/u014033756/article/details/52038114" rel="nofollow noreferrer" target="_blank">&#x5FAE;&#x4FE1;&#x7684;redirect_uri&#x53C2;&#x6570;&#x9519;&#x8BEF;&#x89E3;&#x51B3;&#x529E;&#x6CD5;</a><br><a href="https://www.jianshu.com/p/5b5c2131bff9" rel="nofollow noreferrer" target="_blank">&#x7F51;&#x9875;&#x5FAE;&#x4FE1;&#x7B2C;&#x4E09;&#x65B9;&#x767B;&#x5F55;-redirect_uri&#x53C2;&#x6570;&#x9519;&#x8BEF;</a><br><a href="https://www.jianshu.com/p/8faaad6e9aec" rel="nofollow noreferrer" target="_blank">Java&#x5B9E;&#x73B0;QQ&#x3001;&#x5FAE;&#x4FE1;&#x3001;&#x65B0;&#x6D6A;&#x5FAE;&#x535A;&#x7B2C;&#x4E09;&#x65B9;&#x767B;&#x5F55;</a><br><a href="https://www.cnblogs.com/liuxianan/p/java-qq-weibo-login.html" rel="nofollow noreferrer" target="_blank">&#x5982;&#x4F55;&#x4ECE;&#x96F6;&#x5F00;&#x59CB;&#x5BF9;&#x63A5;&#x7B2C;&#x4E09;&#x65B9;&#x767B;&#x5F55;(Java&#x7248;)&#xFF1A;QQ&#x767B;&#x5F55;&#x548C;&#x5FAE;&#x535A;&#x767B;&#x5F55;</a><br><a href="https://www.jianshu.com/p/217abf004545" rel="nofollow noreferrer" target="_blank">QQ&#x6388;&#x6743;&#x767B;&#x5F55;&#x6539;</a><br><a href="https://qtdebug.com/spring-security-11-qq-login/" rel="nofollow noreferrer" target="_blank">Spring Security QQ &#x767B;&#x9646;</a><br><a href="https://blog.csdn.net/qq_34206863/article/details/78778058" rel="nofollow noreferrer" target="_blank">&#x7B2C;&#x4E09;&#x65B9;APP&#x5B9E;&#x73B0;QQ&#x767B;&#x9646;</a><br><a href="https://blog.csdn.net/silent_paladin/article/details/72775782" rel="nofollow noreferrer" target="_blank">2 Apache Shiro &#x8EAB;&#x4EFD;&#x8BA4;&#x8BC1;&#xFF08;&#x767B;&#x5F55;&#xFF09;</a><br><a href="https://www.jianshu.com/p/51b558780098" rel="nofollow noreferrer" target="_blank">Spring Security &#x5B9E;&#x6218;&#xFF1A;QQ&#x767B;&#x5F55;&#x5B9E;&#x73B0;</a><br><a href="https://blog.csdn.net/shanshan_blog/article/details/71514087" rel="nofollow noreferrer" target="_blank">&#x57FA;&#x4E8E;Spring&#x7684;QQ&#x7B2C;&#x4E09;&#x65B9;&#x767B;&#x5F55;&#x5B9E;&#x73B0;</a><br><a href="https://blog.csdn.net/dandandeshangni/article/details/79016125" rel="nofollow noreferrer" target="_blank">Spring Security&#x6E90;&#x7801;&#x5206;&#x6790;&#x4E09;&#xFF1A;Spring Social&#x5B9E;&#x73B0;QQ&#x793E;&#x4EA4;&#x767B;&#x5F55;</a><br><a href="https://blog.csdn.net/u012682683/article/details/78201371?locationNum=9&amp;fps=1" rel="nofollow noreferrer" target="_blank">&#x5FAE;&#x4FE1;&#x6388;&#x6743;&#x767B;&#x5F55;-&#x524D;&#x540E;&#x7AEF;&#x5206;&#x79BB;</a><br><a href="http://blog.didispace.com/spring-security-oauth2-xjf-1/" rel="nofollow noreferrer" target="_blank">&#x4ECE;&#x96F6;&#x5F00;&#x59CB;&#x7684;Spring Security Oauth2&#xFF08;&#x4E00;&#xFF09;</a><br><a href="https://spring.io/guides/tutorials/spring-boot-oauth2/" rel="nofollow noreferrer" target="_blank">Spring Boot and OAuth2</a><br><a href="https://juejin.im/post/5a3cbce05188252582279467" rel="nofollow noreferrer" target="_blank">Spring security OAuth2 &#x6DF1;&#x5165;&#x89E3;&#x6790;</a><br><a href="http://www.leftso.com/blog/139.html" rel="nofollow noreferrer" target="_blank">spring boot &#x5165;&#x95E8;&#x4E4B;security oauth2 jwt&#x5B8C;&#x7F8E;&#x6574;&#x5408;&#x4F8B;&#x5B50;-java&#x7F16;&#x7A0B;</a><br><a href="https://github.com/jojozhai/security" rel="nofollow noreferrer" target="_blank">jojozhai/security</a><br><a href="https://blog.csdn.net/shannon8/article/details/72896408" rel="nofollow noreferrer" target="_blank">window.open&#x6253;&#x5F00;&#x7684;&#x7A97;&#x53E3;&#x5173;&#x95ED;&#x540E;&#x5237;&#x65B0;&#x7236;&#x9875;&#x9762;&#x7684;&#x5B50;&#x9875;&#x9762;</a><br><a href="https://www.cnblogs.com/softidea/p/7153047.html" rel="nofollow noreferrer" target="_blank">Spring Security &#x5B9E;&#x6218;&#xFF1A;QQ&#x767B;&#x5F55;&#x5B9E;&#x73B0;</a><a href="https://jwt.io" rel="nofollow noreferrer" target="_blank">jwt</a></p>\n';t=(t=(t=(t=t.replace(/"{/g,"{")).replace(/{"/g,"{")).replace(/"}/g,"}")).replace(/}"/g,"}"),$("#raw").html(t)})</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>前后端分离项目 — SpringSocial 绑定与解绑社交账号如微信、QQ</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000016542131">https://segmentfault.com/a/1190000016542131</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/bc6556da/" target="_blank">https://alili.tech/archive/bc6556da/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({el:".blog-post-comments",app_id:"ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz",app_key:"hLhtmd4tT0qJbyO2SgQ8odya",placeholder:"说点什么?",avatar:"retro",notify:!0,verify:!0})</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/iy3p8xypt3/">ES6小结<aside class="dates">2018-11-21</aside></a></li><li><a href="/archive/g1l1a5qkvnr/">JavaScript数据结构01 - 数组<aside class="dates">2018-11-21</aside></a></li><li><a href="/archive/dz2zhhyxwss/">JavaScript数据结构02 - 栈<aside class="dates">2018-11-21</aside></a></li><li><a href="/archive/7i8flubbhka/">Redux中间件的实践<aside class="dates">2018-11-21</aside></a></li><li><a href="/archive/h69u1gx0x1/">Vue全家桶商城全站升级之引入HTTPS,PWA,错误监控,持续构建。<aside class="dates">2018-11-21</aside></a></li><li><a href="/archive/8pwxv5237zh/">Vue超快速学习<aside class="dates">2018-11-21</aside></a></li><li><a href="/archive/dyff6hsxti/">k8s与数据分析--利用redash做自助数据分析<aside class="dates">2018-11-21</aside></a></li><li><a href="/archive/urdsq6sep5s/">kPagination纯js实现分页插件<aside class="dates">2018-11-21</aside></a></li><li><a href="/archive/y12cv8b7uxo/">vue实现选中效果<aside class="dates">2018-11-21</aside></a></li><li><a href="/archive/aqu274xgoa6/">《CSS世界》笔记二：盒模型四大家族<aside class="dates">2018-11-21</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2018 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>!function(){if("alili.tech"===location.host){var t=document.createElement("script");window.location.protocol.split(":")[0];t.src="https://www.googletagmanager.com/gtag/js?id=UA-129382678-1";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(t,a),window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","UA-129382678-1")}function e(){dataLayer.push(arguments)}}()</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>